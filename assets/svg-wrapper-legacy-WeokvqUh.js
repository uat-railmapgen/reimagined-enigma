System.register(["./chakra-legacy-DbXIViDh.js","./index-legacy-Dohrh0b_.js","./react-legacy-B9RkHKhm.js","./clipboard-legacy-dMin-n5m.js","./stations-legacy-Wyqp3d1V.js","./misc-nodes-legacy-BA31gOjR.js"],(function(e,t){"use strict";var n,r,o,i,s,a,l,d,c,u,y,h,p,f,x,g,v,m,b,w,P,A,k,E,j,D,N,I,S,C,$,M,_,z,K,W,T,L,U,O,B,R,Y,F,X,V,q;return{setters:[e=>{n=e.j},e=>{r=e.l,o=e.o,i=e.an,s=e.ao,a=e.ap,l=e.e,d=e.a,c=e.aq,u=e.ar,y=e.as,h=e.U,p=e.at,f=e.au,x=e.av,g=e.t,v=e.v,m=e.S,b=e.aw,w=e.n,P=e.m,A=e.p,k=e.r,E=e.E,j=e.w,D=e.y,N=e.V,I=e.ax,S=e.D,C=e.a0,$=e.A,M=e.z,_=e.a7,z=e.ak,K=e.al},e=>{W=e.b},e=>{T=e.u,L=e.e,U=e.i},e=>{O=e.s,B=e.u,R=e.f,Y=e.F,F=e.l,X=e.b,V=e.c},e=>{q=e.m}],execute:function(){const t=(e,t,n,r,o,i,s)=>{if(!("offsetFrom"in s)||!("offsetTo"in s))return;if(Number.isNaN(s.offsetFrom)||Number.isNaN(s.offsetTo))return;if(s.offsetFrom===s.offsetTo)return Z(t,n,r,o,i)?{x1:n,y1:r,x2:o,y2:i,offset:s.offsetFrom}:void 0;const[a,l]=[s.offsetFrom,s.offsetTo];for(let d=0;d<Math.PI;d+=Math.PI/8)for(let e=d,s=0;s<2;s++,e+=Math.PI){const[s,c,u,y]=[Math.sin(d)*a,Math.cos(d)*a,Math.sin(e)*l,Math.cos(e)*l];if(Z(t,n+s,r+c,o+u,i+y))return{x1:n+s,y1:r+c,x2:o+u,y2:i+y,offset:0}}},Z=(e,t,n,o,i)=>!(t!==o&&n!==i||![r.Diagonal,r.Perpendicular].includes(e))||!(1!==Math.abs((i-n)/(o-t))||![r.Diagonal,r.RotatePerpendicular].includes(e)),G=(e,n)=>{if(!n.every((t=>e.hasEdge(t))))return;const i=n.map((n=>{var i,s,a;const[l,d]=e.extremities(n),c=e.getNodeAttributes(l),u=e.getNodeAttributes(d),y=e.getEdgeAttribute(n,"type"),h=null!==(i=e.getEdgeAttribute(n,y))&&void 0!==i?i:o[y].defaultAttrs,p=t(0,y,c.x,c.y,u.x,u.y,h);if(p){const{x1:e,y1:t,x2:n,y2:i,offset:s}=p;return o[r.Simple].generatePath(e,n,t,i,{offset:s})}return null!==(s=null===(a=o[y])||void 0===a?void 0:a.generatePath(c.x,u.x,c.y,u.y,h))&&void 0!==s?s:`M ${c.x} ${c.y} L ${u.x} ${u.y}`}));let s=`${i[0]} `;for(let t=1;t<n.length;t+=1)s+=i[t].replace(/M\s*-?\d+(\.\d+)?(\s*|,)-?\d+(\.*\d+)?\s*/i,"");return s},H=e=>[...e.nodeEntries()].map((e=>e.node.startsWith("stn")?{id:e.node,type:"station",station:e.attributes}:{id:e.node,type:"misc-node",miscNode:e.attributes})),J=e=>{const n={},a=[],l={},d=[];for(const i of e.edgeEntries()){const[e,s,c,u]=[i.sourceAttributes.x,i.sourceAttributes.y,i.targetAttributes.x,i.targetAttributes.y],y=t(i.edge,i.attributes.type,e,s,c,u,i.attributes[i.attributes.type]);if(y);else if(i.attributes.parallelIndex>=0){a.push(i);continue}if(""===i.attributes.reconcileId)if(y){const e=i.edge,t=i.attributes,{x1:s,y1:a,x2:l,y2:d,offset:c}=y;n[e]={id:e,attr:t,path:o[r.Simple].generatePath(s,l,a,d,{offset:c})}}else d.push(i);else{const e=i.attributes.reconcileId;e in l?l[e].push(i):l[e]=[i]}}const c=new Set;for(;a.length;){const t=a.pop();if(c.has(t.edge))continue;const{normal:r,parallel:o}=i(e,t);if(!o.length)continue;o.forEach((e=>c.add(e.edge))),d.push(...r);const l=s(o);for(const e of o){const t=e.edge;n[t]={id:e.edge,attr:e.attributes,path:l[t]}}}const{allReconciledLines:u,danglingLines:y}=((e,t)=>{const n=[],r=[];return Object.values(t).forEach((t=>{if(1===t.length)return void r.push(...t.map((e=>e.edge)));const o=e.getEdgeAttribute(t.at(0),"type");if(!t.every((t=>e.getEdgeAttribute(t,"type")===o)))return void r.push(...t.map((e=>e.edge)));const i=e.getEdgeAttribute(t.at(0),"style");if(!t.every((t=>e.getEdgeAttribute(t,"style")===i)))return void r.push(...t.map((e=>e.edge)));const s={},a=new Set,l=new Set,d=Object.fromEntries(t.map((t=>{var n,r;const[o,i]=e.extremities(t);return s[o]=(null!==(n=s[o])&&void 0!==n?n:0)+1,s[i]=(null!==(r=s[i])&&void 0!==r?r:0)+1,a.add(o),l.add(i),[o,[t.edge,i]]}))),c=Array.from(a).filter((e=>1===s[e])),u=Array.from(l).filter((e=>1===s[e]));if(1!==c.length||1!==u.length)return void r.push(...t.map((e=>e.edge)));const y=c[0],h=u[0];if(y===h)return void r.push(...t.map((e=>e.edge)));const p=[d[y][0]];let f=d[y][1];for(let e=1;e<t.length;e+=1){var x;const e=null===(x=d[f])||void 0===x?void 0:x.at(1);if(!e)return void r.push(...t.map((e=>e.edge)));p.push(d[f][0]),f=e}f===h&&p.length===t.length?n.push(p):r.push(...t.map((e=>e.edge)))})),{allReconciledLines:n,danglingLines:r}})(e,l);for(const t of u){const r=G(e,t);if(!r)continue;const o=t[0];n[o]={id:o,attr:e.getEdgeAttributes(o),path:r}}for(const t of y){const i=e.getEdgeAttributes(t),[s,a]=e.extremities(t),l=e.getNodeAttributes(s),d=e.getNodeAttributes(a);n[t]={id:t,attr:i,path:o[r.Simple].generatePath(l.x,d.x,l.y,d.y,o[r.Simple].defaultAttrs)}}for(const t of d){const e=t.edge,r=t.attributes.type,i=t.attributes,[s,a,l,d]=[t.sourceAttributes.x,t.sourceAttributes.y,t.targetAttributes.x,t.targetAttributes.y];n[e]=r in o?{id:e,attr:i,path:o[r].generatePath(s,l,a,d,i[r])}:{id:e,attr:i,path:`M ${s} ${a} L ${l} ${d}`}}return Object.values(n).map((e=>({id:e.id,type:"line",line:e})))},Q=e=>{const{id:t,x:r,y:o,handlePointerDown:i,handlePointerMove:s,handlePointerUp:a}=e,l=W.useCallback((e=>i(t,e)),[t,i]),d=W.useCallback((e=>s(t,e)),[t,s]),c=W.useCallback((e=>a(t,e)),[t,a]);return n.jsx("g",{id:t,transform:`translate(${r-6.4} ${o-6.4})scale(0.025)`,onPointerDown:l,onPointerMove:d,onPointerUp:c,style:{cursor:"move"},children:n.jsx("path",{id:`stn_core_${t}`,fillRule:"evenodd",clipRule:"evenodd",d:"M256 0c70.69 0 134.7 28.66 181.02 74.98C483.34 121.31 512 185.31 512 256c0 70.69-28.66 134.7-74.98 181.02C390.7 483.34 326.69 512 256 512c-70.69 0-134.69-28.66-181.02-74.98C28.66 390.7 0 326.69 0 256c0-70.69 28.66-134.69 74.98-181.02C121.31 28.66 185.31 0 256 0zm-21.91 302.69v-2.07c.16-13.72 1.51-24.59 4.15-32.67 2.59-8.08 6.32-14.65 11.18-19.63 4.87-5.02 10.72-9.58 17.56-13.72 4.4-2.8 8.39-5.9 11.91-9.37 3.52-3.42 6.32-7.41 8.38-11.91 2.07-4.46 3.11-9.42 3.11-14.91 0-6.53-1.55-12.18-4.66-16.99-3.05-4.77-7.19-8.44-12.27-11.08-5.13-2.59-10.82-3.89-17.09-3.89-5.65 0-11.03 1.15-16.21 3.53-5.12 2.33-9.42 6-12.79 10.97-3.36 4.98-5.33 11.35-5.85 19.11h-33.56c.53-13.21 3.89-24.39 10.05-33.55 6.21-9.16 14.4-16.11 24.55-20.82 10.2-4.71 21.49-7.04 33.81-7.04 13.57 0 25.38 2.48 35.52 7.56 10.15 5.02 18.08 12.06 23.72 21.08 5.59 9 8.44 19.47 8.44 31.48 0 8.23-1.29 15.64-3.88 22.21-2.59 6.58-6.22 12.48-10.98 17.61-4.77 5.18-10.41 9.73-17.03 13.67-6.27 3.94-11.35 7.97-15.18 12.17-3.88 4.19-6.68 9.17-8.44 14.86-1.76 5.74-2.75 12.84-2.9 21.33v2.07h-31.54zm16.68 70.67c-6.06 0-11.24-2.18-15.59-6.48-4.34-4.29-6.47-9.53-6.47-15.63 0-6.01 2.12-11.19 6.47-15.49 4.35-4.3 9.53-6.47 15.59-6.47 5.95 0 11.12 2.19 15.48 6.47 4.39 4.31 6.58 9.48 6.58 15.49 0 4.04-1.05 7.76-3.06 11.08-2.02 3.35-4.66 6.07-7.97 8.03-3.31 1.96-6.99 3-11.03 3z"})})},ee=e=>{const{id:t,path:r,handlePointerDown:o}=e,i=W.useCallback((e=>o(t,e)),[t,o]);return n.jsx("path",{id:t,d:r,fill:"none",stroke:"grey",strokeWidth:"5",strokeLinecap:"round",cursor:"pointer",onPointerDown:i})},te=e=>{const{elements:t,handlePointerDown:r,handlePointerMove:o,handlePointerUp:i,handleEdgePointerDown:s}=e,l=Object.fromEntries(Array.from({length:21},((e,t)=>[t-10,{pre:[],main:[],post:[]}])));for(const w of t)if("line"===w.type){var d,c,u,y;const e=w.line.attr.type,t=w.line.attr.style,r=w.line.attr[t],o=null===(d=a[t])||void 0===d?void 0:d.preComponent;o&&l[w.line.attr.zIndex].pre.push(n.jsx(o,{id:w.id,type:e,path:w.line.path,styleAttrs:r,newLine:!1,handlePointerDown:s},`${w.id}.pre`));const i=null!==(c=null===(u=a[t])||void 0===u?void 0:u.component)&&void 0!==c?c:ee;l[w.line.attr.zIndex].main.push(n.jsx(i,{id:w.id,type:e,path:w.line.path,styleAttrs:r,newLine:!1,handlePointerDown:s},w.id));const h=null===(y=a[t])||void 0===y?void 0:y.postComponent;h&&l[w.line.attr.zIndex].post.push(n.jsx(h,{id:w.id,type:e,path:w.line.path,styleAttrs:r,newLine:!1,handlePointerDown:s},`${w.id}.post`))}else if("station"===w.type){var h,p,f,x;const e=w.station,t=e.type,s=null===(h=O[t])||void 0===h?void 0:h.preComponent;s&&l[w.station.zIndex].pre.push(n.jsx(s,{id:w.id,x:e.x,y:e.y,attrs:e,handlePointerDown:r,handlePointerMove:o,handlePointerUp:i},`${w.id}.pre`));const a=null!==(p=null===(f=O[t])||void 0===f?void 0:f.component)&&void 0!==p?p:Q;l[w.station.zIndex].main.push(n.jsx(a,{id:w.id,x:e.x,y:e.y,attrs:e,handlePointerDown:r,handlePointerMove:o,handlePointerUp:i},w.id));const d=null===(x=O[t])||void 0===x?void 0:x.postComponent;d&&l[w.station.zIndex].post.push(n.jsx(d,{id:w.id,x:e.x,y:e.y,attrs:e,handlePointerDown:r,handlePointerMove:o,handlePointerUp:i},`${w.id}.post`))}else if("misc-node"===w.type){var g,v,m,b;const e=w.miscNode,t=e.type,s=null===(g=q[t])||void 0===g?void 0:g.preComponent;s&&l[w.miscNode.zIndex].pre.push(n.jsx(s,{id:w.id,x:e.x,y:e.y,attrs:e[t],handlePointerDown:r,handlePointerMove:o,handlePointerUp:i},`${w.id}.pre`));const a=null!==(v=null===(m=q[t])||void 0===m?void 0:m.component)&&void 0!==v?v:Q;l[w.miscNode.zIndex].main.push(n.jsx(a,{id:w.id,x:e.x,y:e.y,attrs:e[t],handlePointerDown:r,handlePointerMove:o,handlePointerUp:i},w.id));const d=null===(b=q[t])||void 0===b?void 0:b.postComponent;d&&l[w.miscNode.zIndex].post.push(n.jsx(d,{id:w.id,x:e.x,y:e.y,attrs:e[t],handlePointerDown:r,handlePointerMove:o,handlePointerUp:i},`${w.id}.post`))}return Array.from({length:21},((e,t)=>(t-10).toString())).map((e=>[...l[e].pre,...l[e].main,...l[e].post])).flat()},ne=()=>{const e=l(),t=W.useRef(window.graph),{telemetry:{project:r},preference:{autoParallel:i}}=d((e=>e.app)),{svgViewBoxZoom:s,svgViewBoxMin:a}=d((e=>e.param)),{selected:S,refresh:{nodes:C,edges:$},mode:M,active:_,keepLastPath:z,theme:K}=d((e=>e.runtime)),[L,U]=W.useState({x:0,y:0}),[B,R]=W.useState({x:0,y:0}),Y=T(((t,n)=>{n.stopPropagation(),"select"===M&&e(c("free"));const r=n.currentTarget,{x:o,y:i}=u(n);r.setPointerCapture(n.pointerId),U({x:o,y:i}),e(y(t)),n.shiftKey?S.has(t)?e(p(t)):e(f(t)):S.has(t)||e(h(new Set([t])))})),F=T(((n,r)=>{const{x:o,y:i}=u(r);"free"===M&&_===n?(S.forEach((e=>{t.current.hasNode(e)&&t.current.updateNodeAttributes(e,(e=>({...e,x:x(e.x-(L.x-o)*s/100,r.altKey?1:5),y:x(e.y-(L.y-i)*s/100,r.altKey?1:5)})))})),e(g()),e(v())):M.startsWith("line")&&R({x:(L.x-o)*s/100,y:(L.y-i)*s/100})})),X=T(((n,s)=>{if(M.startsWith("line")){z||e(c("free"));const n=[...Object.values(m),b.Virtual,b.Master],a=t.current.hasNode(_)&&n.includes(t.current.getNodeAttribute(_,"type"));["stn_core_","virtual_circle_"].forEach((e=>{var n;const l=null===(n=document.elementsFromPoint(s.clientX,s.clientY)[0].attributes)||void 0===n||null===(n=n.getNamedItem("id"))||void 0===n?void 0:n.value,d=null==l?void 0:l.startsWith(e);if(a&&d){const n=M.slice(5),s=`line_${w(10)}`,[a,d]=[_,l.slice(e.length)],c=i?P(t.current,n,a,d,"from"):-1;t.current.addDirectedEdgeWithKey(s,a,d,{visible:!0,zIndex:0,type:n,[n]:structuredClone(o[n].defaultAttrs),style:A.SingleColor,[A.SingleColor]:{color:K},reconcileId:"",parallelIndex:c}),r&&k.event(E.ADD_LINE,{type:n})}})),e(v()),e(j(t.current.export()))}else if("free"===M&&_){const{x:n,y:r}=u(s);L.x-n==0&&L.y-r==0||e(j(t.current.export()))}e(y(void 0))})),V=T(((n,o)=>{if(o.stopPropagation(),o.shiftKey||e(D()),o.shiftKey&&S.has(n)?e(p(n)):e(f(n)),M.startsWith("station")||M.startsWith("misc-node-virtual")||M.startsWith("misc-node-master")){const l=o.clientX-document.getElementById("canvas").getBoundingClientRect().left,d=o.clientY-document.getElementById("canvas").getBoundingClientRect().top,u=M.startsWith("station"),y=w(10),p=u?`stn_${y}`:`misc_node_${y}`,f=u?M.slice(8):M.slice(10),{x:m,y:b}=N(l,d,s,a),P=u?structuredClone(O[f].defaultAttrs):structuredClone(q[f].defaultAttrs);"color"in P&&(P.color=K),t.current.addNode(p,{visible:!0,zIndex:0,x:x(m,5),y:x(b,5),type:f,[f]:P});const A=t.current.getEdgeAttributes(n),{zIndex:D,type:I,style:S}=A,C=A[I],$=A[S],[_,z]=t.current.extremities(n),W=i?0:-1;t.current.addDirectedEdgeWithKey(`line_${w(10)}`,_,p,{visible:!0,zIndex:D,type:I,[I]:structuredClone(C),style:S,[S]:structuredClone($),reconcileId:"",parallelIndex:W}),t.current.addDirectedEdgeWithKey(`line_${w(10)}`,p,z,{visible:!0,zIndex:D,type:I,[I]:structuredClone(C),style:S,[S]:structuredClone($),reconcileId:"",parallelIndex:W}),t.current.dropEdge(n),e(g()),e(v()),e(j(t.current.export())),r&&(k.event(E.ADD_STATION,{type:f}),k.event(E.ADD_LINE,{type:I})),e(c("free")),e(h(new Set([p])))}})),Z=W.useMemo((()=>[...J(t.current),...H(t.current)]),[$,C]),G=I.component;return n.jsxs(n.Fragment,{children:[n.jsx(te,{elements:Z,handlePointerDown:Y,handlePointerMove:F,handlePointerUp:X,handleEdgePointerDown:V}),M.startsWith("line")&&_&&"background"!==_&&n.jsx(G,{id:"line_create_in_progress___no_use",type:M.slice(5),path:o[M.slice(5)].generatePath(t.current.getNodeAttribute(_,"x"),t.current.getNodeAttribute(_,"x")-B.x,t.current.getNodeAttribute(_,"y"),t.current.getNodeAttribute(_,"y")-B.y,o[M.slice(5)].defaultAttrs),styleAttrs:{color:K},newLine:!0,handlePointerDown:()=>{}})]})};e("default",(()=>{const e=l(),t=W.useRef(window.graph),r=()=>{e(g()),e(v()),e(j(t.current.export()))},{telemetry:{project:o}}=d((e=>e.app)),{svgViewBoxZoom:i,svgViewBoxMin:s}=d((e=>e.param)),{mode:a,lastTool:p,active:f,selected:m,keepLastPath:b,theme:P,refresh:{nodes:A}}=d((e=>e.runtime)),I=B(),{height:Z,width:G}=S(I);W.useEffect((()=>{const e=R(t.current);Object.entries(e).filter((([e,t])=>t&&e in Y)).forEach((([e])=>F(e)))}),[A]);const[H,J]=W.useState({x:0,y:0}),[Q,ee]=W.useState({x:0,y:0}),[te,re]=W.useState({x:0,y:0}),[oe,ie]=W.useState({x:0,y:0}),se=T((n=>{const{x:l,y:d}=u(n);if(a.startsWith("station")){e(c("free"));const n=`stn_${w(10)}`,u=a.slice(8),y=structuredClone(O[u].defaultAttrs);"color"in y&&(y.color=P);const{x:p,y:f}=N(l,d,i,s);t.current.addNode(n,{visible:!0,zIndex:0,x:x(p,5),y:x(f,5),type:u,[u]:y}),r(),o&&k.event(E.ADD_STATION,{type:u}),e(h(new Set([n])))}else if(a.startsWith("misc-node")){e(c("free"));const n=`misc_node_${w(10)}`,u=a.slice(10),{x:y,y:p}=N(l,d,i,s);t.current.addNode(n,{visible:!0,zIndex:0,x:x(y,5),y:x(p,5),type:u,[u]:structuredClone(q[u].defaultAttrs)}),r(),o&&k.event(E.ADD_STATION,{type:u}),e(h(new Set([n])))}else"free"===a||a.startsWith("line")?(a.startsWith("line")&&(e(c("free")),b&&e(C(!1))),re({x:l,y:d}),ie(s),n.shiftKey||(e(y("background")),e(D()))):"select"===a&&(J(N(l,d,i,s)),ee(N(l,d,i,s)))})),ae=T((t=>{if("select"===a){if(0!=H.x&&0!=H.y){const{x:e,y:n}=u(t);ee(N(e,n,i,s))}}else if("background"===f){const{x:n,y:r}=u(t);e($({x:oe.x+(te.x-n)*i/100,y:oe.y+(te.y-r)*i/100}))}})),le=T((n=>{if("select"===a){const{x:r,y:o}=u(n),{x:a,y:l}=N(r,o,i,s),d=X(t.current,H.x,H.y,a,l),y=V(t.current,new Set(d));e(h(new Set([...n.shiftKey?m:[],...d,...y]))),e(c("free")),J({x:0,y:0}),ee({x:0,y:0})}"background"!==f||n.shiftKey||e(y(void 0))})),de=T((t=>{let n=i;t.deltaY>0&&i+10<400?n=i+10:t.deltaY<0&&i-10>0&&(n=i-10),e(M(n));const{x:r,y:o}=u(t),a=t.currentTarget.getBoundingClientRect(),[l,d]=[r/a.width,o/a.height];e($({x:s.x+r*i/100-G*n/100*l,y:s.y+o*i/100-Z*n/100*d}))})),ce=T((async n=>{if(_?"Backspace"===n.key:"Delete"===n.key)m.size>0&&(m.forEach((e=>{t.current.hasNode(e)?t.current.dropNode(e):t.current.hasEdge(e)&&t.current.dropEdge(e)})),e(D()),r());else if(n.key.startsWith("Arrow")){const t=100,r=n.key.endsWith("Left")?-1:n.key.endsWith("Right")?1:0,o=n.key.endsWith("Up")?-1:n.key.endsWith("Down")?1:0;e($(N(t*r,t*o,i,s)))}else if("i"===n.key||"j"===n.key||"k"===n.key||"l"===n.key){const e=10,o=("j"===n.key?-1:"l"===n.key?1:0)*e,i=("i"===n.key?-1:"k"===n.key?1:0)*e;m.size>0&&m.forEach((e=>{t.current.hasNode(e)&&(t.current.updateNodeAttribute(e,"x",(e=>(null!=e?e:0)+o)),t.current.updateNodeAttribute(e,"y",(e=>(null!=e?e:0)+i)),r())}))}else if("f"===n.key&&p)e(c(p));else if("z"===n.key&&(_?n.metaKey&&!n.shiftKey:n.ctrlKey))_&&n.preventDefault(),e(z()),r();else if("s"===n.key)e(c("select"));else if("c"!==n.key&&"x"!==n.key||!(_?n.metaKey&&!n.shiftKey:n.ctrlKey))if("v"===n.key&&(_?n.metaKey&&!n.shiftKey:n.ctrlKey)){const n=await navigator.clipboard.readText(),{x:o,y:a}=N(G/2,Z/2,i,s),{nodes:l,edges:d}=U(n,t.current,x(o,5),x(a,5));r();const c=structuredClone(l);d.forEach((e=>c.add(e))),e(h(c))}else(_&&"z"===n.key&&n.metaKey&&n.shiftKey||!_&&"y"===n.key&&n.ctrlKey)&&(e(K()),r());else{const o=L(t.current,m);navigator.clipboard.writeText(o),"x"===n.key&&(e(D()),m.forEach((e=>{t.current.hasNode(e)?t.current.dropNode(e):t.current.hasEdge(e)&&t.current.dropEdge(e)})),r())}})),[ue,ye]=W.useState(0),he=T((t=>{if(2===t.touches.length){e(y(void 0));const[n,r]=[t.touches[0].clientX-t.touches[1].clientX,t.touches[0].clientY-t.touches[1].clientY];ye(n*n+r*r)}})),pe=T((t=>{if(0!==ue&&2===t.touches.length){const[n,r]=[t.touches[0].clientX-t.touches[1].clientX,t.touches[0].clientY-t.touches[1].clientY],o=n*n+r*r;let a=i;o-ue<0&&i+10<=390?a=i+10:o-ue>0&&i-10>=10&&(a=i-10),e(M(a)),ye(o);const l=t.currentTarget.getBoundingClientRect(),[d,c]=[(t.touches[0].clientX+t.touches[1].clientX)/2-l.left,(t.touches[0].clientY+t.touches[1].clientY)/2-l.top],[u,y]=[d/l.width,c/l.height];e($({x:s.x+d*i/100-G*a/100*u,y:s.y+c*i/100-Z*a/100*y}))}})),fe=T((e=>{0!==ue&&ye(0)})),[xe,ge]=W.useState({sx:0,sy:0,ex:0,ey:0});return W.useEffect((()=>{ge({sx:H.x<=Q.x?H.x:Q.x,ex:H.x>Q.x?H.x:Q.x,sy:H.y<=Q.y?H.y:Q.y,ey:H.y>Q.y?H.y:Q.y})}),[Q.x,Q.y]),n.jsxs("svg",{xmlns:"http://www.w3.org/2000/svg",id:"canvas",style:{position:"fixed",top:40,left:40,userSelect:"none",touchAction:"none"},height:Z,width:G,viewBox:`${s.x} ${s.y} ${G*i/100} ${Z*i/100}`,onPointerDown:se,onPointerMove:ae,onPointerUp:le,onTouchStart:he,onTouchMove:pe,onTouchEnd:fe,onWheel:de,tabIndex:0,onKeyDown:ce,children:[n.jsx(ne,{}),"select"===a&&0!=H.x&&0!=H.y&&n.jsx("rect",{x:xe.sx,y:xe.sy,width:xe.ex-xe.sx,height:xe.ey-xe.sy,rx:"2",stroke:"#b5b5b6",strokeWidth:"2",strokeOpacity:"0.4",fill:"#b5b5b6",opacity:"0.75"}),n.jsx("defs",{children:n.jsxs("pattern",{id:"opaque",width:"5",height:"5",patternUnits:"userSpaceOnUse",children:[n.jsx("rect",{x:"0",y:"0",width:"2.5",height:"2.5",fill:"black",fillOpacity:"50%"}),n.jsx("rect",{x:"2.5",y:"2.5",width:"2.5",height:"2.5",fill:"black",fillOpacity:"50%"})]})})]})}))}}}));
