System.register(["./chakra-legacy-YGIgOwam.js","./index-legacy-cnsPogOr.js","./react-legacy-T1GznqXM.js","./graph-legacy-Q40o6j_e.js","./stations-legacy-IOSVlksg.js"],(function(e,t){"use strict";var s,n,a,i,r,l,o,c,d,u,g,h,p,y,m,b,f,S,j,C,x,A,E,v,O,T,N,L,w,W,k,P,z,B,F,I,R,_;return{setters:[e=>{s=e.j,n=e.at,a=e.$,i=e.au,r=e.a1,l=e.a4,o=e.a2,c=e.a3,d=e.aM,u=e.aN,g=e.aO,h=e.B,p=e.aP,y=e.aQ,m=e.a5,b=e.O},e=>{f=e.S,S=e.ab,j=e.m,C=e.L,x=e.o,A=e.f,E=e.a,v=e.q,O=e.t,T=e.v,N=e.C,L=e.c,w=e.l,W=e.ao,k=e.R,P=e.T,z=e.H,B=e.j},e=>{F=e.u,I=e.b},e=>{R=e.c},e=>{_=e.s}],execute:function(){const t=[f.ShmetroBasic2020],D=e("b",((e,s,n)=>{const a=e.getNodeAttribute(s,"type"),i=e.getNodeAttribute(s,a).names,r={..._[n].defaultAttrs,names:i};Object.values(t).includes(a)&&Object.values(t).includes(n)||(r.nameOffsetX=e.getNodeAttribute(s,a).nameOffsetX,r.nameOffsetY=e.getNodeAttribute(s,a).nameOffsetY),e.removeNodeAttribute(s,a),e.mergeNodeAttributes(s,{type:n,[n]:r})})),H=e("c",((e,t,s)=>{const n=e.getEdgeAttribute(t,"type"),a=e.getEdgeAttribute(t,"style");if(S[a].metadata.supportLinePathType.includes(s)){e.removeEdgeAttribute(t,n);const a=structuredClone(j[s].defaultAttrs);e.mergeEdgeAttributes(t,{type:s,[s]:a})}})),M=e("a",((e,t,s,n)=>{const a=e.getEdgeAttribute(t,"type"),i=e.getEdgeAttribute(t,"style");if(S[s].metadata.supportLinePathType.includes(a)){const a=e.getEdgeAttribute(t,"zIndex"),r=e.getEdgeAttribute(t,i);e.removeEdgeAttribute(t,i);const l=structuredClone(S[s].defaultAttrs);C.includes(i)&&C.includes(s)?l.color=r.color:C.includes(s)&&n&&(l.color=n),e.mergeEdgeAttributes(t,{style:s,[s]:l}),s===x.River?e.setEdgeAttribute(t,"zIndex",-5):e.setEdgeAttribute(t,"zIndex",null!=a?a:0)}}));e("C",(e=>{const{isOpen:t,onClose:X,isSelect:Y,filter:q}=e,{t:Q}=F(),$=A(),{selected:G,theme:J,paletteAppClip:{output:K}}=E((e=>e.runtime)),U=I.useCallback((()=>{$(v()),$(O()),$(T(V.current.export()))}),[$,v,O,T]),V=I.useRef(window.graph),Z={any:Q("header.settings.procedures.changeType.any"),...Object.fromEntries(Object.entries(j).map((([e,t])=>[e,Q(t.metadata.displayName).toString()])))},ee={any:Q("header.settings.procedures.changeType.any"),...Object.fromEntries(Object.entries(S).map((([e,t])=>[e,Q(t.metadata.displayName).toString()])))},te={any:Q("header.settings.procedures.changeType.any"),...Object.fromEntries(Object.entries(_).map((([e,t])=>[e,Q(t.metadata.displayName).toString()])))},se={id:"any",theme:[N.Other,"other","#ffffff",L.black],value:Q("header.settings.procedures.changeType.any")},[ne,ae]=I.useState(!1),[ie,re]=I.useState("any"),[le,oe]=I.useState(f.ShmetroBasic),[ce,de]=I.useState(!1),[ue,ge]=I.useState("any"),[he,pe]=I.useState(x.SingleColor),[ye,me]=I.useState(!1),[be,fe]=I.useState("any"),[Se,je]=I.useState(w.Diagonal),[Ce,xe]=I.useState(!1),[Ae,Ee]=I.useState(se),[ve,Oe]=I.useState(J),[Te,Ne]=I.useState(!1);I.useEffect((()=>{Te&&K&&(Oe(K),Ne(!1))}),[null==K?void 0:K.toString()]);const[Le,we]=I.useState([]),We=[{id:"changeStationType",title:Q("header.settings.procedures.changeStationType.title"),onClose:()=>ae(!ne),field:[{type:"select",label:Q("header.settings.procedures.changeStationType.changeFrom"),options:te,value:ie,disabledOptions:[le],onChange:e=>re(e)},{type:"select",label:Q("header.settings.procedures.changeStationType.changeTo"),options:te,value:le,disabledOptions:["any",ie],onChange:e=>oe(e)}]},{id:"changeLineStyleType",title:Q("header.settings.procedures.changeLineStyleType.title"),onClose:()=>de(!ce),field:[{type:"select",label:Q("header.settings.procedures.changeLineStyleType.changeFrom"),options:ee,value:ue,disabledOptions:[he],onChange:e=>ge(e)},{type:"select",label:Q("header.settings.procedures.changeLineStyleType.changeTo"),options:ee,value:he,disabledOptions:["any",ue],onChange:e=>pe(e)}]},{id:"changeLinePathType",title:Q("header.settings.procedures.changeLinePathType.title"),onClose:()=>me(!ye),field:[{type:"select",label:Q("header.settings.procedures.changeLinePathType.changeFrom"),options:Z,value:be,disabledOptions:[Se],onChange:e=>fe(e)},{type:"select",label:Q("header.settings.procedures.changeLinePathType.changeTo"),options:Z,value:Se,disabledOptions:["any","simple",be],onChange:e=>je(e)}]},{id:"changeColor",title:Q("header.settings.procedures.changeColor.title"),onClose:()=>xe(!Ce),field:[{type:"custom",label:Q("header.settings.procedures.changeColor.changeFrom"),component:s.jsx(W,{data:Le,displayHandler:e=>s.jsx(k,{name:e.value,fg:e.theme[3],bg:e.theme[2],title:e.theme[1],sx:{display:"inline-block",overflow:"hidden",textOverflow:"ellipsis"}}),filter:(e,t)=>t.id.toLowerCase().includes(e.toLowerCase())||Object.values(t.id).some((t=>t.toLowerCase().includes(e.toLowerCase()))),value:Ae.value,onChange:e=>Ee(e)})},{type:"custom",label:Q("header.settings.procedures.changeColor.changeTo"),component:s.jsx(P,{theme:ve,onClick:()=>{Ne(!0),$(z(J))}})}]}];return I.useEffect((()=>{t&&(ae(!1),de(!1),me(!1),xe(!1),we([se,...R(V.current,Y?[...G].filter((e=>e.startsWith("stn")||e.startsWith("misc_node"))):V.current.nodes(),Y?[...G].filter((e=>e.startsWith("line"))):V.current.edges()).map((e=>({id:e.toString(),theme:e,value:"other"===e[1]?e[2]:e[1]})))]),Ee(se))}),[t]),s.jsxs(n,{isOpen:t,onClose:X,size:"md",scrollBehavior:"inside",children:[s.jsx(a,{}),s.jsxs(i,{children:[s.jsxs(r,{children:[s.jsx(l,{as:"b",fontSize:"xl",children:Q(Y?"panel.details.multipleSelection.change":"header.settings.procedures.changeType.title")}),s.jsx(o,{})]}),s.jsx(c,{children:s.jsx(d,{allowMultiple:!0,children:We.map((e=>s.jsxs(u,{children:[s.jsxs(g,{onClick:e.onClose,children:[s.jsx(h,{as:"span",flex:"1",textAlign:"left",children:s.jsx(l,{as:"b",fontSize:"md",children:e.title})}),s.jsx(p,{})]}),s.jsx(y,{pb:4,children:s.jsx(B,{fields:e.field,minW:270})})]},e.id)))})}),s.jsxs(m,{children:[s.jsx(b,{colorScheme:"blue",variant:"outline",mr:"1",onClick:X,children:Q("cancel")}),s.jsx(b,{colorScheme:"red",mr:"1",onClick:()=>{const e=null!=q&&q.includes("station")?[...G].filter((e=>e.startsWith("stn"))):Y?[]:V.current.filterNodes((e=>e.startsWith("stn"))),t=null!=q&&q.includes("misc-node")?[...G].filter((e=>e.startsWith("misc_node"))):Y?[]:V.current.filterNodes((e=>e.startsWith("misc_node"))),s=Y?[...G].filter((e=>e.startsWith("line"))):V.current.edges();q&&!q.includes("station")||!ne||((e,t,s,n)=>{n.filter((s=>"any"===t||e.getNodeAttribute(s,"type")===t)).forEach((t=>{D(e,t,s)}))})(V.current,ie,le,e),q&&!q.includes("line")||!ce||((e,t,s,n,a)=>{a.filter((s=>"any"===t||e.getEdgeAttribute(s,"style")===t)).forEach((t=>{M(e,t,s,n)}))})(V.current,ue,he,J,s),q&&!q.includes("line")||!ye||((e,t,s,n)=>{n.filter((s=>"any"===t||e.getEdgeAttribute(s,"type")===t)).forEach((t=>{H(e,t,s)}))})(V.current,be,Se,s),Ce&&(q&&!q.includes("line")||((e,t,s,n)=>{n.filter((t=>C.includes(e.getEdgeAttribute(t,"style")))).forEach((n=>{const a=e.getEdgeAttributes(n),i=a[a.style].color;("any"===t||i[0]==t[0]&&i[1]==t[1]&&i[2]==t[2]&&i[3]==t[3])&&e.mergeEdgeAttributes(n,{[a.style]:{color:s}})}))})(V.current,"any"===Ae.id?"any":Ae.theme,ve,s),(!q||q.includes("misc-node")||q.includes("station"))&&((e,t,s,n,a)=>{[...n,...a].forEach((n=>{const a=e.getNodeAttributes(n).type,i=e.getNodeAttribute(n,a);if(void 0!==i.color){const e=i.color;("any"===t||e[0]==t[0]&&e[1]==t[1]&&e[2]==t[2]&&e[3]==t[3])&&(i.color=s)}e.mergeNodeAttributes(n,{[a]:i})}))})(V.current,"any"===Ae.id?"any":Ae.theme,ve,e,t)),U(),X()},isDisabled:!(ne||ce||ye||Ce),children:Q("apply")})]})]})]})}))}}}));
