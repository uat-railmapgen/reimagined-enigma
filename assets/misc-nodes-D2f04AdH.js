import{aM as D,C as M,b as L,aN as z,aw as f,j as _,T as ke,R as pe,a as je,e as Ne,F as we,c as _e,aO as $e,aP as de,t as me,w as ue,ai as Ie,W as Re,X as Ee}from"./index-CLpasVGo.js";import{j as e,at as Ce,$ as Be,au as ve,a1 as Le,a2 as Se,a3 as Te,a5 as Pe,O,aL as Me,g as he}from"./chakra-C3T8NphC.js";import{b as r,u as R}from"./react-DV6nCJb6.js";import{L as Ue,M as ge,g as De,t as ce,h as We,j as ze,d as Fe,k as Oe}from"./stations-B09RKorw.js";const qe=o=>{const{id:n,x:t,y:c,handlePointerDown:s,handlePointerMove:l,handlePointerUp:a}=o,h=r.useCallback(m=>s(n,m),[n,s]),u=r.useCallback(m=>l(n,m),[n,l]),x=r.useCallback(m=>a(n,m),[n,a]);return e.jsxs("g",{id:n,transform:"translate(".concat(t,", ").concat(c,")rotate(45)"),onPointerDown:h,onPointerMove:u,onPointerUp:x,style:{cursor:"move"},children:[e.jsx("line",{x1:"-5",y1:"0",x2:"5",y2:"0",stroke:"black"}),e.jsx("line",{x1:"0",y1:"-5",x2:"0",y2:"5",stroke:"black"}),e.jsx("circle",{id:"virtual_circle_".concat(n),r:5,stroke:"black",fill:"white",fillOpacity:"0"})]})},Ve={},He=()=>e.jsx(D,{fields:[]}),Xe=e.jsxs("svg",{viewBox:"0 0 24 24",height:40,width:40,transform:"rotate(45)",focusable:!1,children:[e.jsx("circle",{cx:"12",cy:"12",r:"6",stroke:"currentColor",fill:"none"}),e.jsx("line",{x1:"6",y1:"12",x2:"18",y2:"12",stroke:"currentColor"}),e.jsx("line",{x1:"12",y1:"6",x2:"12",y2:"18",stroke:"currentColor"})]}),Je={component:qe,icon:Xe,defaultAttrs:Ve,attrsComponent:He,metadata:{displayName:"panel.details.nodes.virtual.displayName",tags:[]}},Qe=o=>{const{id:n,x:t,y:c,attrs:s,handlePointerDown:l,handlePointerMove:a,handlePointerUp:h}=o,{num:u=X.num,color:x=X.color}=s!=null?s:X,[m,j]=u>=10?[22.67,10.75]:[21,10],y=r.useCallback(g=>l(n,g),[n,l]),b=r.useCallback(g=>a(n,g),[n,a]),p=r.useCallback(g=>h(n,g),[n,h]);return e.jsxs("g",{id:n,transform:"translate(".concat(t,", ").concat(c,")"),onPointerDown:y,onPointerMove:b,onPointerUp:p,style:{cursor:"move"},children:[e.jsx("rect",{fill:x[2],width:m,height:"22.67"}),e.jsx("text",{className:"rmp-name__zh",textAnchor:"middle",x:j,y:"19",fill:x[3],fontSize:"21.33",letterSpacing:"-1.75",children:u}),e.jsx("text",{className:"rmp-name__zh",x:m+2,y:"12",fontSize:"14.67",children:"号线"}),e.jsxs("text",{className:"rmp-name__en",x:m+4,y:"21.5",fontSize:"8",children:["Line ",u]})]})},X={num:1,color:[M.Shanghai,"sh1","#E4002B",L.white]},Ge=[{type:"input",label:"panel.details.nodes.common.num",value:o=>(o!=null?o:X).num,validator:o=>!Number.isNaN(o),onChange:(o,n)=>{const t=n!=null?n:X;return Number.isNaN(o)||(t.num=Number(o)),t}},{type:"custom",label:"color",component:e.jsx(z,{type:f.ShmetroNumLineBadge,defaultTheme:X.color})}],Ze=()=>e.jsx(D,{fields:Ge}),Ye=e.jsxs("svg",{viewBox:"0 0 24 24",height:40,width:40,focusable:!1,children:[e.jsx("rect",{fill:"currentColor",x:"2",y:"4",width:"10",height:"16"}),e.jsx("text",{x:"4",y:"18",fill:"white",children:"1"}),e.jsx("text",{x:"14",y:"10",fontSize:"5",children:"号线"}),e.jsx("text",{x:"14",y:"18",fontSize:"4",children:"Line 1"})]}),Ke={component:Qe,icon:Ye,defaultAttrs:X,attrsComponent:Ze,metadata:{displayName:"panel.details.nodes.shmetroNumLineBadge.displayName",tags:[]}},en=o=>{const{id:n,x:t,y:c,attrs:s,handlePointerDown:l,handlePointerMove:a,handlePointerUp:h}=o,{names:u=ne.names,color:x=ne.color}=s!=null?s:ne,m=r.useRef(null),[j,y]=r.useState({width:12});r.useEffect(()=>y(m.current.getBBox()),[...u,y,m]);const b=r.useCallback(N=>l(n,N),[n,l]),p=r.useCallback(N=>a(n,N),[n,a]),g=r.useCallback(N=>h(n,N),[n,h]);return e.jsxs("g",{id:n,transform:"translate(".concat(t,", ").concat(c,")"),onPointerDown:b,onPointerMove:p,onPointerUp:g,style:{cursor:"move"},children:[e.jsx("rect",{fill:x[2],x:"0",width:j.width+7,height:"21"}),e.jsxs("g",{ref:m,children:[e.jsx("text",{className:"rmp-name__zh",textAnchor:"middle",dominantBaseline:"hanging",x:(j.width+7)/2,y:"4",fontSize:"10",fill:x[3],letterSpacing:"-0.25",children:u[0]}),e.jsx("text",{className:"rmp-name__en",textAnchor:"middle",dominantBaseline:"hanging",x:(j.width+7)/2,y:"13",fontSize:"5",fill:x[3],letterSpacing:"-0.25",children:u[1]})]})]})},ne={names:["浦江线","Pujiang Line"],color:[M.Shanghai,"pjl","#B5B5B6",L.white]},nn=o=>{const{id:n,attrs:t,handleAttrsUpdate:c}=o,{t:s}=R(),l=[{type:"textarea",label:s("panel.details.nodes.common.nameZh"),value:t.names[0],onChange:a=>{t.names[0]=a,c(n,t)},minW:"full"},{type:"input",label:s("panel.details.nodes.common.nameEn"),value:t.names[1],onChange:a=>{t.names[1]=a,c(n,t)},minW:"full"},{type:"custom",label:s("color"),component:e.jsx(z,{type:f.ShmetroTextLineBadge,defaultTheme:ne.color})}];return e.jsx(_,{fields:l})},tn=e.jsxs("svg",{viewBox:"0 0 24 24",height:40,width:40,focusable:!1,children:[e.jsx("rect",{fill:"currentColor",x:"2",y:"6",width:"20",height:"12"}),e.jsx("text",{x:"5",y:"11",fontSize:"5",fill:"white",children:"浦江线"}),e.jsx("text",{x:"3",y:"16",fontSize:"4",fill:"white",children:"Pujiang Line"})]}),on={component:en,icon:tn,defaultAttrs:ne,attrsComponent:nn,metadata:{displayName:"panel.details.nodes.shmetroTextLineBadge.displayName",tags:[]}},sn=o=>{var g,N;const{id:n,x:t,y:c,attrs:s,handlePointerDown:l,handlePointerMove:a,handlePointerUp:h}=o,{names:u=q.names,color:x=q.color,tram:m=q.tram,span:j=q.span}=s!=null?s:q,y=r.useCallback(i=>l(n,i),[n,l]),b=r.useCallback(i=>a(n,i),[n,a]),p=r.useCallback(i=>h(n,i),[n,h]);return e.jsx("g",{id:n,transform:"translate(".concat(t,", ").concat(c,")scale(").concat(m?.5:1,")"),onPointerDown:y,onPointerMove:b,onPointerUp:p,style:{cursor:"move"},children:e.jsx(Ue,{zhName:(g=u.at(0))!=null?g:"",enName:(N=u.at(1))!=null?N:"",zhClassName:"rmp-name__zh",enClassName:"rmp-name__en",foregroundColour:x[3],backgroundColour:x[2],spanDigits:j})})},q={names:["1号线","Line 1"],color:[M.Guangzhou,"gz1","#F3D03E",L.black],tram:!1,span:!0},an=o=>{const{id:n,attrs:t,handleAttrsUpdate:c}=o,{t:s}=R(),l=[{type:"input",label:s("panel.details.nodes.common.nameZh"),value:t.names[0],onChange:a=>{t.names[0]=a,c(n,t)},minW:"full"},{type:"input",label:s("panel.details.nodes.common.nameEn"),value:t.names[1],onChange:a=>{t.names[1]=a,c(n,t)},minW:"full"},{type:"switch",label:s("panel.details.nodes.gzmtrLineBadge.tram"),oneLine:!0,isChecked:t.tram,onChange:a=>{t.tram=a,c(n,t)},minW:"full"},{type:"switch",label:s("panel.details.nodes.gzmtrLineBadge.span"),oneLine:!0,isChecked:t.span,onChange:a=>{t.span=a,c(n,t)},minW:"full"},{type:"custom",label:s("color"),component:e.jsx(z,{type:f.GzmtrLineBadge,defaultTheme:q.color})}];return e.jsx(_,{fields:l})},ln=e.jsxs("svg",{viewBox:"0 0 24 24",height:40,width:40,focusable:!1,children:[e.jsx("rect",{fill:"currentColor",x:"2",y:"5",width:"20",height:"14",rx:"1"}),e.jsx("text",{x:"6",y:"15",textAnchor:"middle",fontSize:"10",fill:"white",children:"1"}),e.jsx("text",{x:"15",y:"12",textAnchor:"middle",fontSize:"6",fill:"white",children:"号线"}),e.jsx("text",{x:"14.5",y:"17",textAnchor:"middle",fontSize:"4",fill:"white",children:"Line 1"})]}),rn={component:sn,icon:ln,defaultAttrs:q,attrsComponent:an,metadata:{displayName:"panel.details.nodes.gzmtrLineBadge.displayName",tags:[]}},se=11.84375,cn=o=>{const{id:n,x:t,y:c,attrs:s,handlePointerDown:l,handlePointerMove:a,handlePointerUp:h}=o,{num:u=J.num,color:x=J.color}=s!=null?s:J,m=r.useCallback(p=>l(n,p),[n,l]),j=r.useCallback(p=>a(n,p),[n,a]),y=r.useCallback(p=>h(n,p),[n,h]),b=x[3]===L.black?"#003670":L.white;return e.jsxs("g",{id:n,transform:"translate(".concat(t,", ").concat(c,")"),onPointerDown:m,onPointerMove:j,onPointerUp:y,style:{cursor:"move"},children:[e.jsx("rect",{fill:x[2],x:"0",width:se+21,height:"16",rx:"2"}),e.jsx("text",{className:"rmp-name__zh",textAnchor:"middle",x:se/2+2,y:"13.5",fill:b,fontSize:"15",letterSpacing:"-1.5",children:u}),e.jsx("text",{className:"rmp-name__zh",x:se+(u>9?5.5:3),y:"8.5",fontSize:"7",fill:b,children:"号线"}),e.jsxs("text",{className:"rmp-name__en",x:se+(u>9?6:4.5),y:"13.5",fontSize:"4",fill:b,children:["Line ",u]})]})},J={num:1,color:[M.Beijing,"bj1","#c23a30",L.white]},dn=[{type:"input",label:"panel.details.nodes.common.num",value:o=>(o!=null?o:J).num,validator:o=>!Number.isNaN(o),onChange:(o,n)=>{const t=n!=null?n:J;return Number.isNaN(o)||(t.num=Number(o)),t}},{type:"custom",label:"color",component:e.jsx(z,{type:f.BjsubwayNumLineBadge,defaultTheme:J.color})}],mn=()=>e.jsx(D,{fields:dn}),un=e.jsxs("svg",{viewBox:"0 0 24 24",height:40,width:40,focusable:!1,children:[e.jsx("rect",{fill:"currentColor",x:"2",y:"4",width:"20",height:"16",rx:"2"}),e.jsx("text",{x:"4",y:"17",fill:"white",fontSize:"14",children:"1"}),e.jsx("text",{x:"11",y:"11",fill:"white",fontSize:"5",children:"号线"}),e.jsx("text",{x:"11",y:"17",fill:"white",fontSize:"4",children:"Line 1"})]}),hn={component:cn,icon:un,defaultAttrs:J,attrsComponent:mn,metadata:{displayName:"panel.details.nodes.bjsubwayNumLineBadge.displayName",tags:[]}},xn=28.84375,pn=o=>{const{id:n,x:t,y:c,attrs:s,handlePointerDown:l,handlePointerMove:a,handlePointerUp:h}=o,{names:u=E.names,color:x=E.color}=s!=null?s:E,m=r.useRef(null),[j,y]=r.useState({width:12});r.useEffect(()=>y(m.current.getBBox()),[...u,y,m]);const b=r.useCallback(d=>l(n,d),[n,l]),p=r.useCallback(d=>a(n,d),[n,a]),g=r.useCallback(d=>h(n,d),[n,h]),N=Math.max(xn,j.width),i=x[3]===L.black?"#003670":L.white;return e.jsxs("g",{id:n,transform:"translate(".concat(t,", ").concat(c,")"),onPointerDown:b,onPointerMove:p,onPointerUp:g,style:{cursor:"move"},children:[e.jsx("rect",{fill:x[2],x:"0",width:N+4,height:"16",rx:"2"}),e.jsxs("g",{ref:m,children:[e.jsx("text",{className:"rmp-name__zh",textAnchor:"middle",x:(N+4)/2,y:"8",fontSize:"7",fill:i,children:u[0]}),e.jsx("text",{className:"rmp-name__en",textAnchor:"middle",x:(N+4)/2,y:"13.5",fontSize:"4",fill:i,children:u[1]})]})]})},E={names:["八通线","Batong Line"],color:[M.Beijing,"bj1","#c23a30",L.white]},gn=[{type:"input",label:"panel.details.nodes.common.nameZh",value:o=>(o!=null?o:E).names[0],onChange:(o,n)=>{const t=n!=null?n:E;return t.names[0]=o.toString(),t}},{type:"input",label:"panel.details.nodes.common.nameEn",value:o=>(o!=null?o:E).names[1],onChange:(o,n)=>{const t=n!=null?n:E;return t.names[1]=o.toString(),t}},{type:"custom",label:"color",component:e.jsx(z,{type:f.BjsubwayTextLineBadge,defaultTheme:E.color})}],fn=()=>e.jsx(D,{fields:gn}),yn=e.jsxs("svg",{viewBox:"0 0 24 24",height:40,width:40,focusable:!1,children:[e.jsx("rect",{fill:"currentColor",x:"2",y:"6",width:"20",height:"12",rx:"2"}),e.jsx("text",{x:"3",y:"12",fontSize:"6",fill:"white",children:"八通线"}),e.jsx("text",{x:"3",y:"16",fontSize:"3.2",fill:"white",children:"Batong Line"})]}),bn={component:pn,icon:yn,defaultAttrs:E,attrsComponent:fn,metadata:{displayName:"panel.details.nodes.bjsubwayTextLineBadge.displayName",tags:[]}},jn=o=>{const{id:n,x:t,y:c,attrs:s,handlePointerDown:l,handlePointerMove:a,handlePointerUp:h}=o,{num:u=I.num,branch:x=I.branch,color:m=I.color}=s!=null?s:I,j=r.useCallback(p=>l(n,p),[n,l]),y=r.useCallback(p=>a(n,p),[n,a]),b=r.useCallback(p=>h(n,p),[n,h]);return e.jsxs("g",{id:n,transform:"translate(".concat(t,", ").concat(c,")"),onPointerDown:j,onPointerMove:y,onPointerUp:b,style:{cursor:"move"},children:[e.jsx("rect",{fill:m[2],width:"20",height:"20",rx:"2",ry:"2"}),e.jsx("text",{className:"rmp-name__zh",textAnchor:"middle",dominantBaseline:"middle",x:"10",y:"11.4",fill:m[3],fontSize:"15",letterSpacing:"-1",children:u}),x&&e.jsxs(e.Fragment,{children:[e.jsx("text",{className:"rmp-name__zh",x:20+2.5,y:"10",fontSize:"10",children:"支线"}),e.jsx("text",{className:"rmp-name__en",x:20+2.5,y:"18",fontSize:"5",fill:"gray",children:"Branch line"})]})]})},I={num:1,branch:!1,color:[M.Suzhou,"sz1","#78BA25",L.white]},Nn=[{type:"input",label:"panel.details.nodes.common.num",value:o=>(o!=null?o:I).num,validator:o=>!Number.isNaN(o),onChange:(o,n)=>{const t=n!=null?n:I;return Number.isNaN(o)||(t.num=Number(o)),t}},{type:"switch",label:"panel.details.nodes.suzhouRTNumLineBadge.branch",isChecked:o=>{var n;return(n=o==null?void 0:o.branch)!=null?n:I.branch},onChange:(o,n)=>{const t=n!=null?n:I;return t.branch=o,t}},{type:"custom",label:"color",component:e.jsx(z,{type:f.SuzhouRTNumLineBadge,defaultTheme:I.color})}],wn=()=>e.jsx(D,{fields:Nn}),Cn=e.jsxs("svg",{viewBox:"0 0 24 24",height:40,width:40,focusable:!1,children:[e.jsx("rect",{fill:"currentColor",x:"4",y:"4",width:"16",height:"16",rx:"3",ry:"3"}),e.jsx("text",{x:"12",y:"13.4",textAnchor:"middle",dominantBaseline:"middle",fill:"white",fontSize:"14",children:"1"})]}),Bn={component:jn,icon:Cn,defaultAttrs:I,attrsComponent:wn,metadata:{displayName:"panel.details.nodes.suzhouRTNumLineBadge.displayName",tags:[]}},vn=o=>{const{id:n,x:t,y:c,attrs:s,handlePointerDown:l,handlePointerMove:a,handlePointerUp:h}=o,{num:u=Q.num,color:x=Q.color}=s!=null?s:Q,m=r.useCallback(p=>l(n,p),[n,l]),j=r.useCallback(p=>a(n,p),[n,a]),y=r.useCallback(p=>h(n,p),[n,h]),b=x[3];return e.jsxs("g",{id:n,transform:"translate(".concat(t,", ").concat(c,")"),onPointerDown:m,onPointerMove:j,onPointerUp:y,style:{cursor:"move"},children:[e.jsx("rect",{fill:x[2],x:"0",width:"25",height:"15"}),e.jsxs("text",{className:"rmp-name__berlin",textAnchor:"middle",x:"12.5",y:"12.5",fill:b,fontSize:"14",letterSpacing:"1",children:["U",u]})]})},Q={num:1,color:[M.Berlin,"bu1","#62AD2D",L.white]},Ln=[{type:"input",label:"panel.details.nodes.common.num",value:o=>(o!=null?o:Q).num,validator:o=>!Number.isNaN(o),onChange:(o,n)=>{const t=n!=null?n:Q;return Number.isNaN(o)||(t.num=Number(o)),t}},{type:"custom",label:"color",component:e.jsx(z,{type:f.BerlinUBahnLineBadge,defaultTheme:Q.color})}],Sn=()=>e.jsx(D,{fields:Ln}),Tn=e.jsxs("svg",{viewBox:"0 0 24 24",height:40,width:40,focusable:!1,children:[e.jsx("rect",{fill:"currentColor",x:"2",y:"4",width:"20",height:"16"}),e.jsx("text",{x:"4",y:"17",fill:"white",fontSize:"14",children:"U1"})]}),Pn={component:vn,icon:Tn,defaultAttrs:Q,attrsComponent:Sn,metadata:{displayName:"panel.details.nodes.berlinUBahnLineBadge.displayName",tags:[]}},Mn=o=>{const{id:n,x:t,y:c,attrs:s,handlePointerDown:l,handlePointerMove:a,handlePointerUp:h}=o,{num:u=G.num,color:x=G.color}=s!=null?s:G,[m,j]=u>=10?[6,19.75]:[10,20],y=r.useCallback(N=>l(n,N),[n,l]),b=r.useCallback(N=>a(n,N),[n,a]),p=r.useCallback(N=>h(n,N),[n,h]),g=x[3];return e.jsxs("g",{id:n,transform:"translate(".concat(t,", ").concat(c,")"),onPointerDown:y,onPointerMove:b,onPointerUp:p,style:{cursor:"move"},children:[e.jsx("rect",{fill:x[2],x:"0",width:"30",height:"15",rx:"8"}),e.jsx("text",{className:"rmp-name__berlin",textAnchor:"middle",x:m,y:"12.5",fill:g,fontSize:"14",letterSpacing:"0",children:"S"}),e.jsx("text",{className:"rmp-name__berlin",textAnchor:"middle",x:j,y:"12.5",fill:g,fontSize:"14",letterSpacing:"-0.2",children:u})]})},G={num:1,color:[M.Berlin,"bs1","#DD6CA6",L.white]},zn=[{type:"input",label:"panel.details.nodes.common.num",value:o=>(o!=null?o:G).num,validator:o=>!Number.isNaN(o),onChange:(o,n)=>{const t=n!=null?n:G;return Number.isNaN(o)||(t.num=Number(o)),t}},{type:"custom",label:"color",component:e.jsx(z,{type:f.BerlinSBahnLineBadge,defaultTheme:G.color})}],An=()=>e.jsx(D,{fields:zn}),kn=e.jsxs("svg",{viewBox:"0 0 24 24",height:40,width:40,focusable:!1,children:[e.jsx("rect",{fill:"currentColor",x:"2",y:"4",width:"20",height:"16",rx:"8"}),e.jsx("text",{x:"4.5",y:"16.5",fill:"white",fontSize:"14",children:"S1"})]}),_n={component:Mn,icon:kn,defaultAttrs:G,attrsComponent:An,metadata:{displayName:"panel.details.nodes.berlinSBahnLineBadge.displayName",tags:[]}},$n=o=>{const{id:n,x:t,y:c,attrs:s,handlePointerDown:l,handlePointerMove:a,handlePointerUp:h}=o,{num:u=Z.num,color:x=Z.color}=s!=null?s:Z,m=r.useCallback(i=>l(n,i),[n,l]),j=r.useCallback(i=>a(n,i),[n,a]),y=r.useCallback(i=>h(n,i),[n,h]),b=x[3],p=Number.isInteger(u)?16:15,[g,N]=Number.isInteger(u)?Number(u)>=10?[-1.2,1.5]:[0,5.5]:[0,2.55];return e.jsxs("g",{id:n,transform:"translate(".concat(t,", ").concat(c,")"),onPointerDown:m,onPointerMove:j,onPointerUp:y,style:{cursor:"move"},children:[e.jsx("rect",{fill:x[2],x:"0",width:"20",height:"20",rx:"10",ry:"10"}),e.jsx("text",{className:"rmp-name__zh",textAnchor:"left",x:N,y:"10",fill:b,fontSize:p,letterSpacing:g,dominantBaseline:"central",children:u})]})},Z={num:1,color:[M.Chongqing,"cq1","#e4002b",L.white]},In=[{type:"input",label:"panel.details.nodes.common.num",value:o=>(o!=null?o:Z).num,validator:o=>!Number.isNaN(o),onChange:(o,n)=>{const t=n!=null?n:Z;return Number.isNaN(Number(o))?t.num=o:t.num=Number(o),t}},{type:"custom",label:"color",component:e.jsx(z,{type:f.ChongqingRTNumLineBadge,defaultTheme:Z.color})}],Rn=()=>e.jsx(D,{fields:In}),En=e.jsxs("svg",{viewBox:"0 0 24 24",height:40,width:40,focusable:!1,children:[e.jsx("rect",{fill:"currentColor",x:"2",y:"2",rx:"10",ry:"10",width:"20",height:"20"}),e.jsx("text",{x:"8",y:"18",fill:"white",fontSize:"18",children:"1"})]}),Un={component:$n,icon:En,defaultAttrs:Z,attrsComponent:Rn,metadata:{displayName:"panel.details.nodes.chongqingRTNumLineBadge.displayName",tags:[]}},Dn=o=>{const{id:n,x:t,y:c,attrs:s,handlePointerDown:l,handlePointerMove:a,handlePointerUp:h}=o,{names:u=U.names,color:x=U.color}=s!=null?s:U,m=r.useRef(null),j=r.useCallback(g=>l(n,g),[n,l]),y=r.useCallback(g=>a(n,g),[n,a]),b=r.useCallback(g=>h(n,g),[n,h]),p=x[3];return e.jsxs("g",{id:n,transform:"translate(".concat(t,", ").concat(c,")"),onPointerDown:j,onPointerMove:y,onPointerUp:b,style:{cursor:"move"},children:[e.jsx("rect",{fill:x[2],x:"0",width:"20",height:"20",rx:"10",ry:"10"}),e.jsx("text",{className:"rmp-name__zh",textAnchor:"middle",x:"10",y:"10.5",fill:p,fontSize:"6",letterSpacing:"0",children:u[0]}),e.jsx(ge,{ref:m,text:u[1].split("\n"),className:"rmp-name__en",textAnchor:"middle",x:"10",y:"9.25",fill:p,fontSize:"2.5",letterSpacing:"0",lineHeight:2.25,grow:"down"})]})},U={names:["空港线","Konggang Line"],color:[M.Chongqing,"cq3","#003da5",L.white]},Wn=[{type:"input",label:"panel.details.nodes.common.nameZh",value:o=>(o!=null?o:U).names[0],onChange:(o,n)=>{const t=n!=null?n:U;return t.names[0]=o.toString(),t}},{type:"textarea",label:"panel.details.nodes.common.nameEn",value:o=>(o!=null?o:U).names[1],onChange:(o,n)=>{const t=n!=null?n:U;return t.names[1]=o.toString(),t}},{type:"custom",label:"color",component:e.jsx(z,{type:f.ChongqingRTTextLineBadge,defaultTheme:U.color})}],Fn=()=>e.jsx(D,{fields:Wn}),On=e.jsxs("svg",{viewBox:"0 0 24 24",height:40,width:40,focusable:!1,children:[e.jsx("rect",{fill:"currentColor",x:"2",y:"2",rx:"10",ry:"10",width:"20",height:"20"}),e.jsx("text",{x:"4.5",y:"12.5",fill:"white",fontSize:"5",children:"空港线"}),e.jsx("text",{x:"4.5",y:"15",fill:"white",fontSize:"2",children:"Konggang Line"})]}),qn={component:Dn,icon:On,defaultAttrs:U,attrsComponent:Fn,metadata:{displayName:"panel.details.nodes.chongqingRTTextLineBadge.displayName",tags:[]}},ae=11.84375,Vn=o=>{const{id:n,x:t,y:c,attrs:s,handlePointerDown:l,handlePointerMove:a,handlePointerUp:h}=o,{num:u=K.num,color:x=K.color,isBranch:m=K.isBranch}=s!=null?s:K,j=r.useCallback(C=>l(n,C),[n,l]),y=r.useCallback(C=>a(n,C),[n,a]),b=r.useCallback(C=>h(n,C),[n,h]),p=x[3]===L.black?"#003670":L.white,g=m?10:ae+(u>9?6.5:3),N=m?-1:0,i=m?11:ae+(u>9?7:3.5),d=m?6:ae/2+4;return e.jsxs("g",{id:n,transform:"translate(".concat(t,", ").concat(c,")"),onPointerDown:j,onPointerMove:y,onPointerUp:b,style:{cursor:"move"},children:[e.jsx("rect",{fill:x[2],x:"0",width:ae+21,height:"16",rx:"2"}),e.jsx("text",{className:"rmp-name__zh",textAnchor:"middle",x:d,y:"13.5",fill:p,fontSize:"15",letterSpacing:"-1",children:u}),e.jsxs("text",{className:"rmp-name__zh",x:g,y:"9.5",fontSize:"6",fill:p,letterSpacing:N,children:["号线",m?"支线":""]}),e.jsxs("text",{className:"rmp-name__en",x:i,y:"13.5",fontSize:"3",fill:p,children:[m?"Branch":""," Line ",u]})]})},K={num:1,color:[M.Shenzhen,"sz1","#00b140",L.white],isBranch:!1},Hn=o=>{const{id:n,attrs:t,handleAttrsUpdate:c}=o,{t:s}=R(),l=[{type:"input",label:s("panel.details.nodes.common.num"),value:String(t.num),validator:a=>!Number.isNaN(a),onChange:a=>{t.num=Number(a),c(n,t)},minW:"full"},{type:"custom",label:s("color"),component:e.jsx(z,{type:f.ShenzhenMetroNumLineBadge,defaultTheme:K.color}),minW:"full"},{type:"switch",label:s("panel.details.nodes.shenzhenMetroNumLineBadge.branch"),oneLine:!0,isChecked:t.isBranch,onChange:a=>{t.isBranch=a,c(n,t)},minW:"full"}];return e.jsx(_,{fields:l})},Xn=e.jsxs("svg",{viewBox:"0 0 24 24",height:40,width:40,focusable:!1,children:[e.jsx("rect",{fill:"currentColor",x:"2",y:"4",width:"20",height:"16",rx:"2"}),e.jsx("text",{x:"4",y:"17",fill:"white",fontSize:"14",children:"1"}),e.jsx("text",{x:"11",y:"14",fill:"white",fontSize:"5",children:"号线"}),e.jsx("text",{x:"12",y:"17",fill:"white",fontSize:"3",children:"Line 1"})]}),Jn={component:Vn,icon:Xn,defaultAttrs:K,attrsComponent:Hn,metadata:{displayName:"panel.details.nodes.shenzhenMetroNumLineBadge.displayName",tags:[]}},Qn=o=>{const{id:n,x:t,y:c,attrs:s,handlePointerDown:l,handlePointerMove:a,handlePointerUp:h}=o,{num:u=te.num,color:x=te.color}=s!=null?s:te,m=r.useCallback(g=>l(n,g),[n,l]),j=r.useCallback(g=>a(n,g),[n,a]),y=r.useCallback(g=>h(n,g),[n,h]),b=x[3],p=x[2];return e.jsxs("g",{id:n,transform:"translate(".concat(t,", ").concat(c,")"),onPointerDown:m,onPointerMove:j,onPointerUp:y,style:{cursor:"move"},children:[e.jsx("circle",{r:"8",fill:p}),e.jsx("text",{className:"rmp-name__mrt",textAnchor:"middle",x:"0",y:"0",width:"12",height:"12",fill:b,fontSize:"12",dominantBaseline:"central",letterSpacing:"-0.2",children:u})]})},te={num:1,color:[M.Singapore,"ewl","#009739",L.white]},Gn=o=>{const{id:n,attrs:t,handleAttrsUpdate:c}=o,{t:s}=R(),l=[{type:"input",label:s("panel.details.nodes.common.num"),value:String(t.num),validator:a=>!Number.isNaN(a),onChange:a=>{t.num=Number(a),c(n,t)},minW:"full"},{type:"custom",label:s("color"),component:e.jsx(z,{type:f.MRTDestinationNumbers,defaultTheme:te.color}),minW:"full"}];return e.jsx(_,{fields:l})},Zn=e.jsxs("svg",{viewBox:"0 0 24 24",height:40,width:40,focusable:!1,children:[e.jsx("rect",{fill:"currentColor",x:"2",y:"2",rx:"10",ry:"10",width:"20",height:"20"}),e.jsx("text",{x:"9",y:"17",fill:"white",fontSize:"14",children:"1"})]}),Yn={component:Qn,icon:Zn,defaultAttrs:te,attrsComponent:Gn,metadata:{displayName:"panel.details.nodes.mrtDestinationNumbers.displayName",tags:[]}},Kn=o=>{const{id:n,x:t,y:c,attrs:s,handlePointerDown:l,handlePointerMove:a,handlePointerUp:h}=o,{lineCode:u=F.lineCode,color:x=F.color,lines:m=F.lines,name:j=F.name,isTram:y=F.isTram}=s!=null?s:F,b=r.useCallback(w=>l(n,w),[n,l]),p=r.useCallback(w=>a(n,w),[n,a]),g=r.useCallback(w=>h(n,w),[n,h]),N=22.85,i=12.935,d=x[3],C=x[2];return e.jsxs("g",{id:n,transform:"translate(".concat(t,", ").concat(c,")"),onPointerDown:b,onPointerMove:p,onPointerUp:g,style:{cursor:"move"},children:[e.jsx("rect",{transform:"scale(1.8)",x:-N/2,y:-i/2,rx:"3",ry:"6",width:N,height:i,fill:C,stroke:"white",strokeWidth:"1"}),e.jsx("text",{className:"rmp-name__mrt",textAnchor:"middle",fill:d,fontSize:"15",dominantBaseline:"central",letterSpacing:"-0.2",children:u}),e.jsx("text",{className:"rmp-name__mrt",textAnchor:"left",x:"28",y:y?3.5:-3,fill:"black",fontSize:"10",letterSpacing:"-0.2",children:j}),!y&&m.split(",").map((w,v)=>e.jsx("g",{transform:"translate(".concat(34+14*v,", ").concat(4.5,")"),children:w.trim()!=="airport"?e.jsxs(e.Fragment,{children:[e.jsx("circle",{r:"6",fill:C}),e.jsx("text",{className:"rmp-name__mrt",textAnchor:"middle",fill:d,fontSize:"9",dominantBaseline:"central",letterSpacing:"-0.2",children:w})]}):e.jsxs("g",{transform:"translate(-6, -6) scale(4.5)",children:[e.jsx("path",{d:"M2.467 0H.226A.226.226 0 0 0 0 .226v2.241a.225.225 0 0 0 .226.225h2.241a.225.225 0 0 0 .225-.225V.226A.226.226 0 0 0 2.467 0",style:{fill:"#2d2a26"}}),e.jsx("path",{d:"M1.5.746v.3l.73.642a.08.08 0 0 1 .022.05v.12c0 .017-.012.025-.027.018L1.5 1.529l-.06.541.2.113a.03.03 0 0 1 .013.023V2.3a.01.01 0 0 1-.014.011l-.293-.091-.286.087a.01.01 0 0 1-.014-.007v-.09a.03.03 0 0 1 .013-.023l.2-.113-.059-.545-.724.348a.018.018 0 0 1-.028-.018v-.12a.07.07 0 0 1 .023-.05l.73-.642v-.3c0-.482.3-.482.3 0",style:{fill:"#fff",fillRule:"evenodd"}})]})},v))]})},F={lineCode:"EWL",name:"East-West Line",lines:"1, 2, 3, airport",isTram:!1,color:[M.Singapore,"ewl","#009739",L.white]},et=o=>{const{id:n,attrs:t,handleAttrsUpdate:c}=o,{t:s}=R(),l=[{type:"input",label:s("panel.details.nodes.common.nameEn"),value:t.name,onChange:a=>{t.name=a,c(n,t)},minW:"full"},{type:"input",label:s("panel.details.stations.common.lineCode"),value:t.lineCode,onChange:a=>{t.lineCode=a,c(n,t)},minW:"full"},{type:"switch",label:s("panel.details.nodes.mrtLineBadge.isTram"),isChecked:t.isTram,onChange:a=>{t.isTram=a,c(n,t)},minW:"full",oneLine:!0},...t.isTram?[]:[{type:"input",label:s("panel.details.nodes.common.num"),value:t.lines,onChange:a=>{t.lines=a,c(n,t)},minW:"full"}],{type:"custom",label:s("color"),component:e.jsx(z,{type:f.MRTLineBadge,defaultTheme:F.color}),minW:"full"}];return e.jsx(_,{fields:l})},nt=e.jsxs("svg",{viewBox:"0 0 24 24",height:40,width:40,focusable:!1,children:[e.jsx("rect",{fill:"currentColor",x:"2",y:"2",rx:"10",ry:"10",width:"20",height:"20"}),e.jsx("text",{x:"9",y:"17",fill:"white",fontSize:"14",children:"1"})]}),tt={component:Kn,icon:nt,defaultAttrs:F,attrsComponent:et,metadata:{displayName:"panel.details.nodes.mrtLineBadge.displayName",tags:[]}},le=4,xe=7,ie=10,ye=5,ot=5,P=ot*Math.SQRT1_2,fe=.25,re=(P*Math.SQRT2-fe)/2*Math.SQRT2,st=o=>{const{id:n,x:t,y:c,attrs:s,handlePointerDown:l,handlePointerMove:a,handlePointerUp:h}=o,{names:u=V.names,num:x=V.num,color:m=V.color,crosshatchPatternFill:j=V.crosshatchPatternFill}=s!=null?s:V,y=r.useRef(null),[b,p]=r.useState({height:10,width:12});r.useEffect(()=>p(y.current.getBBox()),[...u,p,y]);const g=r.useCallback(d=>l(n,d),[n,l]),N=r.useCallback(d=>a(n,d),[n,a]),i=r.useCallback(d=>h(n,d),[n,h]);return e.jsxs("g",{id:n,transform:"translate(".concat(t,", ").concat(c,")"),onPointerDown:g,onPointerMove:N,onPointerUp:i,style:{cursor:"move"},children:[e.jsxs("defs",{children:[e.jsxs("clipPath",{id:"jr_east_fill_pattern_clip_path",patternUnits:"userSpaceOnUse",children:[e.jsx("polygon",{points:"0,0 0,".concat(re," ").concat(re,",0")}),e.jsx("polygon",{points:"".concat(P,",").concat(P," ").concat(P-re,",").concat(P," ").concat(P,",").concat(P-re)})]}),e.jsxs("pattern",{id:"jr_east_".concat(n,"_fill_pattern_").concat(m[2]),width:P,height:P,patternUnits:"userSpaceOnUse",children:[e.jsx("rect",{width:P,height:P,fill:m[2]}),e.jsx("line",{x1:"0",y1:"0",x2:P,y2:P,stroke:"white",strokeWidth:fe,strokeOpacity:"33%",clipPath:"url(#jr_east_fill_pattern_clip_path)"}),e.jsx("line",{x1:P,y1:"0",x2:"0",y2:P,stroke:"white",strokeWidth:fe,strokeOpacity:"33%"})]})]}),e.jsx("rect",{fill:j?"url(#jr_east_".concat(n,"_fill_pattern_").concat(m[2],")"):m[2],x:"0",y:"-1",width:b.width+le+10,height:b.height+1,rx:"1",stroke:"black",strokeWidth:"0.25"}),e.jsx("circle",{r:le,cx:xe,cy:ie/2+1,stroke:"black",strokeWidth:"0.25",fill:m[3]}),e.jsx("text",{x:xe,y:ie/2+1.75,textAnchor:"middle",dominantBaseline:"middle",fill:m[3]==="#000"?"white":m[2],fontSize:x>9?7:8,className:"rmp-name__jreast_en",children:x}),e.jsx(ge,{ref:y,text:u[0].split("\\"),x:xe+le+1,y:"-1",fill:m[3],fontSize:ie,lineHeight:ie,grow:"down",className:"rmp-name__jreast_ja"}),e.jsx(ge,{text:u[1].split("\\"),textAnchor:"middle",dominantBaseline:"hanging",x:(b.width+le+10)/2,y:b.height+1,fontSize:ye,lineHeight:ye,baseOffset:0,grow:"down",className:"rmp-name__jreast_en"})]})},V={names:["山手線","Yamanote Line"],color:[M.Tokyo,"jy","#9ACD32",L.black],num:9,crosshatchPatternFill:!1},at=o=>{const{id:n,attrs:t,handleAttrsUpdate:c}=o,{t:s}=R(),l=[{type:"input",label:s("panel.details.nodes.common.num"),value:String(t.num),validator:a=>!Number.isNaN(a),onChange:a=>{t.num=Number(a),c(n,t)},minW:"full"},{type:"textarea",label:s("panel.details.nodes.common.nameJa"),value:t.names[0].replaceAll("\\","\n"),onChange:a=>{t.names[0]=a.replaceAll("\n","\\"),c(n,t)},minW:"full"},{type:"textarea",label:s("panel.details.nodes.common.nameEn"),value:t.names[1].replaceAll("\\","\n"),onChange:a=>{t.names[1]=a.replaceAll("\n","\\"),c(n,t)},minW:"full"},{type:"switch",label:s("panel.details.nodes.jrEastLineBadge.crosshatchPatternFill"),oneLine:!0,isChecked:t.crosshatchPatternFill,onChange:a=>{t.crosshatchPatternFill=a,c(n,t)},minW:"full"},{type:"custom",label:s("color"),component:e.jsx(z,{type:f.JREastLineBadge,defaultTheme:V.color})}];return e.jsx(_,{fields:l})},lt=e.jsxs("svg",{viewBox:"0 0 24 24",height:40,width:40,focusable:!1,children:[e.jsx("rect",{fill:"currentColor",x:"1",y:"6",width:"22",height:"7"}),e.jsx("circle",{cx:"3.5",cy:"9.25",r:"2",fill:"white"}),e.jsx("text",{x:"3",y:"10.5",fontSize:"3",children:"9"}),e.jsx("text",{x:"6",y:"11.25",fontSize:"5",fill:"white",children:"山手線"}),e.jsx("text",{x:"1.5",y:"16",fontSize:"3",children:"Yamanote Line"})]}),it={component:st,icon:lt,defaultAttrs:V,attrsComponent:at,metadata:{displayName:"panel.details.nodes.jrEastLineBadge.displayName",tags:[]}},rt=o=>{const{id:n,x:t,y:c,attrs:s,handlePointerDown:l,handlePointerMove:a,handlePointerUp:h}=o,{num:u=H.num,numEn:x=H.numEn,color:m=H.color,showText:j=H.showText}=s!=null?s:H,y=r.useCallback(w=>l(n,w),[n,l]),b=r.useCallback(w=>a(n,w),[n,a]),p=r.useCallback(w=>h(n,w),[n,h]),g=m[3],[N,i,d,C]=Number(u)>=10?[-2.4,0,10.25,20]:[0,4,10,22];return e.jsxs("g",{id:n,transform:"translate(".concat(t,", ").concat(c,")"),onPointerDown:y,onPointerMove:b,onPointerUp:p,style:{cursor:"move"},children:[e.jsx("rect",{fill:m[2],x:"0",width:"20",height:"20",rx:"2",ry:"2"}),e.jsx("text",{className:"rmp-name__zh",textAnchor:"left",x:i,y:d,fill:g,fontSize:C,fontWeight:"bold",letterSpacing:N,dominantBaseline:"central",children:u}),j&&e.jsxs(e.Fragment,{children:[e.jsx("text",{className:"rmp-name__zh",x:"22",y:"10.5",fontSize:"13",children:"号线"}),e.jsxs("text",{className:"rmp-name__en",x:"22.5",y:"19.5",fontSize:"8",children:["Line ",x]})]})]})},H={num:1,numEn:"1",showText:!0,color:[M.Qingdao,"qd1","#f7b000",L.white]},ct=o=>{const{id:n,attrs:t,handleAttrsUpdate:c}=o,{t:s}=R(),l=[{type:"input",label:s("panel.details.nodes.common.num"),value:t.num.toString(),onChange:a=>{t.num=Number(a),t.numEn=a,c(n,t)}},{type:"input",label:s("panel.details.nodes.qingdaoMetroNumLineBadge.numEn"),value:t.numEn.toString(),onChange:a=>{t.numEn=a,c(n,t)}},{type:"switch",label:s("panel.details.nodes.qingdaoMetroNumLineBadge.showText"),isChecked:t.showText,oneLine:!0,onChange:a=>{t.showText=a,c(n,t)}},{type:"custom",label:s("color"),component:e.jsx(z,{type:f.QingdaoMetroNumLineBadge,defaultTheme:H.color})}];return e.jsx(_,{fields:l,minW:"full"})},dt=e.jsxs("svg",{viewBox:"0 0 24 24",height:40,width:40,focusable:!1,children:[e.jsx("rect",{fill:"currentColor",x:"2",y:"6",rx:"1",ry:"1",width:"10",height:"10"}),e.jsx("text",{x:"4",y:"15",fill:"white",fontSize:"12",children:"1"}),e.jsx("text",{x:"12",y:"11.5",fill:"black",fontSize:"6",children:"号线"}),e.jsx("text",{x:"12",y:"15.5",fill:"black",fontSize:"4",children:"Line1"})]}),mt={component:rt,icon:dt,defaultAttrs:H,attrsComponent:ct,metadata:{displayName:"panel.details.nodes.qingdaoMetroNumLineBadge.displayName",tags:[]}},ut=o=>{const{id:n,x:t,y:c,attrs:s,handlePointerDown:l,handlePointerMove:a,handlePointerUp:h}=o,u=We();s.content=u(s.contents);const x=ce.component;return e.jsx(x,{id:n,x:t,y:c,handlePointerDown:l,handlePointerMove:a,handlePointerUp:h,attrs:s})},ht={contents:{},...De},xt={component:ut,icon:ce.icon,defaultAttrs:ht,attrsComponent:ce.attrsComponent,metadata:{displayName:"panel.details.nodes.i18nText.displayName",tags:[]}},pt={id:"new",value:"Upload a new param",param:null},be={id:"null",value:"",param:null},Ae=o=>{const{isOpen:n,onClose:t,onSubmit:c}=o,{t:s}=R(),l=r.useRef(window.graph),a=!0,[h,u]=r.useState([]),[x,m]=r.useState(be);r.useEffect(()=>{if(n){y(""),p(""),m(be);const i=ze(l.current).filter(d=>d.randomId!=="undefined").map(d=>{var C;return{id:d.randomId,value:(C=d.label)!=null?C:d.randomId,param:d}});u([pt].concat(i))}},[n]);const[j,y]=r.useState(""),[b,p]=r.useState(""),g=[{type:"custom",label:s("panel.details.masterManage.importFrom"),component:e.jsx(ke,{data:h,displayHandler:i=>e.jsx(pe,{name:i.value,fg:L.white,bg:i.param===null?"#000000":"#19B3EA",title:i.value,sx:{display:"inline-block",overflow:"hidden",textOverflow:"ellipsis"}}),filter:(i,d)=>d.id.toLowerCase().includes(i.toLowerCase())||Object.values(d.id).some(C=>C.toLowerCase().includes(i.toLowerCase())),value:x.value,onChange:i=>m(i)})},{type:"textarea",label:s("panel.details.masterManage.importLabel"),value:j.toString(),onChange:i=>y(i),minW:"full",hidden:x.param!==null||!a}],N=()=>{try{c(x.param===null?j:JSON.stringify(x.param))}catch(i){p("Something went wrong.");return}t()};return r.useEffect(()=>p(""),[n]),e.jsxs(Ce,{isOpen:n,onClose:t,size:"sm",scrollBehavior:"inside",children:[e.jsx(Be,{}),e.jsxs(ve,{children:[e.jsx(Le,{children:s("panel.details.masterManage.importTitle")}),e.jsx(Se,{}),e.jsxs(Te,{minH:250,children:[e.jsx(_,{fields:g}),b&&x.param!==null&&e.jsx("span",{style:{color:"red"},children:b})]}),e.jsxs(Pe,{children:[e.jsx(O,{colorScheme:"blue",variant:"outline",mr:"1",onClick:t,children:s("cancel")}),e.jsx(O,{colorScheme:"blue",variant:"outline",mr:"1",onClick:N,children:s("apply")})]})]})]})},gt=o=>{const{isOpen:n,onClose:t}=o,{t:c}=R(),{refresh:{nodes:s}}=je(i=>i.runtime),l=r.useRef(window.graph),a=Ne(),h=Me(),[u,x]=r.useState([]);r.useEffect(()=>{n&&x(ze(l.current))},[n,s]);const[m,j]=r.useState(void 0),y=i=>{var v,B,S;const d=JSON.parse(i),C=d.id?d.id:d.randomId,w={randomId:C,label:(v=d.label)!=null?v:C,nodeType:(B=d.nodeType)!=null?B:d.type,transform:(S=d.transform)!=null?S:de,svgs:d.svgs,components:d.components,color:d.color,core:d.core,version:d.version};if(!w.version||w.version<2){h({title:"Outdated configuration!",status:"error",duration:9e3,isClosable:!0});return}l.current.filterNodes(T=>l.current.getNodeAttribute(T,"type")===f.Master&&l.current.getNodeAttributes(T)[f.Master].randomId===m).forEach(T=>{const A=structuredClone(w),k=l.current.getNodeAttributes(T),$=structuredClone(k[f.Master]),oe=Y=>{$.components.forEach(W=>{var ee;if(W.id===Y)return(ee=W.value)!=null?ee:W.defaultValue})};A.components.forEach((Y,W)=>{var ee;A.components[W].value=(ee=oe(Y.id))!=null?ee:Y.defaultValue}),A.color!==void 0&&(A.color.value=$.color?A.color.value:A.color.defaultValue),l.current.mergeNodeAttributes(T,{[f.Master]:A})}),a(me()),a(ue(l.current.export()))},b=i=>{const d={id:i.randomId,type:i.nodeType,svgs:i.svgs,components:i.components,color:i.color,core:i.core,version:i.version};d.components.forEach((C,w)=>{d.components[w].value=C.defaultValue}),Fe("RMP_Master_Node_".concat(new Date().valueOf(),".json"),"application/json",JSON.stringify(d))},p=i=>{l.current.filterNodes(d=>l.current.getNodeAttribute(d,"type")===f.Master&&l.current.getNodeAttributes(d)[f.Master].randomId===i).forEach(d=>{l.current.dropNode(d)}),a(me()),a(ue(l.current.export()))},g=(i,d)=>{l.current.filterNodes(C=>l.current.getNodeAttribute(C,"type")===f.Master&&l.current.getNodeAttributes(C)[f.Master].randomId===i.randomId).forEach(C=>{l.current.mergeNodeAttributes(C,{[f.Master]:{...i,label:d}})}),a(me()),a(ue(l.current.export()))},N=u.map(i=>{var C,w;const d=[{label:c("panel.details.masterManage.id"),type:"custom",component:e.jsx(pe,{name:i.randomId,fg:L.white,bg:i.randomId==="undefined"?"#000000":"#19B3EA"})},{label:c("panel.details.masterManage.label"),type:"input",value:(C=i.label)!=null?C:i.randomId,onChange:v=>g(i,v),hidden:i.randomId==="undefined"},{label:c("panel.details.masterManage.label"),type:"output",value:(w=i.label)!=null?w:i.randomId,hidden:i.randomId!=="undefined"},{label:c("panel.details.masterManage.type"),type:"custom",component:e.jsx(pe,{name:i.nodeType,fg:L.white,bg:i.nodeType==="MiscNode"?"#FF8651":"#51BC00"})}];return e.jsxs(he,{width:"100%",direction:"row",children:[e.jsx(he,{width:"100%",children:e.jsx(_,{fields:d,minW:"100px"})}),e.jsxs(he,{direction:"row",mr:"auto",children:[e.jsx(O,{onClick:()=>j(i.randomId),children:e.jsx(we,{})}),e.jsx(O,{onClick:()=>b(i),isDisabled:i.randomId==="undefined",children:e.jsx(_e,{})}),e.jsx(O,{onClick:()=>p(i.randomId),children:e.jsx($e,{})})]})]})});return e.jsxs(Ce,{isOpen:n,onClose:t,size:"xl",scrollBehavior:"inside",children:[e.jsx(Be,{}),e.jsxs(ve,{children:[e.jsx(Le,{children:c("panel.details.masterManage.title")}),e.jsx(Se,{}),e.jsxs(Te,{width:"100%",children:[...N,e.jsx(Ae,{isOpen:!!m,onClose:()=>j(void 0),onSubmit:y})]}),e.jsx(Pe,{children:e.jsx(O,{colorScheme:"blue",variant:"outline",mr:"1",onClick:t,children:c("close")})})]})]})},ft=o=>{var N;const{id:n,x:t,y:c,attrs:s,handlePointerDown:l,handlePointerMove:a,handlePointerUp:h}=o,u=r.useCallback(i=>l(n,i),[n,l]),x=r.useCallback(i=>a(n,i),[n,a]),m=r.useCallback(i=>h(n,i),[n,h]),j=(i,...d)=>new Function(...d,"return ".concat(i)),y=(i,d,C)=>{var v;const w={};for(const B in i)if(Object.prototype.hasOwnProperty.call(i,B))try{w[B]=j(i[B].slice(1),...s.components.map(S=>S.label),"color")(...d.map((S,T)=>C[T]==="number"&&!Number.isNaN(Number(S))?Number(S):S),s.color?(v=s.color.value)!=null?v:s.color.defaultValue:"")}catch(S){w[B]=""}return w},b=s.nodeType==="MiscNode"?{onPointerDown:u,onPointerMove:x,onPointerUp:m,style:{cursor:"move"}}:{},p=i=>i.map(d=>{var v,B;const C=s.nodeType==="Station"&&s.core&&s.core===d.id?{id:"stn_core_".concat(n),onPointerDown:u,onPointerMove:x,onPointerUp:m,style:{cursor:"move"}}:{},w=y(d.attrs,s.components.map(S=>S.value),s.components.map(S=>S.type));return e.jsx("g",{transform:"translate(".concat((v=w.x)!=null?v:0,", ").concat((B=w.y)!=null?B:0,")"),children:r.createElement(d.type,{...w,x:0,y:0,...C},d.children?p(d.children):"_rmp_children_text"in w?w._rmp_children_text:null)},d.id)}),g=(N=s.transform)!=null?N:de;return r.createElement("g",{id:n,transform:"translate(".concat(t,", ").concat(c,")"),...b},s.randomId!=="undefined"?e.jsx("g",{transform:"translate(".concat(g.translateX,", ").concat(g.translateY,") scale(").concat(g.scale,") rotate(").concat(g.rotate,")"),children:p(s.svgs)}):e.jsxs("g",{children:[e.jsx("circle",{r:"5.5"}),e.jsx("g",{transform:"translate(-4.7, -5) scale(0.8)",children:e.jsx("polygon",{points:"6,1 7.5,4.25 11,4.65 8.5,7.1 9.2,10.75 6,9 2.8,10.75 3.5,7.1 1,4.65 4.5,4.25",fill:"white"})})]}))},yt={randomId:"undefined",label:"Undefined",transform:de,nodeType:"MiscNode",svgs:[],components:[]},bt=o=>{var C,w;const{id:n,attrs:t,handleAttrsUpdate:c}=o,s=Ne(),l=Me(),{paletteAppClip:{output:a}}=je(v=>v.runtime),{t:h}=R(),[u,x]=r.useState(!1),[m,j]=r.useState(!1),y=v=>{t.components.forEach(B=>{var S;if(B.id===v)return(S=B.value)!=null?S:B.defaultValue})},b=v=>{var A,k,$;const B=JSON.parse(v),S=B.id?B.id:B.randomId,T={randomId:S,label:(A=B.label)!=null?A:S,nodeType:(k=B.nodeType)!=null?k:B.type,transform:($=B.transform)!=null?$:de,svgs:B.svgs,components:B.components,color:B.color,core:B.core,version:B.version};if(!T.version||T.version<2){l({title:"Outdated configuration!",status:"error",duration:9e3,isClosable:!0});return}T.components.forEach((oe,Y)=>{var W;T.components[Y].value=(W=y(oe.id))!=null?W:oe.defaultValue}),T.color!==void 0&&(T.color.value=t.color?t.color.value:T.color.defaultValue),c(n,T)},p=[{type:"output",label:h("panel.details.nodes.master.type"),value:(C=t.label)!=null?C:t.randomId},{type:"custom",label:"",component:e.jsxs(e.Fragment,{children:[e.jsx(O,{onClick:()=>x(!0),children:e.jsx(we,{})}),e.jsx(O,{onClick:()=>j(!0),children:e.jsx(Ie,{})})]}),oneLine:!0}],g=t.components.map((v,B)=>{const{label:S,type:T,defaultValue:A,value:k}=v;return T==="number"||T==="text"?{label:h(S),type:"input",value:k!=null?k:A,onChange:$=>{t.components[B].value=$,c(n,{...t,components:t.components})}}:T==="switch"?{label:h(S),type:"switch",isChecked:(k!=null?k:A)==="true",onChange:$=>{t.components[B].value=$,c(n,{...t,components:t.components})}}:T==="textarea"?{label:h(S),type:"textarea",value:k!=null?k:A,onChange:$=>{t.components[B].value=$,c(n,{...t,components:t.components})}}:{type:"input",label:"undefined",value:"none"}}),[N,i]=r.useState(!1);r.useEffect(()=>{t.color&&N&&a&&(t.color.value=a,c(n,{...t,color:t.color}),i(!1))},[a==null?void 0:a.toString()]);const d=[{type:"custom",label:h("color"),component:e.jsx(Re,{theme:(w=t.color)==null?void 0:w.value,onClick:()=>{var v;i(!0),s(Ee((v=t.color)==null?void 0:v.value))}})}];return e.jsxs(e.Fragment,{children:[e.jsx(_,{fields:p}),t.randomId!=="undefined"&&e.jsx(_,{fields:g,minW:"full"}),t.randomId!=="undefined"&&t.color!==void 0&&e.jsx(_,{fields:d,minW:"full"}),e.jsx(Ae,{isOpen:u,onClose:()=>x(!1),onSubmit:b}),e.jsx(gt,{isOpen:m,onClose:()=>j(!1)})]})},jt=e.jsxs("svg",{viewBox:"0 0 24 24",height:40,width:40,focusable:!1,children:[e.jsx("circle",{cx:"12",cy:"12",r:"6",stroke:"currentColor",fill:"none"}),e.jsx("g",{transform:"translate(7.25, 7) scale(0.8)",children:e.jsx("polygon",{points:"6,1 7.5,4.25 11,4.65 8.5,7.1 9.2,10.75 6,9 2.8,10.75 3.5,7.1 1,4.65 4.5,4.25",fill:"currentColor"})})]}),Nt={component:ft,icon:jt,defaultAttrs:yt,attrsComponent:bt,metadata:{displayName:"panel.details.nodes.master.displayName",tags:[]}},Lt={[f.Virtual]:Je,[f.ShmetroNumLineBadge]:Ke,[f.ShmetroTextLineBadge]:on,[f.GzmtrLineBadge]:rn,[f.BjsubwayNumLineBadge]:hn,[f.BjsubwayTextLineBadge]:bn,[f.SuzhouRTNumLineBadge]:Bn,[f.BerlinSBahnLineBadge]:_n,[f.BerlinUBahnLineBadge]:Pn,[f.ChongqingRTNumLineBadge]:Un,[f.ChongqingRTTextLineBadge]:qn,[f.ShenzhenMetroNumLineBadge]:Jn,[f.MRTDestinationNumbers]:Yn,[f.MRTLineBadge]:tt,[f.JREastLineBadge]:it,[f.QingdaoMetroNumLineBadge]:mt,[f.Facilities]:Oe,[f.Text]:ce,[f.I18nText]:xt,[f.Master]:Nt};export{Lt as m};
