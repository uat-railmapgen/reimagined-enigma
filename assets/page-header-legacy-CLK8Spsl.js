System.register(["./chakra-legacy--ElhKRU8.js","./index-legacy-oHhb9kTf.js","./react-legacy-CB7hQk4J.js","./index-legacy-C-fJnI9g.js","./master-manager-legacy-BelPZnRg.js","./change-type-modal-legacy-Ch8Bde-f.js"],(function(e,s){"use strict";var n,t,i,r,o,a,l,c,d,h,u,x,p,g,m,j,f,b,w,y,v,z,S,C,k,O,M,_,E,A,N,H,R,W,T,I,L,P,B,Z,G,D,U,K,Y,V,F,q,J,X,Q,$,ee,se,ne,te,ie,re,oe,ae,le,ce,de,he,ue,xe,pe,ge,me,je,fe,be,we,ye,ve,ze,Se,Ce,ke,Oe,Me,_e,Ee,Ae,Ne,He,Re,We,Te,Ie,Le,Pe,Be,Ze,Ge,De,Ue,Ke,Ye,Ve,Fe,qe,Je,Xe,Qe,$e,es,ss,ns,ts,is,rs,os,as,ls,cs,ds,hs,us,xs,ps,gs,ms,js,fs,bs,ws,ys,vs,zs,Ss,Cs,ks,Os,Ms,_s,Es,As,Ns,Hs,Rs,Ws,Ts,Is,Ls,Ps;return{setters:[e=>{n=e.j,t=e.at,i=e.$,r=e.au,o=e.a1,a=e.a2,l=e.a3,c=e.g,d=e.av,h=e.a4,u=e.B,x=e.aw,p=e.ax,g=e.ay,m=e.az,j=e.aA,f=e.as,b=e.h,w=e.O,y=e.a5,v=e.aB,z=e.aC,S=e.aD,C=e.a7,k=e.aE,O=e.a6,M=e.aF,_=e.aG,E=e.af,A=e.aH,N=e.aI,H=e.U,R=e.aJ,W=e.aK,T=e.aL,I=e.al,L=e.d,P=e.R,B=e.q,Z=e.Z,G=e.aM,D=e.aN,U=e.ak,K=e.aO,Y=e.aP,V=e.aQ,F=e.aR,q=e.aS,J=e.aT,X=e.aU,Q=e.W,$=e.m,ee=e.a8,se=e.a9},e=>{ne=e.u,te=e.r,ie=e.E,re=e.M,oe=e.C,ae=e.a,le=e.n,ce=e.L,de=e.S,he=e.R,ue=e.b,xe=e.c,pe=e.d,ge=e.e,me=e.f,je=e.g,fe=e.h,be=e.i,we=e.j,ye=e.s,ve=e.k,ze=e.l,Se=e.m,Ce=e.o,ke=e.p,Oe=e.q,Me=e.t,_e=e.v,Ee=e.w,Ae=e.x,Ne=e.y,He=e.z,Re=e.A,We=e.B,Te=e.D,Ie=e.F,Le=e.G,Pe=e.H,Be=e.I,Ze=e.J,Ge=e.K,De=e.N,Ue=e.O,Ke=e.P,Ye=e.Q,Ve=e.T,Fe=e.U,qe=e.V,Je=e.W,Xe=e.X,Qe=e.Y,$e=e.Z,es=e._,ss=e.$,ns=e.a0,ts=e.a1,is=e.a2,rs=e.a3,os=e.a4,as=e.a5,ls=e.a6,cs=e.a7,ds=e.a8,hs=e.a9,us=e.aa,xs=e.ab,ps=e.ac,gs=e.ad,ms=e.ae,js=e.af,fs=e.ag,bs=e.ah,ws=e.ai,ys=e.aj,vs=e.ak,zs=e.al,Ss=e.am,Cs=e.an,ks=e.ao},e=>{Os=e.u,Ms=e.b,_s=e.r,Es=e.T},e=>{As=e.I},e=>{Ns=e.d,Hs=e.m,Rs=e.a,Ws=e.i,Ts=e.s,Is=e.u,Ls=e.M},e=>{Ps=e.C}],execute:function(){e("default",(function(){return n.jsxs(n.Fragment,{children:[n.jsx(at,{}),n.jsx(lt,{})]})}));var s=function(e){return ne(te.ready(),e)},Bs={ar:{ar:"العربية",en:"Arabic",ko:"아랍어","zh-Hans":"阿拉伯文","zh-Hant":"阿拉伯文"},az:{az:"Azərbaycanca",en:"Azerbaijani",ko:"아제르바이잔어","zh-Hans":"阿塞拜疆文","zh-Hant":"阿塞拜疆文"},ca:{ca:"Català",en:"Catalan",ko:"카탈루냐어","zh-Hans":"加泰罗尼亚文","zh-Hant":"加泰隆尼亞文"},da:{da:"Dansk",en:"Danish",ko:"덴마크어","zh-Hans":"丹麦文","zh-Hant":"丹麥文"},de:{de:"Deutsch",en:"German",ko:"독일어","zh-Hans":"德文","zh-Hant":"德文"},el:{el:"Ελληνικά",en:"Greek",ko:"그리스어","zh-Hans":"希腊文","zh-Hant":"希臘文"},en:{en:"English",ja:"英語",ko:"영어","zh-Hans":"英文","zh-Hant":"英文"},es:{en:"Spanish",es:"Español",ko:"스페인어","zh-Hans":"西班牙文","zh-Hant":"西班牙文"},fa:{en:"Persian",fa:"فارسی",ko:"페르시아어","zh-Hans":"波斯文","zh-Hant":"波斯文"},fr:{en:"French",fr:"Français",ko:"프랑스어","zh-Hans":"法文","zh-Hant":"法文"},ga:{en:"Irish",ga:"Gaeilge",ko:"아일랜드어","zh-Hans":"爱尔兰文","zh-Hant":"愛爾蘭文"},gd:{en:"Scottish Gaelic",gd:"Gàidhlig",ko:"스코틀랜드 게일어","zh-Hans":"苏格兰盖尔文","zh-Hant":"蘇格蘭蓋爾文"},hi:{en:"Hindi",hi:"हिन्दी",ko:"힌디어","zh-Hans":"印地文","zh-Hant":"印地文"},hu:{en:"Hungarian",hu:"Magyar",ko:"헝가리어","zh-Hans":"匈牙利文","zh-Hant":"匈牙利文"},id:{en:"Indoesian",id:"Bahasa Indonesia",ko:"인도네시아어","zh-Hans":"印尼文","zh-Hant":"印尼文"},it:{en:"Italian",it:"Italiano",ko:"이탈리아어","zh-Hans":"意大利文","zh-Hant":"意大利文"},ja:{en:"Japanese",ja:"日本語",ko:"일본어","zh-Hans":"日文","zh-Hant":"日文"},kk:{en:"Kazakh",kk:"Қазақша",ko:"카자흐어","zh-Hans":"哈萨克文","zh-Hant":"哈薩克文"},ko:{en:"Korean",ja:"韓国語",ko:"한국어","zh-Hans":"韩文","zh-Hant":"韓文"},ms:{en:"Malay",ko:"말레이어",ms:"Bahasa Melayu","zh-Hans":"马来文","zh-Hant":"馬來文"},no:{en:"Norwegian",ko:"노르웨이어",no:"Norsk","zh-Hans":"挪威文","zh-Hant":"挪威文"},pl:{en:"Polish",ko:"폴란드어",pl:"Polski","zh-Hans":"波兰文","zh-Hant":"波蘭文"},pt:{en:"Portuguese",ko:"포르투갈어",pt:"Português","zh-Hans":"葡萄牙文","zh-Hant":"葡萄牙文"},ro:{en:"Romanian",ko:"루마니아어",ro:"Română","zh-Hans":"罗马尼亚文","zh-Hant":"羅馬尼亞文"},ru:{en:"Russian",ko:"러시아어",ru:"Русский","zh-Hans":"俄文","zh-Hant":"俄文"},sv:{en:"Swedish",ko:"스웨덴어",sv:"Svenska","zh-Hans":"瑞典文","zh-Hant":"瑞典文"},th:{en:"Thai",ko:"태국어",th:"ภาษาไทย","zh-Hans":"泰文","zh-Hant":"泰文"},tr:{en:"Turkish",ko:"튀르키예어",tr:"Türkçe","zh-Hans":"土耳其文","zh-Hant":"土耳其文"},uk:{en:"Ukrainian",ko:"우크라이나어",uk:"Українська","zh-Hans":"乌克兰文","zh-Hant":"烏克蘭文"},ur:{en:"Urdo",ko:"우르두어",ur:"اردو","zh-Hans":"乌尔都文","zh-Hant":"烏爾都文"},uz:{en:"Uzbek",ko:"우즈베크어",uz:"Oʻzbekcha","zh-Hans":"乌兹别克文","zh-Hant":"烏茲別克文"},vi:{en:"Vietnamese",ko:"베트남어",vi:"Tiếng Việt","zh-Hans":"越南文","zh-Hant":"越南文"},zh:{en:"Chinese",ja:"中国語",ko:"중국어",zh:"中文","zh-Hans":"中文","zh-Hant":"中文"},"zh-Hans":{en:"Simplified Chinese",ja:"中国語（簡体字）",ko:"중국어 간체자","zh-Hans":"简体中文","zh-Hant":"簡體中文"},"zh-Hant":{en:"Traditional Chinese",ja:"中国語（繁体字）",ko:"중국어 정체자","zh-Hans":"繁体中文","zh-Hant":"繁體中文"}};const Zs=e=>{const{isOpen:s,onClose:f}=e,{t:b}=Os(),w=te.getAppVersion();return n.jsxs(t,{isOpen:s,onClose:f,size:"xl",scrollBehavior:"inside",children:[n.jsx(i,{}),n.jsxs(r,{children:[n.jsx(o,{children:b("header.about.title")}),n.jsx(a,{}),n.jsxs(l,{paddingBottom:10,children:[n.jsxs(c,{direction:"row",children:[n.jsx(d,{boxSize:"128px",src:"/rmp//logo192.png"}),n.jsxs(c,{direction:"column",width:"100%",alignItems:"center",justifyContent:"center",children:[n.jsx(h,{fontSize:"xl",as:"b",children:b("header.about.rmp")}),n.jsx(h,{children:w}),n.jsx(h,{}),n.jsx(h,{fontSize:"sm",children:b("header.about.railmapgen")})]})]}),n.jsx(u,{margin:5,children:n.jsx(h,{fontSize:"xl",children:b("header.about.desc")})}),n.jsx(x,{as:"h5",size:"sm",mt:3,mb:2,children:b("header.about.contributors")}),n.jsx(x,{as:"h6",size:"xs",my:2,children:b("header.about.coreContributors")}),n.jsxs(p,{children:[n.jsxs(g,{size:"lg",w:"85%",onClick:()=>window.open("https://github.com/thekingofcity","_blank"),cursor:"pointer",children:[n.jsx(m,{src:"https://github.com/thekingofcity.png",size:"lg",my:2,ml:-1,mr:2}),n.jsxs(j,{display:"block",width:"100%",children:[n.jsx(h,{fontSize:"lg",fontWeight:"bold",mb:1,children:"thekingofcity"}),n.jsx(h,{fontSize:"sm",children:b("header.about.content1")}),n.jsx(h,{fontSize:"sm",align:"right",mb:1,children:b("header.about.content2")})]})]}),n.jsxs(g,{size:"lg",w:"85%",onClick:()=>window.open("https://github.com/langonginc","_blank"),cursor:"pointer",children:[n.jsx(m,{src:"https://github.com/langonginc.png",size:"lg",my:2,ml:-1,mr:2}),n.jsxs(j,{display:"block",width:"100%",children:[n.jsx(h,{fontSize:"lg",fontWeight:"bold",mb:1,children:"langonginc"}),n.jsx(h,{fontSize:"sm",children:b("header.about.langonginc")}),n.jsx(h,{fontSize:"sm",align:"right",mb:1,children:"--Avicii"})]})]})]}),n.jsx(x,{as:"h6",size:"xs",my:2,children:b("header.about.styleContributors")}),n.jsxs(p,{children:[n.jsxs(g,{size:"lg",w:"85%",onClick:()=>window.open("https://github.com/203IhzElttil","_blank"),cursor:"pointer",children:[n.jsx(m,{src:"https://github.com/203IhzElttil.png",size:"lg",my:2,ml:-1,mr:2}),n.jsxs(j,{display:"block",width:"100%",children:[n.jsx(h,{fontSize:"lg",fontWeight:"bold",mb:1,children:"203IhzElttil"}),n.jsx(h,{fontSize:"sm",mb:1,children:b("header.about.203IhzElttil")})]})]}),n.jsxs(g,{size:"lg",w:"85%",onClick:()=>window.open("https://github.com/Swiftiecott","_blank"),cursor:"pointer",children:[n.jsx(m,{src:"https://github.com/Swiftiecott.png",size:"lg",my:2,ml:-1,mr:2}),n.jsxs(j,{display:"block",width:"100%",children:[n.jsx(h,{fontSize:"lg",fontWeight:"bold",mb:1,children:"Swiftiecott"}),n.jsx(h,{fontSize:"sm",mb:1,children:b("header.about.Swiftiecott")})]})]}),n.jsxs(g,{size:"lg",w:"85%",onClick:()=>window.open("https://github.com/Minwtraft","_blank"),cursor:"pointer",children:[n.jsx(m,{src:"https://github.com/Minwtraft.png",size:"lg",my:2,ml:-1,mr:2}),n.jsxs(j,{display:"block",width:"100%",children:[n.jsx(h,{fontSize:"lg",fontWeight:"bold",mb:1,children:"Minwtraft"}),n.jsx(h,{fontSize:"sm",mb:1,children:b("header.about.Minwtraft")})]})]})]}),n.jsx(x,{as:"h5",size:"sm",mt:3,mb:2,children:b("header.about.contactUs")}),n.jsxs(p,{children:[n.jsxs(g,{size:"lg",w:"85%",onClick:()=>window.open("https://github.com/railmapgen/rmp/issues","_blank"),cursor:"pointer",children:[n.jsx(m,{src:"data:image/svg+xml,%3csvg%20width='98'%20height='96'%20xmlns='http://www.w3.org/2000/svg'%3e%3cpath%20fill-rule='evenodd'%20clip-rule='evenodd'%20d='M48.854%200C21.839%200%200%2022%200%2049.217c0%2021.756%2013.993%2040.172%2033.405%2046.69%202.427.49%203.316-1.059%203.316-2.362%200-1.141-.08-5.052-.08-9.127-13.59%202.934-16.42-5.867-16.42-5.867-2.184-5.704-5.42-7.17-5.42-7.17-4.448-3.015.324-3.015.324-3.015%204.934.326%207.523%205.052%207.523%205.052%204.367%207.496%2011.404%205.378%2014.235%204.074.404-3.178%201.699-5.378%203.074-6.6-10.839-1.141-22.243-5.378-22.243-24.283%200-5.378%201.94-9.778%205.014-13.2-.485-1.222-2.184-6.275.486-13.038%200%200%204.125-1.304%2013.426%205.052a46.97%2046.97%200%200%201%2012.214-1.63c4.125%200%208.33.571%2012.213%201.63%209.302-6.356%2013.427-5.052%2013.427-5.052%202.67%206.763.97%2011.816.485%2013.038%203.155%203.422%205.015%207.822%205.015%2013.2%200%2018.905-11.404%2023.06-22.324%2024.283%201.78%201.548%203.316%204.481%203.316%209.126%200%206.6-.08%2011.897-.08%2013.526%200%201.304.89%202.853%203.316%202.364%2019.412-6.52%2033.405-24.935%2033.405-46.691C97.707%2022%2075.788%200%2048.854%200z'%20fill='%2324292f'/%3e%3c/svg%3e",size:"lg",my:2,ml:-1,mr:2}),n.jsxs(j,{display:"block",width:"100%",children:[n.jsx(h,{fontSize:"lg",fontWeight:"bold",mb:1,children:b("header.about.github")}),n.jsx(h,{fontSize:"sm",children:b("header.about.githubContent")})]})]}),n.jsxs(g,{size:"lg",w:"85%",onClick:()=>window.open("https://join.slack.com/t/railmapgenerator/shared_invite/zt-1odhhta3n-DdZF~fnVwo_q0S0RJmgV8A","_blank"),cursor:"pointer",children:[n.jsx(m,{src:"data:image/svg+xml,%3c?xml%20version='1.0'%20encoding='utf-8'?%3e%3c!--%20Generator:%20Adobe%20Illustrator%2023.0.1,%20SVG%20Export%20Plug-In%20.%20SVG%20Version:%206.00%20Build%200)%20--%3e%3csvg%20version='1.1'%20id='Layer_1'%20xmlns='http://www.w3.org/2000/svg'%20xmlns:xlink='http://www.w3.org/1999/xlink'%20x='0px'%20y='0px'%20viewBox='0%200%20270%20270'%20style='enable-background:new%200%200%20270%20270;'%20xml:space='preserve'%3e%3cstyle%20type='text/css'%3e%20.st0{fill:%23E01E5A;}%20.st1{fill:%2336C5F0;}%20.st2{fill:%232EB67D;}%20.st3{fill:%23ECB22E;}%20%3c/style%3e%3cg%3e%3cg%3e%3cpath%20class='st0'%20d='M99.4,151.2c0,7.1-5.8,12.9-12.9,12.9c-7.1,0-12.9-5.8-12.9-12.9c0-7.1,5.8-12.9,12.9-12.9h12.9V151.2z'/%3e%3cpath%20class='st0'%20d='M105.9,151.2c0-7.1,5.8-12.9,12.9-12.9s12.9,5.8,12.9,12.9v32.3c0,7.1-5.8,12.9-12.9,12.9%20s-12.9-5.8-12.9-12.9V151.2z'/%3e%3c/g%3e%3cg%3e%3cpath%20class='st1'%20d='M118.8,99.4c-7.1,0-12.9-5.8-12.9-12.9c0-7.1,5.8-12.9,12.9-12.9s12.9,5.8,12.9,12.9v12.9H118.8z'/%3e%3cpath%20class='st1'%20d='M118.8,105.9c7.1,0,12.9,5.8,12.9,12.9s-5.8,12.9-12.9,12.9H86.5c-7.1,0-12.9-5.8-12.9-12.9%20s5.8-12.9,12.9-12.9H118.8z'/%3e%3c/g%3e%3cg%3e%3cpath%20class='st2'%20d='M170.6,118.8c0-7.1,5.8-12.9,12.9-12.9c7.1,0,12.9,5.8,12.9,12.9s-5.8,12.9-12.9,12.9h-12.9V118.8z'/%3e%3cpath%20class='st2'%20d='M164.1,118.8c0,7.1-5.8,12.9-12.9,12.9c-7.1,0-12.9-5.8-12.9-12.9V86.5c0-7.1,5.8-12.9,12.9-12.9%20c7.1,0,12.9,5.8,12.9,12.9V118.8z'/%3e%3c/g%3e%3cg%3e%3cpath%20class='st3'%20d='M151.2,170.6c7.1,0,12.9,5.8,12.9,12.9c0,7.1-5.8,12.9-12.9,12.9c-7.1,0-12.9-5.8-12.9-12.9v-12.9H151.2z'/%3e%3cpath%20class='st3'%20d='M151.2,164.1c-7.1,0-12.9-5.8-12.9-12.9c0-7.1,5.8-12.9,12.9-12.9h32.3c7.1,0,12.9,5.8,12.9,12.9%20c0,7.1-5.8,12.9-12.9,12.9H151.2z'/%3e%3c/g%3e%3c/g%3e%3c/svg%3e",size:"lg",my:2,ml:-1,mr:2}),n.jsxs(j,{display:"block",width:"100%",children:[n.jsx(h,{fontSize:"lg",fontWeight:"bold",mb:1,children:b("header.about.slack")}),n.jsx(h,{fontSize:"sm",children:b("header.about.slackContent")}),n.jsx(h,{fontSize:"sm",as:"i",children:"#rmp, #gallery, #rmg, #palette-and-templates"})]})]})]})]})]})]})};function Gs(e){return f({tag:"svg",attr:{viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round"},child:[{tag:"path",attr:{d:"M12 21a9 9 0 0 0 9 -9a9 9 0 0 0 -9 -9a9 9 0 0 0 -9 9a9 9 0 0 0 9 9z"},child:[]},{tag:"path",attr:{d:"M12 12m-4.5 0a4.5 4.5 0 1 0 9 0a4.5 4.5 0 1 0 -9 0"},child:[]}]})(e)}function Ds(e){return f({tag:"svg",attr:{version:"1.1",viewBox:"0 0 17 17"},child:[{tag:"g",attr:{},child:[]},{tag:"path",attr:{d:"M13 10v-10h-13v13h13v-3zM1 1h11v8h-0.755l-2.564-3.319-1.159 1.214-2.248-3.881-3.576 5.986h-0.698v-8zM9.982 9h-7.119l2.398-4.014 2.064 3.564 1.275-1.337 1.382 1.787zM1 12v-2h11v2h-11zM17 3v13h-13v-1.984h1v0.984h11v-11h-2v-1h3z"},child:[]}]})(e)}const Us=e=>{const{isOpen:s,onClose:f}=e,{t:b}=Os(),w=te.isAllowAnalytics(),y=e=>new URLSearchParams({title:`Donation: New ${e} request for [city name]`,body:`Hi, I'd like to have new ${e}, and here is my support.\n\n\x3c!-- your donation entry --\x3e\n\n\x3c!-- reference (images or URLs) --\x3e\n\n`}).toString();return Ms.useEffect((()=>{s&&w&&te.event(ie.OPEN_DONATION,{})}),[s]),n.jsxs(t,{isOpen:s,onClose:f,size:"xl",scrollBehavior:"inside",children:[n.jsx(i,{}),n.jsxs(r,{children:[n.jsx(o,{children:b("header.donation.title")}),n.jsx(a,{}),n.jsxs(l,{paddingBottom:10,children:[n.jsxs(c,{direction:"row",alignItems:"center",justifyContent:"space-around",children:[n.jsx(h,{fontSize:"96px",fontFamily:"serif",children:"I"}),n.jsx(As,{size:"64px",color:"red"}),n.jsx(d,{boxSize:"96px",src:"/rmp//logo192.png"})]}),n.jsx(u,{margin:5,children:n.jsx(h,{fontSize:"xl",children:b("header.donation.content")})}),n.jsx(x,{as:"h5",size:"sm",mb:2,children:b("header.donation.rewards")}),n.jsxs(p,{children:[n.jsxs(g,{size:"lg",w:"85%",onClick:()=>{te.isStandaloneWindow()?window.open("/rmp-gallery/#/donation","_blank"):te.openApp({appId:"rmp-gallery",hash:"/donation"})},cursor:"pointer",children:[n.jsx(m,{icon:n.jsx(Ds,{}),size:"lg",my:2,ml:-1,mr:2}),n.jsxs(j,{display:"block",width:"100%",pb:1,children:[n.jsx(h,{fontSize:"lg",fontWeight:"bold",mb:1,children:b("header.donation.gallery")}),n.jsx(h,{fontSize:"sm",children:b("header.donation.galleryContent")})]})]}),n.jsxs(g,{size:"lg",w:"85%",onClick:()=>window.open("https://github.com/railmapgen/rmp/issues/new?"+y("stations/nodes"),"_blank"),cursor:"pointer",children:[n.jsx(m,{icon:n.jsx(Gs,{}),size:"lg",my:2,ml:-1,mr:2}),n.jsxs(j,{display:"block",width:"100%",pb:1,children:[n.jsx(h,{fontSize:"lg",fontWeight:"bold",mb:1,children:b("header.donation.nodes")}),n.jsx(h,{fontSize:"sm",children:b("header.donation.nodesContent")})]})]}),n.jsxs(g,{size:"lg",w:"85%",onClick:()=>window.open("https://github.com/railmapgen/rmp/issues/new?"+y("features"),"_blank"),cursor:"pointer",children:[n.jsx(m,{icon:n.jsx(re,{}),size:"lg",my:2,ml:-1,mr:2}),n.jsxs(j,{display:"block",width:"100%",pb:1,children:[n.jsx(h,{fontSize:"lg",fontWeight:"bold",mb:1,children:b("header.donation.features")}),n.jsx(h,{fontSize:"sm",children:b("header.donation.featuresContent")})]})]})]}),n.jsx(x,{as:"h5",size:"sm",mt:3,mb:2,children:b("header.donation.methods")}),n.jsxs(p,{children:[n.jsxs(g,{size:"lg",w:"85%",onClick:()=>window.open("https://opencollective.com/rail-map-toolkit","_blank"),cursor:"pointer",children:[n.jsx(m,{src:"/rmp/assets/opencollective-icon-Ciasch0w.webp",size:"lg",my:2,ml:-1,mr:2}),n.jsxs(j,{display:"block",width:"100%",pb:1,children:[n.jsx(h,{fontSize:"lg",fontWeight:"bold",mb:1,children:b("header.donation.openCollective")}),n.jsx(h,{fontSize:"sm",children:b("header.donation.viaUSD")})]})]}),n.jsxs(g,{size:"lg",w:"85%",onClick:()=>window.open("https://afdian.com/a/rail-map-toolkit","_blank"),cursor:"pointer",children:[n.jsx(m,{src:"data:image/png;base64,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",size:"lg",my:2,ml:-1,mr:2}),n.jsxs(j,{display:"block",width:"100%",pb:1,children:[n.jsx(h,{fontSize:"lg",fontWeight:"bold",mb:1,children:b("header.donation.afdian")}),n.jsx(h,{fontSize:"sm",children:b("header.donation.viaCNY")})]})]})]})]})]})]})};
/*!
             * canvas-size
             * v2.0.0
             * https://github.com/jhildenbiddle/canvas-size
             * (c) 2015-2024 John Hildenbiddle <http://hildenbiddle.com>
             * MIT license
             */
function Ks(e){const s=e.sizes.shift(),n=Math.max(Math.ceil(s[0]),1),t=Math.max(Math.ceil(s[1]),1),i=[n-1,t-1,1,1],r=performance.now(),o="undefined"!=typeof WorkerGlobalScope&&self instanceof WorkerGlobalScope;let a,l;o?(a=new OffscreenCanvas(1,1),l=new OffscreenCanvas(n,t)):(a=document.createElement("canvas"),a.width=1,a.height=1,l=document.createElement("canvas"),l.width=n,l.height=t);const c=a.getContext("2d"),d=l.getContext("2d");d&&(d.fillRect.apply(d,i),c.drawImage(l,n-1,t-1,1,1,0,0,1,1));const h=c&&0!==c.getImageData(0,0,1,1).data[3],u=parseInt(performance.now()-r);return[a,l].forEach((e=>{e.height=0,e.width=0})),o?(postMessage({width:n,height:t,testTime:u,isTestPass:h}),!h&&e.sizes.length&&setTimeout((()=>{Ks(e)}),0)):h?e.onSuccess({width:n,height:t,testTime:u}):(e.onError({width:n,height:t,testTime:u}),e.sizes.length&&setTimeout((()=>{Ks(e)}),0)),h}const Ys={area:[16384,14188,11402,11180,10836,8192,4096,1],height:[8388607,65535,32767,16384,8192,4096,1],width:[4194303,65535,32767,16384,8192,4096,1]},Vs={max:null,min:1,sizes:[],step:1024,useWorker:!1,onError:Function.prototype,onSuccess:Function.prototype},Fs={};function qs(e){const s=e.width===e.height,n=1===e.height,t=1===e.width,i=[];if(e.width&&e.height){const r=e.min||Vs.min,o=e.step||Vs.step;let a=Math.max(e.width,e.height);for(;a>=r;){const e=s||n?a:1,r=s||t?a:1;i.push([e,r]),a-=o}}else e.sizes.forEach((e=>{const r=s||n?e:1,o=s||t?e:1;i.push([r,o])}));return i}function Js(e){const s="undefined"!=typeof window,n=s&&"Promise"in window,t=s&&"HTMLCanvasElement"in window,i=s&&"OffscreenCanvas"in window,r=URL.createObjectURL(new Blob([])).slice(-36),o=performance.now(),{onError:a,onSuccess:l,...c}=e,d=()=>parseInt(performance.now()-o);let h=null;if(!t)return!1;if(e.useWorker&&i){const e=`\n            var canvasTest = ${Ks.toString()};\n            onmessage = function(e) {\n                canvasTest(e.data);\n            };\n        `,s=new Blob([e],{type:"application/javascript"}),n=URL.createObjectURL(s);h=new Worker(n),URL.revokeObjectURL(n),h.onmessage=function(e){const{width:s,height:n,testTime:t,isTestPass:i}=e.data,o={width:s,height:n,testTime:t,totalTime:d()};i?(Fs[r].onSuccess(o),delete Fs[r]):Fs[r].onError(o)}}return n?new Promise((s=>{const n={...e,onError(n){let{width:t,height:i,testTime:r}=n;const o={width:t,height:i,testTime:r,totalTime:d()};let l;if(0===e.sizes.length)l=!0;else{const[[s,n]]=e.sizes.slice(-1);l=t===s&&i===n}a(o),l&&s({...o,success:!1})},onSuccess(e){let{width:n,height:t,testTime:i}=e;const r={width:n,height:t,testTime:i,totalTime:d()};l(r),s({...r,success:!0})}};if(h){const{onError:e,onSuccess:s}=n;Fs[r]={onError:e,onSuccess:s},h.postMessage(c)}else Ks(n)})):h?(Fs[r]={onError:a,onSuccess:l},void h.postMessage(c)):Ks(e)}const Xs={maxArea(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};const s=qs({width:e.max,height:e.max,min:e.min,step:e.step,sizes:[...Ys.area]});return Js({...Vs,...e,sizes:s})},maxHeight(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};const s=qs({width:1,height:e.max,min:e.min,step:e.step,sizes:[...Ys.height]});return Js({...Vs,...e,sizes:s})},maxWidth(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};const s=qs({width:e.max,height:1,min:e.min,step:e.step,sizes:[...Ys.width]});return Js({...Vs,...e,sizes:s})},test(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};const s={...Vs,...e};return s.sizes=[...s.sizes],s.width&&s.height&&(s.sizes=[[s.width,s.height]]),Js(s)}};var Qs=(e=>(e.left="l",e.right="r",e))(Qs||{}),$s=(e=>(e.through="through",e.nonThrough="nonthrough",e))($s||{}),en=(e=>(e.local="local",e.express="express",e.direct="direct",e))(en||{}),sn=(e=>(e.MTR="mtr",e.GZMTR="gzmtr",e.SHMetro="shmetro",e))(sn||{}),nn=(e=>(e.sh="sh",e.sh2020="sh2020",e))(nn||{});const tn=new Set,rn=new Set,on=new Set,an=new Set,ln=new Map,cn=new Map,dn=new Set,hn=new Map,un=new Map;let xn=[],pn=0;const gn=new Map,mn=new Map,jn=new Set,fn={localisedName:{en:"LEFT END"},num:"00",services:[en.local],parents:[],children:["lineend"],transfer:{groups:[{}],tick_direc:Qs.right,paid_area:!0},loop_pivot:!1,one_line:!0,int_padding:355},bn={localisedName:{en:"RIGHT END"},num:"00",services:[en.local],parents:[],children:[],transfer:{groups:[{}],tick_direc:Qs.right,paid_area:!0},loop_pivot:!1,one_line:!0,int_padding:355},wn={svgWidth:{destination:1500,runin:1500,railmap:1500,indoor:1500},svg_height:400,style:sn.SHMetro,y_pc:50,padding:10,branchSpacingPct:33,direction:Qs.right,platform_num:"1",theme:[oe.Shanghai,"sh1","#E3002B",ae.white],line_name:["地鐵線","Metro Line"],current_stn_idx:"jlaMj2",stn_list:{},namePosMTR:{isStagger:!0,isFlip:!0},customiseMTRDest:{isLegacy:!1,terminal:!1},line_num:"1",psd_num:"1",info_panel_type:nn.sh,direction_gz_x:40,direction_gz_y:70,coline:{},loop:!1,loop_info:{bank:!0,left_and_right_factor:0,bottom_factor:1}},yn={localisedName:{},num:"",services:[en.local],parents:[],children:[],transfer:{groups:[{}],tick_direc:Qs.right,paid_area:!0},loop_pivot:!1,one_line:!0,int_padding:355},vn=e=>`${e[0]}/${e[1]}=${e[2]}${e[3]}`,zn=e=>ce.includes(e),Sn=(e,s)=>{const[n,t]=e.extremities(s),i=e.getEdgeAttributes(s),r=i.style;if(n!=t&&zn(r)){const e=(e=>{if(zn(e.style))return structuredClone(e[e.style].color)})(i);an.has(vn(e))||(on.add(e),an.add(vn(e)),ln.set(e,n),cn.set(vn(e),new Set)),cn.get(vn(e)).add(n),cn.get(vn(e)).add(t),un.has(n)?xn.push({target:t,next:un.get(n),color:e}):xn.push({target:t,next:-1,color:e}),un.set(n,pn),pn++,un.has(t)?xn.push({target:n,next:un.get(t),color:e}):xn.push({target:n,next:-1,color:e}),un.set(t,pn),pn++}},Cn=(e,s,n)=>{if(cn.get(vn(n)).has(e)){cn.get(vn(n)).delete(e);for(let s=un.get(e);-1!=s;s=xn[s].next){const t=xn[s].target,i=xn[s].color;vn(i)==vn(n)&&Cn(t,e,n)}}},kn=(e,s,n)=>{if(tn.has(e))return;tn.add(e);let t=0;const i=new Set;for(let r=un.get(e);-1!=r;r=xn[r].next){const o=xn[r].target,a=xn[r].color;vn(a)==vn(n)&&(i.has(o)||(i.add(o),t++,o!=s&&kn(o,e,n)))}gn.set(e,t)},On=(e,s)=>{const n=e.stn_list.lineend.parents;n.push(s),e.stn_list.lineend.parents=structuredClone(n).reverse(),e.stn_list.lineend.branch={...e.stn_list.lineend.branch,left:2==e.stn_list.lineend.parents.length?[$s.through,n[1]]:void 0}},Mn=(e,s,n)=>{if(jn.has(e))return[];jn.add(e);const t=[];for(let i=un.get(e);-1!=i;i=xn[i].next){const r=xn[i].target,o=xn[i].color;r!=s&&vn(o)==vn(n)&&(r.startsWith("stn")?t.push(r):t.push(...Mn(r,e,n)))}return t},_n=(e,s,n,t,i,r,o)=>{if(tn.has(e)&&(!e.startsWith("misc_node_")&&null==o.stn_list[e]||e.startsWith("misc_node_")&&!rn.has(e)||o.loop))return[];if(tn.has(e)&&null!=o.stn_list[e]&&((e,s)=>{let n=0;for(let t=un.get(e);-1!=t;t=xn[t].next){xn[t].target;const e=xn[t].color;vn(e)==vn(s)&&n++}return n})(e,r)-1>=2){var a;const n=[...o.stn_list[e].parents,s];if(null==o.stn_list[n[1]]){const e=n[0];n[0]=n[1],n[1]=e}o.stn_list[e].parents=structuredClone(n).reverse(),o.stn_list[e].branch={...o.stn_list[e].branch,left:[$s.through,n[1]]};const t=[];for(const r of o.stn_list[e].children)r!=s&&t.push(r);o.stn_list[e].children=structuredClone(t),null===(a=o.stn_list[e].branch)||void 0===a||delete a.right;const i=[];for(const s of o.stn_list.lineend.parents)s!=e&&i.push(s);return o.stn_list.lineend.parents=structuredClone(i).reverse(),o.stn_list.lineend.branch={...o.stn_list.lineend.branch,left:2==o.stn_list.lineend.parents.length?[$s.through,i[1]]:void 0},0==t.length&&(o.stn_list[e].children=["lineend"],On(o,e)),[e]}tn.add(e);const l=[],c=[],d=[],h=new Set,u=new Set;for(let x=un.get(e);-1!=x;x=xn[x].next){const a=xn[x].target,c=xn[x].color;if(a!=n){if(vn(c)==vn(r)){if(u.has(a))continue;if(u.add(a),e.startsWith("misc_node_")){const n=_n(a,s,e,t+1,i,r,o);0!=n.length&&l.push(...n)}else{const s=_n(a,e,e,t+1,i,r,o);0!=s.length&&l.push(...s)}}if(!h.has(vn(c))&&vn(c)!=vn(r)){h.add(vn(c));const e={theme:c,name:[`ch_${vn(c)}`,`en_${vn(c)}`]};d.push(e)}}}if(2==l.length){for(let e=0;e<2;e++)"lineend"==l[e]&&l.splice(e,1);if(o.stn_list[l[1]].parents.length>=2){const e=l[0];l[0]=l[1],l[1]=e}}if(tn.has(e)&&null!=o.stn_list[e]){const n=[];for(const s of o.stn_list.lineend.parents)s!=e&&n.push(s);o.stn_list.lineend.parents=structuredClone(n).reverse(),o.stn_list.lineend.branch={...o.stn_list.lineend.branch,left:2==o.stn_list.lineend.parents.length?[$s.through,n[1]]:void 0},0==l.length&&(jn.clear(),c.push(...Mn(e,s,r)))}if(e.startsWith("misc_node_"))return rn.add(e),l;{const n=i.getNodeAttributes(e).type,a=i.getNodeAttributes(e)[n];if(o.stn_list[e]=structuredClone(yn),o.stn_list[e].localisedName={zh:a.names[0],en:a.names[1]},o.stn_list[e].num=String(t),i.getNodeAttributes(e).type==de.GzmtrBasic){const s=a;o.stn_list[e].num=s.stationCode,""===s.secondaryNames[0]&&""===s.secondaryNames[1]||(o.stn_list[e].localisedSecondaryName={zh:s.secondaryNames[0],en:s.secondaryNames[1]})}if(i.getNodeAttributes(e).type==de.GzmtrInt){const s=a,n=s.transfer[0];for(const t of n)if(vn(t)==vn(r)){o.stn_list[e].num=String(t[5]);break}""===s.secondaryNames[0]&&""===s.secondaryNames[1]||(o.stn_list[e].localisedSecondaryName={zh:s.secondaryNames[0],en:s.secondaryNames[1]})}return 0!=l.length?(o.stn_list[e].children=structuredClone(l).reverse(),2==l.length&&(o.stn_list[e].branch={...o.stn_list[e].branch,right:[$s.through,l[1]]})):(o.stn_list[e].children=["lineend"],On(o,e)),c.push(s),o.stn_list[e].parents=structuredClone(c).reverse(),2==c.length&&(o.stn_list[e].branch={...o.stn_list[e].branch,left:[$s.through,c[1]]}),0!=d.length&&(o.stn_list[e].transfer.groups[0].lines=structuredClone(d)),[e]}},En=(e,s,n,t)=>{const i=structuredClone(wn);let r;switch("LOOP"==t&&(i.loop=!0),e.getNodeAttributes(n).type){case de.GzmtrBasic:case de.GzmtrInt:r=sn.GZMTR;break;case de.MTR:r=sn.MTR;break;default:r=sn.SHMetro}i.theme=structuredClone(s),i.style=r,i.stn_list.linestart=structuredClone(fn),i.stn_list.lineend=structuredClone(bn),tn.clear(),rn.clear();const o=_n(n,"linestart","linestart",1,e,s,i);return i.current_stn_idx=o[0],i.stn_list.linestart.children=[o[0]],Object.keys(i.stn_list).length<=3||i.stn_list.lineend.parents.length>=3?void 0:structuredClone(i)},An=(e,s,n,t)=>{var i;e.line_name=s,e.line_num=String(n),Ns(`RMG_${i=s,""!=i[0]&&""!=i[1]?i[0]+"_"+i[1]:""!=i[0]?i[0]:""!=i[1]?i[1]:`${(new Date).valueOf()}`}.json`,"application/json",((e,s)=>{let n=e;return s.forEach(((e,s)=>{const t=new RegExp(`ch_${s}`,"g"),i=new RegExp(`en_${s}`,"g");n=n.replace(t,e[0]),n=n.replace(i,e[1])})),n})(JSON.stringify(e),t))},Nn={LINE:"#33ccff",BRANCH:"#007B61",LOOP:"#ff6666"},Hn=e=>{const{isOpen:s,onClose:c}=e,{t:d}=Os(),u=Ms.useRef(window.graph),[x,p]=Ms.useState(!1),[g,m]=Ms.useState([[wn,"",""]]),[j,f]=Ms.useState(["","",""]),[v,z]=Ms.useState(new Map),[S,C]=Ms.useState(new Map),[k,O]=Ms.useState([]);Ms.useEffect((()=>{if(s){const e=(e=>{tn.clear(),on.clear(),an.clear(),ln.clear(),cn.clear(),dn.clear(),hn.clear(),un.clear(),xn=[],pn=0,gn.clear(),mn.clear(),e.filterEdges((e=>e.startsWith("line"))).forEach((s=>{zn(e.getEdgeAttributes(s).style)&&Sn(e,s)}));let s=0;e.forEachNode((e=>{mn.set(e,++s)})),mn.set("lineend",++s);const n=[];for(const r of on){let e=0;for(;0!=cn.get(vn(r)).size;){let s="line_root";cn.get(vn(r)).forEach((e=>{"line_root"==s&&(s=e)})),Cn(s,"line_root",r);const n={theme:r,index:++e};dn.add(n),hn.set(n,s)}}for(const r of dn){const{theme:s}=r;tn.clear(),gn.clear(),kn(hn.get(r),"line_root",s);let o=!0,a="LINE";const l=[];for(const[e,n]of gn)1==n&&l.push(e),3==n&&(a="BRANCH"),n>3&&(o=!1);if(!o)continue;0==l.length&&(a="LOOP",l.push(ln.get(s)));const c=[];for(const n of l){const r=En(e,s,n,a);var t,i;null!=r&&c.push([r,null!==(t=r.stn_list[r.current_stn_idx].localisedName.zh)&&void 0!==t?t:"",null!==(i=r.stn_list[r.current_stn_idx].localisedName.en)&&void 0!==i?i:""])}0!=c.length&&n.push({id:le(10),theme:s,param:structuredClone(c),type:a})}return n})(u.current),s=new Map;e.forEach((({id:e,theme:n})=>{s.set(vn(n),e)})),O(e),z(s)}}),[s]);const M=(e,s)=>document.getElementById("2RMG_"+s+"_"+e).value.trim();return n.jsxs(t,{isOpen:s,onClose:c,size:"2xl",scrollBehavior:"inside",children:[n.jsx(i,{}),n.jsxs(r,{children:[n.jsx(o,{children:n.jsx(h,{as:"b",fontSize:"xl",children:d("header.download.2rmg.title")})}),n.jsx(a,{}),n.jsxs(l,{children:[n.jsx(h,{fontSize:"sm",mt:"3",lineHeight:"100%",children:d("header.download.2rmg.info1")}),n.jsx(h,{fontSize:"sm",mt:"3",lineHeight:"100%",children:d("header.download.2rmg.info2")}),n.jsx("br",{}),0===k.length?n.jsx(h,{fontSize:"md",children:d("header.download.2rmg.noline")}):n.jsx("table",{children:n.jsx("tbody",{children:k.map((({id:e,theme:s,param:t,type:i})=>n.jsxs("tr",{children:[n.jsx("td",{children:n.jsx(he,{name:"other"==s[0]&&"other"==s[1]?s[2]:s[1],bg:s[2],fg:s[3]})}),n.jsx("td",{children:n.jsx(b,{placeholder:d("header.download.2rmg.placeholder.chinese"),id:`2RMG_nameCh_${e}`,size:"sm"})}),n.jsx("td",{children:n.jsx(b,{placeholder:d("header.download.2rmg.placeholder.english"),id:`2RMG_nameEn_${e}`,size:"sm"})}),n.jsx("td",{children:n.jsx(b,{placeholder:d("header.download.2rmg.placeholder.lineCode"),id:`2RMG_lineNum_${e}`,size:"sm"})}),n.jsx("td",{children:n.jsx(he,{name:d(`header.download.2rmg.type.${i.toLowerCase()}`),bg:Nn[i],fg:ae.white})}),n.jsx("td",{children:n.jsx(w,{colorScheme:"blue",variant:"ghost",mr:"1",onClick:()=>{const s=M(e,"nameCh"),n=M(e,"nameEn"),i=M(e,"lineNum"),r=new Map;v.forEach(((e,s)=>{r.set(s,[M(e,"nameCh"),M(e,"nameEn")])})),m(t),f([s,n,i]),C(r),p(!0)},size:"sm",children:n.jsx(ue,{})})})]},JSON.stringify(s))))})})]}),n.jsx(y,{children:n.jsx(w,{colorScheme:"blue",variant:"outline",mr:"1",onClick:c,children:d("close")})})]}),n.jsx(Rn,{isOpen:x,onClose:()=>p(!1),param:g,nameList:j,interchangeName:S})]})},Rn=e=>{const{isOpen:s,onClose:c,param:d,nameList:u,interchangeName:x}=e,{t:p}=Os(),[g,m]=Ms.useState("");return Ms.useEffect((()=>{""!=u[0]&&""!=u[1]?m(u[0]+"/"+u[1]):""!=u[0]?m(u[0]):""!=u[1]?m(u[1]):m("")}),[...u]),n.jsxs(t,{isOpen:s,onClose:c,size:"md",scrollBehavior:"inside",children:[n.jsx(i,{}),n.jsxs(r,{children:[n.jsx(o,{children:n.jsxs(h,{as:"b",fontSize:"xl",children:[p("header.download.2rmg.download")," ",g]})}),n.jsx(a,{}),n.jsx(l,{children:n.jsxs(v,{children:[n.jsx(h,{fontSize:"sm",mb:"2",lineHeight:"100%",children:p("header.download.2rmg.downloadInfo")}),d.map((([e,s,t])=>n.jsxs(w,{onClick:()=>{An(e,[u[0],u[1]],u[2],x)},overflow:"hidden",size:"md",textOverflow:"ellipsis",whiteSpace:"nowrap",display:"ruby",children:[s.replaceAll("\n","⏎"),"/",t.replaceAll("\n","⏎")]},`${s}${t}`)))]})}),n.jsx(y,{children:n.jsx(w,{colorScheme:"blue",variant:"outline",mr:"1",onClick:c,children:p("close")})})]})]})},Wn=e=>{const{isOpen:s,onClose:c}=e,{t:d}=Os();return n.jsxs(t,{isOpen:s,onClose:c,size:"xl",scrollBehavior:"inside",children:[n.jsx(i,{}),n.jsxs(r,{children:[n.jsx(o,{children:d("header.download.termsAndConditions")}),n.jsx(a,{}),n.jsx(l,{children:n.jsxs(z,{children:[n.jsxs(S,{children:["The layout of the elements on the signage or rail map, is designed by"," ",n.jsxs(C,{color:"teal.500",href:"https://www.shmetro.com/",isExternal:!0,children:["Shanghai Shentong Metro Group ",n.jsx(k,{as:xe})]}),", ",n.jsxs(C,{color:"teal.500",href:"https://www.gzmtr.com/",isExternal:!0,children:["Guangzhou Metro Group ",n.jsx(k,{as:xe})]})," or ",n.jsxs(C,{color:"teal.500",href:"https://www.mtr.com.hk/",isExternal:!0,children:["MTR Corporation ",n.jsx(k,{as:xe})]}),", depending on your selection. You shall grant appropriate permit or license from the relevant company above before using the generated images for commercial purposes, if it is required to do so.",n.jsx("br",{}),"标志版或路线图的元素或布局，基于你所选择的风格，为",n.jsxs(C,{color:"teal.500",href:"https://www.shmetro.com/",isExternal:!0,children:["上海申通地铁集团 ",n.jsx(k,{as:xe})]}),"，",n.jsxs(C,{color:"teal.500",href:"https://www.gzmtr.com/",isExternal:!0,children:["广州地铁集团公司 ",n.jsx(k,{as:xe})]}),"或",n.jsxs(C,{color:"teal.500",href:"https://www.mtr.com.hk/",isExternal:!0,children:["港铁公司 ",n.jsx(k,{as:xe})]}),"所设计。在产生的图像用作商业用途前，你应向相关公司取得适当之许可证或授权。"]}),n.jsxs(S,{children:["The elements including shapes and lines on the image are drawn by"," ",n.jsxs(C,{color:"teal.500",href:"https://www.github.com/thekingofcity",isExternal:!0,children:["thekingofcity ",n.jsx(k,{as:xe})]})," and ",n.jsxs(C,{color:"teal.500",href:"https://www.github.com/wongchito",isExternal:!0,children:["Chito Wong ",n.jsx(k,{as:xe})]}),", based on the design standards or rules of the companies listed above. You may use them for any purposes, but it is recommended to state the name and the link of software alongside.",n.jsx("br",{}),"图像的元素，包括图形及线条，均由",n.jsxs(C,{color:"teal.500",href:"https://www.github.com/thekingofcity",isExternal:!0,children:["thekingofcity ",n.jsx(k,{as:xe})]}),"及",n.jsxs(C,{color:"teal.500",href:"https://www.github.com/wongchito",isExternal:!0,children:["Chito Wong ",n.jsx(k,{as:xe})]}),"基于上述公司设计标准或准则绘制。你可将其用于任何目的，但我们建议你于使用同时附以我们的名字以及本网站地址。"]}),n.jsxs(S,{children:["Due to copyright, licensing and other legal restrictions, Rail Map Painter uses"," ",n.jsxs(C,{color:"teal.500",href:"https://github.com/ButTaiwan/genyo-font",isExternal:!0,children:["GenYoMin provided by ButTaiwan ",n.jsx(k,{as:xe})]}),", and Vegur instead of MTRSung and Myriad Pro respectively to display and generate MTR-style signage. You shall grant appropriate permit or license from the manufacturers before using those generated images for commercial purposes.",n.jsx("br",{}),"由于著作权及其他法律限制，铁路路线图绘制器使用由",n.jsxs(C,{color:"teal.500",href:"https://github.com/ButTaiwan/genyo-font",isExternal:!0,children:["ButTaiwan提供的源樣明體 ",n.jsx(k,{as:xe})]}),"，以及Vegur，以代替港铁样式标志牌所使用的地铁宋及Myriad Pro。在产生之图像用作商业用途前，你应向字型生产厂商取得适当之许可证或授权。"]}),n.jsxs(S,{children:["The exported images in PNG or SVG format may be modified, published, or used for other purposes except commercial use, under the conditions above.",n.jsx("br",{}),"输出的PNG或SVG图像可基于上述条款，在非商业使用时，用于修改、发行或其他用途。"]}),n.jsxs(S,{children:["All flag emojis shown on Windows platforms are designed by"," ",n.jsxs(C,{color:"teal.500",href:"https://openmoji.org/",isExternal:!0,children:["OpenMoji ",n.jsx(k,{as:xe})]})," ","– the open-source emoji and icon project. License:",n.jsxs(C,{color:"teal.500",href:"https://creativecommons.org/licenses/by-sa/4.0/",isExternal:!0,children:["CC BY-SA 4.0 ",n.jsx(k,{as:xe})]}),n.jsx("br",{}),"于Windows作业系统上显示的国旗Emoji为",n.jsxs(C,{color:"teal.500",href:"https://openmoji.org/",isExternal:!0,children:["OpenMoji ",n.jsx(k,{as:xe})]}),"所设计。许可证：",n.jsxs(C,{color:"teal.500",href:"https://creativecommons.org/licenses/by-sa/4.0/",isExternal:!0,children:["CC BY-SA 4.0 ",n.jsx(k,{as:xe})]})]}),n.jsxs(S,{children:["We reserve the rights, without prior notice, to modify, add, or remove these terms. The Chinese translation is for reference only. In case of any discrepancy between the English version and the Chinese version, the English version shall prevail.",n.jsx("br",{}),"我们保留修改、新增或移除上述条款之权利，而无需另行通知。中文译本仅供参考，文义如与英文有歧异，概以英文本为准。"]})]})})]})]})};function Tn(){const e=O("white","var(--chakra-colors-gray-800)"),s=pe(),{telemetry:{project:c}}=ge((e=>e.app)),d=ge((e=>e.param)),u=te.isAllowAnalytics(),{t:x}=Os(),p=Ms.useRef(window.graph),[g,m]=Ms.useState("png"),j={png:x("header.download.png"),svg:x("header.download.svg")},[f,b]=Ms.useState(2),[v,z]=Ms.useState({width:1,height:1,benchmark:.001}),[S,T]=Ms.useState(200),I=[10,25,33,50,67,75,100,125,150,175,200,250,300,400,500,750,1e3],L=Object.fromEntries(I.map((e=>[e,`${e}%`]))),[P,B]=Ms.useState([]),[Z,G]=Ms.useState(!1),D=[{type:"select",label:x("header.download.format"),value:g,options:j,onChange:e=>m("png"===e?"png":"svg")}],U=[{type:"select",label:x("header.download.svgVersion"),value:f,options:{1.1:x("header.download.svg1.1"),2:x("header.download.svg2")},onChange:e=>{b(e),1.1===e&&X(!0)}}],K=[{type:"select",label:x("header.download.scale"),value:S,options:L,disabledOptions:P,onChange:e=>T(e)},{type:"switch",label:x("header.download.transparent"),isChecked:Z,onChange:G}],[Y,V]=Ms.useState(!1),[F,q]=Ms.useState(!1),[J,X]=Ms.useState(!1),[Q,$]=Ms.useState(!1),[ee,se]=Ms.useState(!1),[ne,re]=Ms.useState(!1);return Ms.useEffect((()=>{(async()=>{const e=await Xs.maxArea({usePromise:!0,useWorker:!0});z(e)})()}),[]),Ms.useEffect((()=>{if(Y){const{xMin:e,yMin:s,xMax:n,yMax:t}=me(p.current),[i,r]=[n-e,t-s],o=I.filter((e=>i*e/100>v.width&&r*e/100>v.height));B(o)}}),[Y]),n.jsxs(M,{id:"download",children:[n.jsx(_,{as:E,size:"sm",variant:"ghost",icon:n.jsx(ue,{})}),n.jsxs(A,{children:[n.jsx(N,{icon:n.jsx(je,{}),onClick:()=>{u&&te.event(ie.DOWNLOAD_PARAM,c?{"#nodes":p.current.order,"#edges":p.current.size}:{}),Ns(`RMP_${(new Date).valueOf()}.json`,"application/json",ye(d))},children:x("header.download.config")}),n.jsxs(N,{icon:n.jsx(fe,{}),onClick:()=>re(!0),children:[x("header.download.2rmg.title"),n.jsx(H,{ml:"1",colorScheme:"green",children:"New"})]}),n.jsx(N,{icon:n.jsx(be,{}),onClick:()=>V(!0),children:x("header.download.image")})]}),n.jsxs(t,{size:"xl",isOpen:Y,onClose:()=>V(!1),children:[n.jsx(i,{}),n.jsxs(r,{children:[n.jsx(o,{children:x("header.download.image")}),n.jsx(a,{}),n.jsxs(l,{children:[n.jsx(we,{fields:D}),"svg"===g&&n.jsx(we,{fields:U}),"png"===g&&n.jsx(we,{fields:K}),"png"===g&&P.length>0&&n.jsxs(n.Fragment,{children:[n.jsx(h,{as:"i",fontSize:"sm",children:x("header.download.disabledScaleOptions")}),n.jsx("br",{}),n.jsx(h,{as:"i",fontSize:"sm",children:x("header.download.disabledScaleOptionsWorkarounds")}),n.jsxs(C,{color:"teal.500",onClick:()=>window.open("https://github.com/RazrFalcon/resvg","_blank"),children:["RazrFalcon/resvg ",n.jsx(k,{as:xe})]}),n.jsx("br",{})]}),n.jsx("br",{}),n.jsx(R,{isChecked:J,isDisabled:"svg"===g&&1.1===f,onChange:e=>X(e.target.checked),children:n.jsx(h,{children:x("header.download.useSystemFonts")})}),n.jsx(R,{isChecked:Q,onChange:e=>$(e.target.checked),children:n.jsxs(h,{children:[x("header.download.shareInfo1"),n.jsxs(C,{color:"teal.500",onClick:()=>window.open("https://railmapgen.github.io/rmp","_blank"),children:[x("header.about.rmp")," ",n.jsx(k,{as:xe})]}),x("header.download.shareInfo2")]})}),n.jsx(R,{isChecked:ee,onChange:e=>se(e.target.checked),children:n.jsxs(h,{children:[x("header.download.termsAndConditionsInfo"),n.jsxs(C,{color:"teal.500",onClick:()=>q(!0),children:[x("header.download.termsAndConditions")," ",n.jsx(k,{as:xe})]}),x("header.download.period")]})})]}),n.jsx(y,{children:n.jsx(W,{children:n.jsx(w,{colorScheme:"teal",variant:"outline",size:"sm",isDisabled:!ee||"png"===g&&P.includes(S),onClick:async()=>{V(!1),u&&te.event(ie.DOWNLOAD_IMAGES,c?{numberOfNodes:p.current.order,numberOfEdges:p.current.size}:{});const{elem:n,width:t,height:i}=await Hs(p.current,Q,J,f),r=n.outerHTML.replace(/&nbsp;/g," ");if("svg"===g)return void Ns(`RMP_${(new Date).valueOf()}.svg`,"image/svg+xml",r);document.body.appendChild(n);const o="data:image/svg+xml;base64,"+btoa(unescape(encodeURIComponent(r)));document.body.removeChild(n),n.remove();const a=document.createElement("canvas"),[l,d]=[t*S/100,i*S/100];a.width=l,a.height=d;const h=a.getContext("2d");Z||(h.fillStyle=e,h.fillRect(0,0,l,d));const m=new Image;m.onload=()=>{setTimeout((()=>{h.drawImage(m,0,0,l,d),a.toBlob((e=>{e?Rs(`RMP_${(new Date).valueOf()}.png`,e):s(ve({status:"error",message:x("header.download.imageTooBig")}))}),"image/png")}),Ws()?2e3:0)},m.src=o},children:x("header.download.confirm")})})}),n.jsx(Wn,{isOpen:F,onClose:()=>q(!1)})]})]}),n.jsx(Hn,{isOpen:ne,onClose:()=>re(!1)})]})}const In=(e,{info_panel_type:s,line_num:n,stn_list:t,style:i,theme:r},o)=>{const a=Object.fromEntries(Object.keys(t).filter((e=>!["linestart","lineend"].includes(e))).map((e=>[e,`stn_${le(10)}`])));Object.entries(t).filter((([e,s])=>!["linestart","lineend"].includes(e))).forEach((([s,n])=>{const t=e.filterNodes(((e,s)=>Object.values(de).includes(s.type)&&s[s.type].names[0]===n.localisedName.zh));0!==t.length&&(a[s]=t[0])})),Object.entries(t).filter((([e,s])=>!["linestart","lineend"].includes(e))).filter((([s,n])=>0===e.filterNodes(((e,s)=>Object.values(de).includes(s.type)&&s[s.type].names[0]===n.localisedName.zh)).length)).forEach((([t,o],l)=>{var c,d;let h=de.ShmetroBasic;const u=o.transfer.groups,x=u.map((e=>{var s;return null!==(s=e.lines)&&void 0!==s?s:[]})).flat();i===sn.SHMetro?h=x.length>0?de.ShmetroInt:s===nn.sh2020?de.ShmetroBasic2020:de.ShmetroBasic:i===sn.GZMTR?h=x.length>0?de.GzmtrInt:de.GzmtrBasic:i===sn.MTR&&(h=de.MTR);const p={...structuredClone(Ts[h].defaultAttrs),names:[null!==(c=o.localisedName.zh)&&void 0!==c?c:"",null!==(d=o.localisedName.en)&&void 0!==d?d:""]};if(h===de.ShmetroBasic2020)p.color=r;else if(h===de.GzmtrBasic)p.color=r,p.lineCode=n,p.stationCode=o.num;else if(h===de.GzmtrInt)p.transfer=u.map(((e,s)=>{var t,i;const a=null!==(t=null===(i=e.lines)||void 0===i?void 0:i.map((e=>{var s;return[...null!==(s=e.theme)&&void 0!==s?s:r,"1","01"]})))&&void 0!==t?t:[];return 0===s?[[...r,n,o.num],...a]:a}));else if(h===de.MTR){var g;null!==(g=u[0].lines)&&void 0!==g&&g.length?p.transfer=[[[...r,"",""],...u[0].lines.map((e=>{var s;return[...null!==(s=e.theme)&&void 0!==s?s:r,"",""]}))]]:p.transfer=[[]]}e.addNode(a[t],{visible:!0,zIndex:0,x:100+50*l,y:1e3,type:h,[h]:p})})),Object.entries(t).filter((([e,s])=>!["linestart","lineend"].includes(e))).forEach((([s,n])=>{n.children.filter((e=>!["linestart","lineend"].includes(e))).forEach((n=>{const t=ze.Diagonal,[i,l]=[a[s],a[n]],c=o?Se(e,t,i,l,"from"):-1;e.addDirectedEdgeWithKey(`line_${le(10)}`,i,l,{visible:!0,zIndex:0,type:t,[ze.Diagonal]:structuredClone(Ce[ze.Diagonal].defaultAttrs),style:ke.SingleColor,[ke.SingleColor]:{color:r},reconcileId:"",parallelIndex:c})}))}))},Ln="rmg-bridge--",Pn={h:500,maxH:"70%","& iframe":{h:"100%",w:"100%"}};function Bn(e){const{isOpen:s,onClose:t,onImport:i}=e,[r]=_s.useState(crypto.randomUUID()),o="/rmg/#/import?"+new URLSearchParams({parentComponent:te.getAppName(),parentId:r});return _s.useEffect((()=>{const e=new BroadcastChannel(Ln+r);return e.onmessage=e=>{const{event:s,data:n}=e.data;console.log("[rmp] Received event from RMG app clip:",s),"CLOSE"===s?t():"IMPORT"===s&&i(n)},()=>e.close()}),[]),n.jsx(Oe,{isOpen:s,onClose:t,sx:Pn,children:n.jsx("iframe",{src:o,loading:"lazy"})})}const Zn="OPEN_TEMPLATE",Gn=new BroadcastChannel("RMP_GALLERY_CHANNEL"),Dn={h:"80%",w:"80%","& iframe":{h:"100%",w:"100%"},"& div":{h:"100%",w:"100%"}};function Un(e){const{isOpen:s,onClose:t}=e,i=T(),{t:r}=Os(),o=pe(),{telemetry:{project:a}}=ge((e=>e.app)),l=te.isAllowAnalytics(),c=Ms.useRef(window.graph),d=Ms.useCallback((()=>{o(Me()),o(_e()),o(Ee(c.current.export()))}),[o,Me,_e,Ee,c]),h=async(e,s)=>{var n;const t=s?`https://${s}`:"",h=await(null===(n=(await Promise.allSettled([fetch(`${t}/rmp-gallery/resources/real_world/${e}.json`),fetch(`${t}/rmp-gallery/resources/fantasy/${e}.json`)])).filter((e=>"fulfilled"===e.status)).find((e=>200===e.value.status)))||void 0===n?void 0:n.value.json());if(h){if(l){const n={id:e};a&&s&&(n.host=s),te.event(ie.IMPORT_WORK_FROM_GALLERY,n)}(async e=>{const{version:s,...n}=JSON.parse(await Ae(JSON.stringify(e)));o(Ne()),c.current.clear(),c.current.import(n.graph),d();const{svgViewBoxZoom:t,svgViewBoxMin:i}=n;"number"==typeof t&&o(He(t)),"number"==typeof i.x&&"number"==typeof i.y&&o(Re(i))})(h),i({title:r("header.open.importFromRMPGallery",{id:e}),status:"success",duration:9e3,isClosable:!0})}else i({title:r("header.open.failToImportFromRMPGallery",{id:e}),status:"error",duration:9e3,isClosable:!0})};return Ms.useEffect((()=>{const e=new URL(window.location.href).searchParams;if(e.size>0){const s=e.keys().next().value,n=s.indexOf("."),t=s.substring(0,-1===n?void 0:n);let i;-1!==n&&(i=s.substring(n+1)),h(t,i)}}),[]),Ms.useEffect((()=>(Gn.onmessage=e=>{const{event:s,data:n}=e.data;s===Zn&&(h(n),t())},()=>Gn.close())),[]),n.jsxs(Oe,{isOpen:s,onClose:t,size:"full",sx:Dn,children:[n.jsx("iframe",{src:"/rmp-gallery/",loading:"lazy"}),n.jsx(I,{onClick:t,position:"fixed",top:"5px",right:"15px"})]})}function Kn(){const{t:e}=Os(),s=pe(),{preference:{autoParallel:t}}=ge((e=>e.app)),i=te.isAllowAnalytics(),r=Ms.useRef(window.graph),o=Ms.useRef(null),[a,l]=Ms.useState(!1),[c,d]=Ms.useState(!1),h=Ms.useCallback((()=>{s(Me()),s(_e()),s(Ee(r.current.export()))}),[s,Me,_e,Ee,r]),u=async e=>{const{version:n,...t}=JSON.parse(await Ae(e));s(Ne()),r.current.clear(),r.current.import(t.graph),h();const{svgViewBoxZoom:i,svgViewBoxMin:o}=t;"number"==typeof i&&s(He(i)),"number"==typeof o.x&&"number"==typeof o.y&&s(Re(o))};Ms.useEffect((()=>{const e=async e=>{const{type:s,key:n,from:t}=e.data;if(s===Ge.SAVE_CHANGED&&n===De.PARAM&&"rmt"===t){Ue.debug(`Received save changed event on key: ${n}`);const e=localStorage.getItem(De.PARAM);if(!e)return;await u(e)}};return We.addEventListener("message",e),()=>We.removeEventListener("message",e)}),[]);const x=Is(),{height:p}=Te(x);return n.jsxs(M,{children:[n.jsx(_,{as:E,size:"sm",variant:"ghost",icon:n.jsx(Ie,{})}),n.jsxs(A,{children:[n.jsx(N,{icon:n.jsx(Le,{}),onClick:()=>{s(Ne()),r.current.clear(),s(He(100)),s(Re({x:0,y:0})),h()},children:e("header.open.new")}),n.jsx("input",{id:"upload_project",ref:o,type:"file",accept:".json",hidden:!0,onChange:async n=>{var t;const i=null===(t=n.target.files)||void 0===t?void 0:t[0];if(console.log("OpenActions.handleUpload():: received file",i),"application/json"!==(null==i?void 0:i.type))s(ve({status:"error",message:e("header.open.invalidType")})),console.error("OpenActions.handleUpload():: Invalid file type! Only file in JSON format is accepted.");else try{const e=await Yn(i);await u(e)}catch(r){s(ve({status:"error",message:e("header.open.unknownError")})),console.error("OpenActions.handleUpload():: Unknown error occurred while parsing the uploaded file",r)}n.target.value=""},"data-testid":"file-upload"}),n.jsx(N,{icon:n.jsx(Ie,{}),onClick:()=>{var e;return null==o||null===(e=o.current)||void 0===e?void 0:e.click()},children:e("header.open.config")}),n.jsx(N,{icon:n.jsx(Pe,{}),onClick:()=>l(!0),children:e("header.open.projectRMG")}),n.jsxs(N,{icon:n.jsx(xe,{}),onClick:()=>d(!0),children:[e("header.open.gallery"),n.jsx(H,{ml:"1",colorScheme:"green",children:"New"})]}),n.jsx(N,{icon:n.jsx(Be,{}),onClick:async()=>{await u(await Ze()),s(Re({x:-10,y:-13}));const e=Math.max(0,Math.min(400,-.132*p+117.772));s(He(e)),te.event(ie.LOAD_TUTORIAL,{})},children:e("header.open.tutorial")})]}),n.jsx(Bn,{isOpen:a,onClose:()=>l(!1),onImport:n=>{try{i&&te.event(ie.IMPORT_RMG_PARAM,{}),In(r.current,n,t),h()}catch(o){s(ve({status:"error",message:e("header.open.unknownError")})),console.error("OpenActions.handleUploadRMG():: Unknown error occurred while parsing the RMG project",o)}finally{l(!1)}}}),n.jsx(Un,{isOpen:c,onClose:()=>d(!1)})]})}const Yn=e=>new Promise((s=>{const n=new FileReader;n.onloadend=()=>s(n.result),n.readAsText(e)})),Vn=()=>{const[e,s]=Ms.useState(!1),{t:t}=Os(),i=pe(),r=Ms.useRef(window.graph),o=Is(),{width:a,height:l}=Te(o),[c,d]=Ms.useState([]);return Ms.useEffect((()=>{e&&d(r.current.nodes().filter((e=>e.startsWith("stn"))).map((e=>{const s=r.current.getNodeAttributes(e);return{id:e,value:s[s.type].names.join("/")}})))}),[e]),n.jsxs(L,{isOpen:e,onOpen:()=>s(!0),onClose:()=>s(!1),children:[n.jsx(P,{children:n.jsx(E,{"aria-label":"zoom",variant:"ghost",size:"sm",icon:n.jsx(Ke,{}),onClick:()=>s(!e)})}),n.jsx(B,{children:n.jsx(Z,{children:n.jsx(Ye,{label:t("header.search"),children:n.jsx(Ve,{data:c,displayHandler:e=>n.jsx(H,{children:e.value}),filter:(e,s)=>s.value.toLowerCase().includes(e.toLowerCase())||Object.values(s.value).some((s=>s.toLowerCase().includes(e.toLowerCase()))),value:"",onChange:e=>(e=>{i(Fe(new Set([e])));const s=Math.max(0,Math.min(400,-.132*l+117.772)),{x:n,y:t}=qe((a-300)/2,l/2,s,{x:-r.current.getNodeAttribute(e,"x"),y:-r.current.getNodeAttribute(e,"y")});i(He(s)),i(Re({x:-n,y:-t}))})(e.id)})})})})]})},Fn=e=>{const{isOpen:s,onClose:c}=e,d=pe(),{theme:h,paletteAppClip:{output:u}}=ge((e=>e.runtime)),{t:x}=Os(),p=Ms.useRef(window.graph),[g,m]=Ms.useState(h),[j,f]=Ms.useState(!1);return Ms.useEffect((()=>{j&&u&&(m(u),f(!1))}),[null==u?void 0:u.toString()]),n.jsxs(t,{isOpen:s,onClose:c,size:"xl",scrollBehavior:"inside",trapFocus:!1,children:[n.jsx(i,{}),n.jsxs(r,{children:[n.jsx(o,{children:x("header.settings.procedures.removeLines.title")}),n.jsx(a,{}),n.jsxs(l,{children:[x("header.settings.procedures.removeLines.content"),n.jsx(Je,{theme:g,onClick:()=>{f(!0),d(Xe(g))}})]}),n.jsxs(y,{children:[n.jsx(w,{colorScheme:"blue",variant:"outline",mr:"1",onClick:c,children:x("cancel")}),n.jsx(w,{colorScheme:"red",onClick:()=>{p.current.filterEdges(((e,s,n,t,i,r,o)=>ce.includes(s.style)&&JSON.stringify(s[s.style].color)===JSON.stringify(g))).forEach((e=>p.current.dropEdge(e))),d(_e()),d(Ee(p.current.export())),c()},children:x("remove")})]})]})]})},qn=e=>{const{isOpen:s,onClose:c}=e,d=pe(),{t:h}=Os(),u=Ms.useRef(window.graph),[x,p]=Ms.useState(1),g=[{type:"input",label:h("header.settings.procedures.scale.factor"),value:x.toString(),variant:"number",onChange:e=>p(Number(e)),minW:"full"}];return n.jsxs(t,{isOpen:s,onClose:c,size:"xl",scrollBehavior:"inside",children:[n.jsx(i,{}),n.jsxs(r,{children:[n.jsx(o,{children:h("header.settings.procedures.scale.title")}),n.jsx(a,{}),n.jsxs(l,{children:[h("header.settings.procedures.scale.content"),n.jsx(we,{fields:g})]}),n.jsxs(y,{children:[n.jsx(w,{colorScheme:"blue",variant:"outline",mr:"1",onClick:c,children:h("cancel")}),n.jsx(w,{colorScheme:"red",onClick:()=>{u.current.forEachNode(((e,s)=>{u.current.updateNodeAttribute(e,"x",(e=>(null!=e?e:0)*x)),u.current.updateNodeAttribute(e,"y",(e=>(null!=e?e:0)*x))})),d(Me()),d(_e()),d(Ee(u.current.export())),c()},children:h("apply")})]})]})]})},Jn=e=>{const{isOpen:s,onClose:c}=e,d=pe(),{t:h}=Os(),u=Ms.useRef(window.graph),[x,p]=Ms.useState(0),[g,m]=Ms.useState(0),j=[{type:"input",label:h("header.settings.procedures.translate.x"),value:x.toString(),variant:"number",onChange:e=>p(Number(e)),minW:"full"},{type:"input",label:h("header.settings.procedures.translate.y"),value:g.toString(),variant:"number",onChange:e=>m(Number(e)),minW:"full"}];return n.jsxs(t,{isOpen:s,onClose:c,size:"xl",scrollBehavior:"inside",children:[n.jsx(i,{}),n.jsxs(r,{children:[n.jsx(o,{children:h("header.settings.procedures.translate.title")}),n.jsx(a,{}),n.jsxs(l,{children:[h("header.settings.procedures.translate.content"),n.jsx(we,{fields:j})]}),n.jsxs(y,{children:[n.jsx(w,{colorScheme:"blue",variant:"outline",mr:"1",onClick:c,children:h("cancel")}),n.jsx(w,{colorScheme:"red",onClick:()=>{u.current.forEachNode(((e,s)=>{u.current.updateNodeAttribute(e,"x",(e=>(null!=e?e:0)+x)),u.current.updateNodeAttribute(e,"y",(e=>(null!=e?e:0)+g))})),d(Me()),d(_e()),d(Ee(u.current.export())),c()},children:h("apply")})]})]})]})},Xn=e=>{const{isOpen:s,onClose:c}=e,d=pe(),{preference:{unlockSimplePathAttempts:u}}=ge((e=>e.app)),{activeSubscriptions:x}=ge((e=>e.account)),{t:p}=Os();return n.jsxs(t,{isOpen:s,onClose:c,size:"5xl",scrollBehavior:"inside",children:[n.jsx(i,{}),n.jsxs(r,{children:[n.jsx(o,{children:p("header.settings.procedures.unlockSimplePath.title")}),n.jsx(a,{}),n.jsxs(l,{children:[n.jsx(h,{mb:"2",children:p("header.settings.procedures.unlockSimplePath.content1")}),n.jsx(h,{mb:"2",children:p("header.settings.procedures.unlockSimplePath.content2")}),n.jsx(h,{mb:"2",children:p("header.settings.procedures.unlockSimplePath.content3")})]}),n.jsx(y,{children:n.jsx(G,{label:p("header.settings.pro"),isOpen:!x.RMP_CLOUD&&u>=0,children:n.jsx(w,{onClick:()=>{d(Qe(-1))},isDisabled:!x.RMP_CLOUD||u<0,children:p(u>=0?"header.settings.procedures.unlockSimplePath.check":"header.settings.procedures.unlockSimplePath.unlocked")})})})]})]})},Qn=e=>{const{isOpen:s,onClose:c}=e,d=pe(),u=T(),{t:x}=Os(),p=Ms.useRef(window.graph),[g,m]=Ms.useState(!1);return n.jsxs(t,{isOpen:s,onClose:c,size:"xl",scrollBehavior:"inside",children:[n.jsx(i,{}),n.jsxs(r,{children:[n.jsx(o,{children:x("header.settings.procedures.updateColor.title")}),n.jsx(a,{}),n.jsx(l,{children:n.jsx(h,{children:x("header.settings.procedures.updateColor.content")})}),n.jsxs(y,{children:[n.jsx(w,{colorScheme:"blue",variant:"outline",mr:"1",onClick:c,children:x("cancel")}),n.jsx(w,{colorScheme:"red",onClick:async()=>{m(!0);const e=JSON.stringify(p.current.export());try{const s=await st(e);p.current.clear(),p.current.import(s),d(Me()),d(_e()),d(Ee(p.current.export())),u({title:x("header.settings.procedures.updateColor.success"),status:"success",duration:9e3,isClosable:!0})}catch(s){console.error(`[rmp] Error in updating all colors: ${s}`),u({title:x("header.settings.procedures.updateColor.error",{e:s}),status:"error",duration:9e3,isClosable:!0})}m(!1),c()},isLoading:g,children:x("apply")})]})]})]})},$n=e=>e.length>=4&&e.every((e=>"string"==typeof e))&&!!e[2].match(/^#[0-9a-fA-F]{6}$/)&&Object.values(ae).includes(e[3]),et=(e,s,n)=>{const t=s.split(".");let i=e;for(let r=0;r<t.length-1;r++)i=i[t[r]];i[t[t.length-1]]=n},st=async e=>{const s=JSON.parse(e),n=(new Date).getTime(),t=(e=>{const s=[],n=(e,t)=>{if(Array.isArray(e)&&$n(e))s.push({path:t||"",value:e});else for(const i in e){const r=e[i],o=t?`${t}.${i}`:i;Array.isArray(r)?$n(r)?s.push({path:o,value:r}):r.forEach(((e,s)=>n(e,`${o}.${s}`))):r&&"object"==typeof r&&n(r,o)}};return n(e),s})(s);console.log("[rmp] Found all themes pending for update",t);let i,r=!1;const o=new Promise(((e,n)=>{i=setTimeout((()=>{r=!0,n("Executing time exceeds 10000ms")}),1e4),(async()=>{for(const{path:e,value:n}of t){if(r)throw new Error("Update aborted");const[t,i,o,a,...l]=n,c=await $e([t,i,o,a]);et(s,e,[...c,...l])}})().then(e).catch(n)}));try{return await o,console.log(`[rmp] Themes update completed, elapsed time ${((new Date).getTime()-n)/1e3} sec`),s}finally{clearTimeout(i)}},nt=()=>{const{state:e}=ge((e=>e.account)),{t:s}=Os(),[t,i]=Ms.useState(!1),[r,o]=Ms.useState(1);Ms.useEffect((()=>{let e;return t&&r>0?e=window.setTimeout((()=>{o(r-1)}),1e3):0===r&&i(!1),()=>clearTimeout(e)}),[t,r]);const a={"logged-out":s("header.settings.subscription.logged-out"),free:s("header.settings.subscription.free"),subscriber:s("header.settings.subscription.subscriber"),expired:s("header.settings.subscription.expired")};return n.jsxs(u,{width:"100%",mb:"3",children:[n.jsx(h,{as:"b",fontSize:"xl",children:s("header.settings.subscription.title")}),n.jsx(u,{mt:"3",children:n.jsxs(u,{display:"flex",mb:"1",children:[n.jsx(h,{flex:"1",children:a[e]}),n.jsx(E,{"aria-label":"refresh",variant:"ghost",size:"sm",icon:n.jsx(es,{}),isDisabled:t,onClick:()=>(i(!0),o(1),void ss())})]})})]})},tt={width:"100%",justifyContent:"space-between"},it={fontFamily:"-apple-system"},rt=e=>{const{isOpen:s,onClose:c}=e,{activeSubscriptions:d}=ge((e=>e.account)),{telemetry:{project:x},preference:{autoParallel:g}}=ge((e=>e.app)),{keepLastPath:m,parallelLinesCount:j}=ge((e=>e.runtime)),f=pe(),{t:b}=Os(),y=O("primary.500","primary.300"),[v,z]=Ms.useState(!1),[S,M]=Ms.useState(!1),[_,E]=Ms.useState(!1),[A,N]=Ms.useState(!1),[R,W]=Ms.useState(!1),[T,I]=Ms.useState(!1),[L,P]=Ms.useState(!1),B=te.isAllowAnalytics(),Z=j>=(d.RMP_CLOUD?ns:ts);return n.jsxs(t,{isOpen:s,onClose:c,size:"xl",scrollBehavior:"inside",trapFocus:!1,children:[n.jsx(i,{}),n.jsxs(r,{children:[n.jsx(o,{children:b("header.settings.title")}),n.jsx(a,{}),n.jsx(l,{children:n.jsxs(p,{divider:n.jsx(D,{borderColor:"gray.200"}),children:[n.jsx(nt,{}),n.jsxs(u,{width:"100%",mb:"3",children:[n.jsx(h,{as:"b",fontSize:"xl",children:b("header.settings.preference.title")}),n.jsxs(u,{mt:"3",children:[n.jsxs(u,{display:"flex",mb:"1",children:[n.jsx(h,{flex:"1",children:b("header.settings.preference.keepLastPath")}),n.jsx(U,{isChecked:m,onChange:({target:{checked:e}})=>f(is(e))})]}),n.jsxs(u,{display:"flex",mb:"1",children:[n.jsx(h,{children:b("header.settings.preference.autoParallel")}),n.jsx(H,{ml:"1",colorScheme:"green",children:"New"}),n.jsx(G,{label:b("header.settings.proWithTrial"),children:n.jsx(H,{ml:"1",color:"gray.50",background:"radial-gradient(circle, #3f5efb, #fc466b)",mr:"auto",children:"PRO"})}),n.jsx(U,{isDisabled:Z,isChecked:g,onChange:({target:{checked:e}})=>f(rs(e))})]})]})]}),n.jsxs(u,{width:"100%",mb:"3",children:[n.jsx(h,{as:"b",fontSize:"xl",children:b("header.settings.procedures.title")}),n.jsxs(u,{mt:"3",children:[n.jsx(w,{sx:tt,rightIcon:n.jsx(os,{}),onClick:()=>z(!0),children:b("header.settings.procedures.translate.title")}),n.jsx(Jn,{isOpen:v,onClose:()=>z(!1)}),n.jsx(w,{sx:tt,rightIcon:n.jsx(os,{}),onClick:()=>M(!0),children:b("header.settings.procedures.scale.title")}),n.jsx(qn,{isOpen:S,onClose:()=>M(!1)}),n.jsxs(w,{sx:tt,rightIcon:n.jsx(os,{}),onClick:()=>E(!0),children:[b("header.settings.procedures.changeType.title"),n.jsx(G,{label:b("header.settings.pro"),children:n.jsx(H,{ml:"1",color:"gray.50",background:"radial-gradient(circle, #3f5efb, #fc466b)",mr:"auto",children:"PRO"})})]}),n.jsx(Ps,{isOpen:_,onClose:()=>E(!1),isSelect:!1}),n.jsx(w,{sx:tt,rightIcon:n.jsx(os,{}),onClick:()=>N(!0),children:b("header.settings.procedures.removeLines.title")}),n.jsx(Fn,{isOpen:A,onClose:()=>N(!1)}),n.jsx(w,{sx:tt,rightIcon:n.jsx(os,{}),onClick:()=>W(!0),children:b("header.settings.procedures.updateColor.title")}),n.jsx(Qn,{isOpen:R,onClose:()=>W(!1)}),n.jsxs(w,{sx:tt,rightIcon:n.jsx(os,{}),onClick:()=>I(!0),children:[b("header.settings.procedures.unlockSimplePath.title"),n.jsx(G,{label:b("header.settings.pro"),children:n.jsx(H,{ml:"1",color:"gray.50",background:"radial-gradient(circle, #3f5efb, #fc466b)",mr:"auto",children:"PRO"})})]}),n.jsx(Xn,{isOpen:T,onClose:()=>I(!1)}),n.jsx(w,{sx:tt,rightIcon:n.jsx(os,{}),onClick:()=>P(!0),children:b("header.settings.procedures.masterManager.title")}),n.jsx(Ls,{isOpen:L,onClose:()=>P(!1)})]})]}),n.jsxs(u,{width:"100%",mb:"3",children:[n.jsx(h,{as:"b",fontSize:"xl",children:b("header.settings.shortcuts.title")}),n.jsx(u,{mt:"3",children:n.jsxs(K,{children:[n.jsx(Y,{children:n.jsxs(V,{children:[n.jsx(F,{children:b("header.settings.shortcuts.keys")}),n.jsx(F,{children:b("header.settings.shortcuts.description")})]})}),n.jsxs(q,{children:[n.jsxs(V,{children:[n.jsx(J,{children:n.jsx(X,{children:"f"})}),n.jsx(J,{children:b("header.settings.shortcuts.f")})]}),n.jsxs(V,{children:[n.jsx(J,{children:n.jsx(X,{children:"s"})}),n.jsx(J,{children:b("header.settings.shortcuts.s")})]}),n.jsxs(V,{children:[n.jsx(J,{children:n.jsxs(u,{display:"flex",flexDirection:"row",children:[n.jsx(as,{}),n.jsx(ls,{}),n.jsx(cs,{}),n.jsx(ds,{})]})}),n.jsx(J,{children:b("header.settings.shortcuts.arrows")})]}),n.jsxs(V,{children:[n.jsx(J,{children:n.jsxs(u,{display:"flex",flexDirection:"row",children:[n.jsx(X,{children:"i"}),n.jsx(X,{children:"j"}),n.jsx(X,{children:"k"}),n.jsx(X,{children:"l"})]})}),n.jsx(J,{children:b("header.settings.shortcuts.ijkl")})]}),n.jsxs(V,{children:[n.jsx(J,{children:hs?n.jsx(X,{sx:it,children:"⇧"}):n.jsx(X,{children:"shift"})}),n.jsx(J,{children:b("header.settings.shortcuts.shift")})]}),n.jsxs(V,{children:[n.jsx(J,{children:hs?n.jsx(X,{sx:it,children:"⌥"}):n.jsx(X,{children:"alt"})}),n.jsx(J,{children:b("header.settings.shortcuts.alt")})]}),n.jsxs(V,{children:[n.jsx(J,{children:hs?n.jsx(X,{sx:it,children:"⌫"}):n.jsx(X,{children:"delete"})}),n.jsx(J,{children:b("header.settings.shortcuts.delete")})]}),n.jsxs(V,{children:[n.jsxs(J,{children:[hs?n.jsx(X,{sx:it,children:"⌘"}):n.jsx(X,{children:"ctrl"})," + ",n.jsx(X,{children:"x"})]}),n.jsx(J,{children:b("header.settings.shortcuts.cut")})]}),n.jsxs(V,{children:[n.jsxs(J,{children:[hs?n.jsx(X,{sx:it,children:"⌘"}):n.jsx(X,{children:"ctrl"})," + ",n.jsx(X,{children:"c"})]}),n.jsx(J,{children:b("header.settings.shortcuts.copy")})]}),n.jsxs(V,{children:[n.jsxs(J,{children:[hs?n.jsx(X,{sx:it,children:"⌘"}):n.jsx(X,{children:"ctrl"})," + ",n.jsx(X,{children:"v"})]}),n.jsx(J,{children:b("header.settings.shortcuts.paste")})]}),n.jsxs(V,{children:[n.jsxs(J,{children:[hs?n.jsx(X,{sx:it,children:"⌘"}):n.jsx(X,{children:"ctrl"})," + ",n.jsx(X,{children:"z"})]}),n.jsx(J,{children:b("header.settings.shortcuts.undo")})]}),n.jsxs(V,{children:[n.jsx(J,{children:hs?n.jsxs(n.Fragment,{children:[n.jsx(X,{sx:it,children:"⇧"})," + ",n.jsx(X,{sx:it,children:"⌘"})," + ",n.jsx(X,{children:"z"})]}):n.jsxs(n.Fragment,{children:[n.jsx(X,{children:"ctrl"})," + ",n.jsx(X,{children:"y"})]})}),n.jsx(J,{children:b("header.settings.shortcuts.redo")})]})]})]})})]}),n.jsxs(u,{width:"100%",mb:"3",children:[n.jsx(h,{as:"b",fontSize:"xl",children:b("header.settings.telemetry.title")}),n.jsxs(u,{mt:"3",children:[n.jsx(h,{fontSize:"sm",lineHeight:"100%",color:"gray.600",children:b("header.settings.telemetry.info")}),n.jsxs(u,{mt:"3",mb:"1",children:[n.jsxs(u,{display:"flex",mb:"1",children:[n.jsx(h,{flex:"1",children:b("header.settings.telemetry.essential")}),n.jsx(G,{label:b("header.settings.telemetry.essentialTooltip"),children:n.jsx(U,{isChecked:B,isDisabled:!0})})]}),n.jsx(h,{fontSize:"sm",lineHeight:"100%",color:"gray.600",children:b("header.settings.telemetry.essentialInfo")}),n.jsxs(C,{color:y,fontSize:"sm",lineHeight:"100%",href:"https://support.google.com/analytics/answer/11593727",isExternal:!0,children:[b("header.settings.telemetry.essentialLink")," ",n.jsx(k,{as:xe})]})]}),n.jsxs(u,{mt:"1",mb:"1",children:[n.jsxs(u,{display:"flex",children:[n.jsx(h,{flex:"1",children:b("header.settings.telemetry.additional")}),n.jsx(U,{isChecked:x,onChange:({target:{checked:e}})=>{f(us(e))}})]}),n.jsx(h,{fontSize:"sm",lineHeight:"100%",color:"gray.600",children:b("header.settings.telemetry.additionalInfo")})]})]})]})]})})]})]})},ot=()=>{const[e,s]=Ms.useState(!1),{svgViewBoxZoom:t}=ge((e=>e.param)),i=pe(),r=[{type:"slider",label:"",value:400-t,min:10,max:390,step:1,onChange:e=>i(He(400-e)),leftIcon:n.jsx(ps,{}),rightIcon:n.jsx(xs,{}),minW:160}];return n.jsxs(L,{isOpen:e,onOpen:()=>s(!0),onClose:()=>s(!1),children:[n.jsx(P,{children:n.jsx(E,{"aria-label":"zoom",variant:"ghost",size:"sm",icon:n.jsx(xs,{}),onClick:()=>s(!e)})}),n.jsx(B,{children:n.jsx(Z,{children:n.jsx(we,{fields:r,noLabel:!0})})})]})};function at(){const{t:e}=Os(),t=pe(),{past:i,future:r}=ge((e=>e.param)),{isDonationModalOpen:o}=ge((e=>e.runtime)),a=te.isAllowAnalytics(),[l,c]=Ms.useState(!1),[d,h]=Ms.useState(!1),u=s(te.getEnv),p=s(te.getAppVersion);return Ms.useEffect((()=>{a&&u!==gs.DEV&&te.event(ie.APP_LOAD,{isStandaloneWindow:te.isStandaloneWindow()})}),[u]),n.jsxs(ms,{children:[n.jsx(x,{as:"h4",size:"md",whiteSpace:"nowrap",overflow:"hidden",textOverflow:"ellipsis",children:e("header.about.rmp")}),n.jsx(js,{environment:u,version:p,popoverHeader:u===gs.PRD?void 0:n.jsxs(Es,{i18nKey:"header.popoverHeader",environment:u,children:["You're on ",{environment:u}," environment!"]}),popoverBody:u===gs.PRD?void 0:n.jsx(Es,{i18nKey:"header.popoverBody",children:"This is a testing environment where we test the latest beta RMP."})}),n.jsxs(Q,{ml:"auto",children:[n.jsx($,{children:n.jsx(Vn,{})}),n.jsx($,{children:n.jsx(E,{size:"sm",variant:"ghost","aria-label":"Undo",icon:n.jsx(fs,{}),isDisabled:0===i.length,onClick:()=>{t(Ss()),t(Me()),t(_e())}})}),n.jsx($,{children:n.jsx(E,{size:"sm",variant:"ghost","aria-label":"Redo",icon:n.jsx(bs,{}),isDisabled:0===r.length,onClick:()=>{t(Cs()),t(Me()),t(_e())}})}),n.jsx($,{children:n.jsx(ot,{})}),n.jsx($,{children:n.jsx(Kn,{})}),n.jsx($,{children:n.jsx(Tn,{})}),te.isStandaloneWindow()&&n.jsx($,{children:n.jsxs(M,{children:[n.jsx(_,{as:E,icon:n.jsx(ws,{}),variant:"ghost",size:"sm"}),n.jsx(A,{children:["en","zh-Hans","zh-Hant","ja","ko"].map((e=>n.jsx(N,{onClick:()=>{return s=e,void te.getI18nInstance().changeLanguage(s);var s},children:Bs[e][e]},e)))})]})}),n.jsx($,{children:n.jsx(E,{size:"sm",variant:"ghost","aria-label":"Donation",color:"red",icon:n.jsx(As,{}),onClick:()=>t(ys(!0))})}),n.jsx($,{children:n.jsx(E,{size:"sm",variant:"ghost","aria-label":"Settings",icon:n.jsx(vs,{}),onClick:()=>c(!0)})}),n.jsx($,{children:n.jsx(E,{size:"sm",variant:"ghost","aria-label":"Help",icon:n.jsx(zs,{}),onClick:()=>h(!0)})})]}),n.jsx(Us,{isOpen:o,onClose:()=>t(ys(!1))}),n.jsx(rt,{isOpen:l,onClose:()=>c(!1)}),n.jsx(Zs,{isOpen:d,onClose:()=>h(!1)})]})}function lt(){const e=pe(),s=ge((e=>e.runtime.globalAlerts));return n.jsx(n.Fragment,{children:Object.entries(s).map((([s,{message:t,url:i,linkedApp:r}])=>n.jsxs(ee,{status:s,variant:"solid",size:"xs",pl:3,pr:1,py:0,zIndex:"1",children:[n.jsx(se,{}),r?n.jsx(C,{onClick:()=>(e=>{te.isStandaloneWindow()?window.open(`/${e}`,"_blank"):te.openApp({appId:e})})(r),children:t}):i?n.jsx(C,{href:i,target:"_blank",children:t}):t,n.jsx(I,{ml:"auto",onClick:()=>e(ks(s))})]},s)))})}}}}));
