System.register(["./chakra-legacy-zPaewjzV.js","./index-legacy-CN4-yVjr.js","./react-legacy-CLSeZSow.js","./clipboard-legacy-BYZht1xo.js","./stations-legacy-oEUaxAfI.js","./change-type-modal-legacy-CLAuXZ7r.js","./tools-legacy-YTRafzqu.js","./misc-nodes-legacy-CtxjXei6.js","./graph-legacy-mdZl22O6.js","./index-legacy-jv8eAHeF.js"],(function(e,t){"use strict";var n,i,s,r,a,l,d,o,c,u,p,h,g,m,x,j,f,b,y,w,v,N,A,S,C,E,z,k,W,O,T,R,P,_,I,D,F,L,U,M,V,$,B,H,K,q,G,J,Q,X;return{setters:[e=>{n=e.j,i=e.B,s=e.aw,r=e.ax,a=e.aK,l=e.O,d=e.aM,o=e.U,c=e.D,u=e._,p=e.$,h=e.a0,g=e.a1,m=e.a3,x=e.a5,j=e.a4},e=>{f=e.g,b=e.a,y=e.ar,w=e.a6,v=e.ao,N=e.as,A=e.v,S=e.w,C=e.o,E=e.ak,z=e.m,k=e.p,W=e.a4,O=e.at,T=e.t,R=e.k,P=e.y,_=e.ap,I=e.au,D=e.av,F=e.aw,L=e.ax,U=e.n},e=>{M=e.u,V=e.b},e=>{$=e.u,B=e.e},e=>{H=e.s},e=>{K=e.C,q=e.c,G=e.a,J=e.b},e=>{Q=e.LearnHowToAdd},e=>{X=e.m},null,null],execute:function(){function t(){const{t:e}=M(),t=f(),{selected:u}=b((e=>e.runtime)),p=V.useRef(window.graph),h=e=>{if(p.current.hasNode(e)){const t=p.current.getNodeAttributes(e),n=t.type;return e.startsWith("stn")?t[n].names.join("/"):n}if(p.current.hasEdge(e)){const[t,n]=p.current.extremities(e),i=p.current.getSourceAttributes(e),s=p.current.getTargetAttributes(e),r=i.type,a=s.type;return(t.startsWith("stn")?i[r].names[0]:r)+" - "+(n.startsWith("stn")?s[a].names[0]:a)}},[g,m]=V.useState([]);V.useEffect((()=>{m(["station","misc-node","line"])}),[u]);const[x,j]=V.useState(!1);return n.jsxs(i,{children:[n.jsxs(s,{as:"h5",size:"sm",children:[e("panel.details.multipleSelection.selected")," ",u.size]}),n.jsxs(r,{m:"var(--chakra-space-1)",children:[n.jsxs(a,{w:"100%",children:[n.jsx(s,{as:"h5",size:"xs",w:"100%",children:e("panel.details.multipleSelection.show")}),n.jsx(y,{selections:[{label:e("panel.details.multipleSelection.station"),value:"station"},{label:e("panel.details.multipleSelection.miscNode"),value:"misc-node"},{label:e("panel.details.multipleSelection.edge"),value:"line"}],defaultValue:g,multiSelect:!0,onChange:e=>m(e)})]}),0!==g.length&&n.jsxs(n.Fragment,{children:[n.jsxs(l,{width:"100%",size:"sm",onClick:()=>j(!0),children:[e("panel.details.multipleSelection.change"),n.jsx(d,{label:e("header.settings.pro"),children:n.jsx(o,{ml:"1",color:"gray.50",background:"radial-gradient(circle, #3f5efb, #fc466b)",children:"PRO"})})]}),n.jsx(c,{})]}),[...u].filter((e=>g.includes("station")||!e.startsWith("stn"))).filter((e=>g.includes("misc-node")||!e.startsWith("misc"))).filter((e=>g.includes("line")||!e.startsWith("line"))).map((e=>{var i;return n.jsxs(a,{width:"100%",children:[n.jsx(l,{width:"100%",size:"sm",variant:"solid",onClick:()=>t(w(new Set([e]))),overflow:"hidden",textOverflow:"ellipsis",whiteSpace:"nowrap",display:"ruby",children:null===(i=h(e))||void 0===i?void 0:i.replaceAll("\\","⏎")}),n.jsx(l,{size:"sm",onClick:()=>t(v(e)),children:n.jsx(N,{})})]},e)}))]}),n.jsx(K,{isOpen:x,onClose:()=>j(!1),isSelect:!0,filter:g})]})}function Y(){const{t:e}=M(),t=f(),i=V.useCallback((()=>{t(A()),t(S(d.current.export()))}),[t,A,S]),{selected:s,theme:r}=b((e=>e.runtime)),[a]=s,d=V.useRef(window.graph),[o,c]=V.useState(!1),j=V.useRef(null),y=Object.fromEntries(Object.entries(C).map((([t,n])=>[t,e(n.metadata.displayName).toString()]))),[w,v]=V.useState(d.current.getEdgeAttribute(a,"type")),[N,T]=V.useState(void 0),R=Object.fromEntries(Object.entries(E).map((([t,n])=>[t,e(n.metadata.displayName).toString()]))),[P,_]=V.useState(d.current.getEdgeAttribute(a,"style")),[I,D]=V.useState(void 0),F=Object.values(z).filter((e=>!E[P].metadata.supportLinePathType.includes(e))),L=Object.values(k).filter((e=>!E[e].metadata.supportLinePathType.includes(w))),U=e=>{e&&(N?(N&&(q(d.current,a,N),v(d.current.getEdgeAttribute(a,"type")),i()),T(void 0)):I&&(I&&(G(d.current,a,I,r),_(d.current.getEdgeAttribute(a,"style")),i()),D(void 0))),c(!1)};return n.jsxs(n.Fragment,{children:[n.jsx(W,{label:e("panel.details.info.linePathType"),minW:"276",children:n.jsx(O,{options:y,disabledOptions:F,defaultValue:w,value:w,onChange:({target:{value:e}})=>{T(e),c(!0)}})}),n.jsx(W,{label:e("panel.details.info.lineStyleType"),minW:"276",children:n.jsx(O,{options:R,disabledOptions:L,defaultValue:P,value:P,onChange:({target:{value:e}})=>{D(e),c(!0)}})}),n.jsx(Q,{type:"line",expand:!0}),n.jsx(u,{isOpen:o,leastDestructiveRef:j,onClose:()=>U(!1),children:n.jsx(p,{children:n.jsxs(h,{children:[n.jsx(g,{children:e("warning")}),n.jsx(m,{children:e("panel.details.changeLineTypeContent")}),n.jsxs(x,{children:[n.jsx(l,{ref:j,onClick:()=>U(!1),children:e("cancel")}),n.jsx(l,{ml:"2",colorScheme:"red",onClick:()=>U(!0),children:e("panel.details.changeType")})]})]})})})]})}function Z(){const{t:e}=M(),t=f(),i=V.useCallback((()=>{t(T()),t(S(a.current.export()))}),[t,T,S]),{selected:s}=b((e=>e.runtime)),[r]=s,a=V.useRef(window.graph),[d,o]=V.useState(!1),c=V.useRef(null),[j,y]=V.useState(void 0),w=a.current.getNodeAttribute(r,"type"),v=Object.fromEntries(Object.entries(H).map((([t,n])=>[t,e(n.metadata.displayName).toString()]))),N=e=>{e&&j&&(J(a.current,r,j),i()),y(void 0),o(!1)};return n.jsxs(n.Fragment,{children:[n.jsx(W,{label:e("panel.details.info.stationType"),minW:"276",children:n.jsx(O,{options:v,disabledOptions:[w],value:w,onChange:({target:{value:e}})=>{y(e),o(!0)}})}),n.jsx(u,{isOpen:d,leastDestructiveRef:c,onClose:()=>N(!1),children:n.jsx(p,{children:n.jsxs(h,{children:[n.jsx(g,{children:e("warning")}),n.jsx(m,{children:e("panel.details.changeStationTypeContent")}),n.jsxs(x,{children:[n.jsx(l,{ref:c,onClick:()=>N(!1),children:e("cancel")}),n.jsx(l,{ml:"2",colorScheme:"red",onClick:()=>N(!0),children:e("panel.details.changeType")})]})]})})})]})}function ee(){const{t:e}=M(),r=f(),a=V.useCallback((()=>{r(T()),r(A()),r(S(o.current.export()))}),[r,A,S]),{selected:l}=b((e=>e.runtime)),[d]=l,o=V.useRef(window.graph),c=[];return 0===l.size||(1===l.size?(c.push({type:"input",label:e("panel.details.info.id"),value:d,minW:276}),c.push({type:"select",label:e("panel.details.info.zIndex"),value:d?o.current.hasNode(d)?o.current.getNodeAttribute(d,"zIndex"):o.current.hasEdge(d)?o.current.getEdgeAttribute(d,"zIndex"):0:0,options:Object.fromEntries(Array.from({length:11},((e,t)=>[t-5,(t-5).toString()]))),onChange:e=>(e=>{const t=Math.min(Math.max(e,-5),5);o.current.hasNode(d)&&o.current.setNodeAttribute(d,"zIndex",t),o.current.hasEdge(d)&&o.current.setEdgeAttribute(d,"zIndex",t),a()})(Number(e))})):l.size>1&&c.push({type:"input",label:e("panel.details.info.type"),value:e("panel.details.multipleSelection.title"),minW:276})),n.jsxs(i,{p:1,children:[n.jsx(s,{as:"h5",size:"sm",children:e("panel.details.info.title")}),n.jsx(R,{fields:c,minW:130}),1===l.size&&d.startsWith("stn")&&o.current.hasNode(d)&&o.current.getNodeAttribute(d,"type")in H&&n.jsx(Z,{}),1===l.size&&d.startsWith("line")&&o.current.hasEdge(d)&&o.current.getEdgeAttribute(d,"type")in C&&o.current.getEdgeAttribute(d,"style")in E&&n.jsx(Y,{}),l.size>1&&n.jsx(t,{})]})}function te(){const{t:e}=M(),t=f(),{selected:r}=b((e=>e.runtime)),[a]=r,d=V.useRef(window.graph),[o,c]=V.useState("undefined"),[u,p]=V.useState("undefined"),[h,g]=V.useState("undefined"),[m,x]=V.useState("undefined");V.useEffect((()=>{if(null!=a&&a.startsWith("line")){const[s,r]=d.current.extremities(a);if(c(s),p(r),s.startsWith("stn")){var e,t;const n=d.current.getNodeAttribute(s,"type");g(null!==(e=null===(t=d.current.getNodeAttribute(s,n))||void 0===t?void 0:t.names.at(0))&&void 0!==e?e:"undefined")}if(r.startsWith("stn")){var n,i;const e=d.current.getNodeAttribute(r,"type");x(null!==(n=null===(i=d.current.getNodeAttribute(r,e))||void 0===i?void 0:i.names.at(0))&&void 0!==n?n:"undefined")}}}),[r]);const j=$((()=>{t(P()),t(_(o))})),y=$((()=>{t(P()),t(_(u))})),w=[{type:"custom",label:e("panel.details.lineExtremities.source"),component:n.jsx(l,{flex:1,size:"sm",variant:"link",onClick:j,children:o}),minW:"full"},{type:"input",label:e("panel.details.lineExtremities.sourceName"),value:h,minW:"full"},{type:"custom",label:e("panel.details.lineExtremities.target"),component:n.jsx(l,{flex:1,size:"sm",variant:"link",onClick:y,children:u}),minW:"full"},{type:"input",label:e("panel.details.lineExtremities.targetName"),value:m,minW:"full"}];return n.jsxs(i,{p:1,children:[n.jsx(s,{as:"h5",size:"sm",children:e("panel.details.lineExtremities.title")}),n.jsx(R,{fields:w,minW:130})]})}function ne(){const{t:e}=M(),t=f(),r=V.useCallback((()=>{t(T()),t(A()),t(S(o.current.export()))}),[t,T,A,S]),{selected:a,refresh:{nodes:l}}=b((e=>e.runtime)),[d]=a,o=V.useRef(window.graph),[c,u]=V.useState({x:0,y:0});V.useEffect((()=>{if(null!=d&&d.startsWith("stn")||null!=d&&d.startsWith("misc_node_")){const e=o.current.getNodeAttribute(d,"x"),t=o.current.getNodeAttribute(d,"y");u({x:e,y:t})}}),[l,a]);const p=[{type:"input",label:e("panel.details.nodePosition.pos.x"),value:c.x.toString(),validator:e=>!Number.isNaN(e),onChange:e=>{o.current.mergeNodeAttributes(d,{x:Number(e)}),r()}},{type:"input",label:e("panel.details.nodePosition.pos.y"),value:c.y.toString(),validator:e=>!Number.isNaN(e),onChange:e=>{o.current.mergeNodeAttributes(d,{y:Number(e)}),r()}}];return n.jsxs(i,{p:1,children:[n.jsx(s,{as:"h5",size:"sm",children:e("panel.details.nodePosition.title")}),n.jsx(R,{fields:p,minW:130})]})}const ie={...H,...X},se=()=>{var e;const t=f(),{selected:i}=b((e=>e.runtime)),{t:s}=M(),[r]=i,a=window.graph.getNodeAttribute(r,"type"),l=a in ie&&ie[a].attrsComponent,d=null!==(e=window.graph.getNodeAttribute(r,a))&&void 0!==e?e:{};return l?n.jsx(l,{id:r,attrs:d,handleAttrsUpdate:(e,n)=>{const i=window.graph.getNodeAttribute(e,"type");window.graph.mergeNodeAttributes(e,{[i]:n}),t(T()),t(S(window.graph.export()))}}):n.jsx(j,{fontSize:"xs",m:"var(--chakra-space-1)",children:s("panel.details.unknown.error",{category:s("panel.details.unknown.node")})})},re=()=>{var e,t;const i=f(),{selected:s}=b((e=>e.runtime)),{t:r}=M(),[a]=s,l=window.graph.getEdgeAttribute(a,"type"),d=null!==(e=window.graph.getEdgeAttribute(a,l))&&void 0!==e?e:{},o=l in C&&C[l].attrsComponent,c=window.graph.getEdgeAttribute(a,"style"),u=null!==(t=window.graph.getEdgeAttribute(a,c))&&void 0!==t?t:{},p=c in E&&E[c].attrsComponent;return n.jsxs(n.Fragment,{children:[o?n.jsx(o,{id:a,attrs:d,handleAttrsUpdate:(e,t)=>{window.graph.mergeEdgeAttributes(e,{[l]:t}),i(A()),i(S(window.graph.export()))}}):n.jsx(j,{fontSize:"xs",m:"var(--chakra-space-1)",children:r("panel.details.unknown.error",{category:r("panel.details.unknown.linePath")})}),p?n.jsx(p,{id:a,attrs:u,handleAttrsUpdate:(e,t)=>{window.graph.mergeEdgeAttributes(e,{[c]:t}),i(A()),i(S(window.graph.export()))}}):n.jsx(j,{fontSize:"xs",m:"var(--chakra-space-1)",children:r("panel.details.unknown.error",{category:r("panel.details.unknown.lineStyle")})})]})};e("default",(()=>{const{t:e}=M(),t=f(),r=V.useRef(window.graph),d=V.useCallback((()=>{t(T()),t(A()),t(S(r.current.export()))}),[t,T,A,S]),{selected:o,mode:c,active:u}=b((e=>e.runtime)),[p]=o;return n.jsxs(I,{isOpen:o.size>0&&!c.startsWith("line")&&!u,width:300,header:"Dummy header",alwaysOverlay:!0,children:[n.jsx(D,{onClose:()=>t(P()),children:e("panel.details.header")}),n.jsxs(F,{children:[n.jsx(ee,{}),1===o.size&&r.current.hasNode(p)&&n.jsx(ne,{}),1===o.size&&r.current.hasEdge(p)&&n.jsx(te,{}),1===o.size&&n.jsxs(i,{p:1,children:[n.jsx(s,{as:"h5",size:"sm",children:e("panel.details.specificAttrsTitle")}),window.graph.hasNode(p)&&n.jsx(se,{}),window.graph.hasEdge(p)&&n.jsx(re,{})]})]}),n.jsx(L,{children:n.jsxs(a,{children:[1===o.size&&r.current.hasNode([...o].at(0))&&n.jsx(l,{size:"sm",variant:"outline",onClick:()=>(e=>{const n=structuredClone(r.current.getNodeAttributes(e));n.x+=50,n.y+=50;const i=e.startsWith("stn")?`stn_${U(10)}`:`misc_node_${U(10)}`;r.current.addNode(i,n),t(T()),t(S(r.current.export()))})([...o].at(0)),children:e("panel.details.footer.duplicate")}),n.jsx(l,{size:"sm",variant:"outline",onClick:()=>(e=>{const t=B(r.current,e);navigator.clipboard.writeText(t)})(o),children:e("panel.details.footer.copy")}),n.jsx(l,{size:"sm",variant:"outline",onClick:()=>{return e=o,t(P()),e.forEach((e=>{r.current.hasNode(e)?r.current.dropNode(e):r.current.hasEdge(e)&&r.current.dropEdge(e)})),void d();var e},children:e("panel.details.footer.remove")})]})})]})}))}}}));
