System.register(["./chakra-legacy-Ts5iMId3.js","./index-legacy-r-p3sOgC.js","./react-legacy-T1GznqXM.js","./clipboard-legacy-D8MxLLFI.js","./stations-legacy-_F8Wz3cf.js","./change-types-legacy-M3GzlIyg.js","./misc-nodes-legacy-5YDoaasj.js"],(function(e,t){"use strict";var n,r,i,s,a,l,d,o,u,c,p,h,g,m,x,j,f,b,y,v,w,A,N,E,C,S,k,z,W,O,T,R,P,I,_,D,F,L,U,$,M,V,q,B;return{setters:[e=>{n=e.j,r=e.B,i=e.av,s=e.aw,a=e.a4,l=e.Y,d=e.Z,o=e._,u=e.$,c=e.a1,p=e.a3,h=e.a2,g=e.aJ},e=>{m=e.f,x=e.a,j=e.q,f=e.t,b=e.v,y=e.ag,v=e.T,w=e.I,A=e.ad,N=e.o,E=e.m,C=e.H,S=e.l,k=e.ah,z=e.j,W=e.x,O=e.af,T=e.ai,R=e.aj,P=e.ak,I=e.al,_=e.n},e=>{D=e.u,F=e.b},e=>{L=e.u,U=e.e},e=>{$=e.s},e=>{M=e.d,V=e.e,q=e.f},e=>{B=e.m}],execute:function(){function t(){const{t:e}=D(),t=m(),{selected:l,theme:d,paletteAppClip:{output:o}}=x((e=>e.runtime)),u=F.useCallback((()=>{t(j()),t(f()),t(b(c.current.export()))}),[t,j,f,b]),c=F.useRef(window.graph),p=e=>{if(c.current.hasNode(e)){const t=c.current.getNodeAttributes(e),n=t.type;return e.startsWith("stn")?t[n].names.join("/"):n}if(c.current.hasEdge(e)){const[t,n]=c.current.extremities(e),r=c.current.getSourceAttributes(e),i=c.current.getTargetAttributes(e),s=r.type,a=i.type;return(t.startsWith("stn")?r[s].names[0]:s)+" - "+(n.startsWith("stn")?i[a].names[0]:a)}},[h,g]=F.useState(!1);return F.useEffect((()=>{var e;h&&o&&(e=o,l.forEach((t=>{if(c.current.hasEdge(t)){const n=c.current.getEdgeAttributes(t).style,r=c.current.getEdgeAttribute(t,n);n!==N.River&&void 0!==r.color&&(r.color=e),c.current.mergeEdgeAttributes(t,{[n]:r})}else if(c.current.hasNode(t)){const n=c.current.getNodeAttributes(t).type,r=c.current.getNodeAttribute(t,n);void 0!==r.color&&(r.color=e),c.current.mergeNodeAttributes(t,{[n]:r})}})),u(),g(!1))}),[null==o?void 0:o.toString()]),n.jsxs(r,{children:[n.jsxs(i,{as:"h5",size:"sm",children:[e("panel.details.selected")," ",l.size]}),n.jsx(y,{label:e("panel.details.multipleChangeColor"),children:n.jsx(v,{theme:d,onClick:()=>{g(!0),t(w(d))}})}),n.jsx(s,{m:"var(--chakra-space-1)",children:[...l].map((e=>{var r;return n.jsx(a,{width:"100%",size:"sm",variant:"solid",onClick:()=>t(A(new Set([e]))),overflow:"hidden",maxW:"270",textOverflow:"ellipsis",whiteSpace:"nowrap",display:"ruby",children:null===(r=p(e))||void 0===r?void 0:r.replaceAll("\\","⏎")},e)}))})]})}function H(){const{t:e}=D(),t=m(),r=F.useCallback((()=>{t(f()),t(b(g.current.export()))}),[t,f,b]),{selected:i,theme:s}=x((e=>e.runtime)),[h]=i,g=F.useRef(window.graph),[j,v]=F.useState(!1),w=F.useRef(null),A=Object.fromEntries(Object.entries(E).map((([t,n])=>[t,e(n.metadata.displayName).toString()]))),[z,W]=F.useState(g.current.getEdgeAttribute(h,"type")),[O,T]=F.useState(void 0),R=Object.fromEntries(Object.entries(C).map((([t,n])=>[t,e(n.metadata.displayName).toString()]))),[P,I]=F.useState(g.current.getEdgeAttribute(h,"style")),[_,L]=F.useState(void 0),U=Object.values(S).filter((e=>!C[P].metadata.supportLinePathType.includes(e))),$=Object.values(N).filter((e=>!C[e].metadata.supportLinePathType.includes(z))),q=e=>{e&&(O?(O&&(M(g.current,h,O),W(g.current.getEdgeAttribute(h,"type")),r()),T(void 0)):_&&(_&&(V(g.current,h,_,s),I(g.current.getEdgeAttribute(h,"style")),r()),L(void 0))),v(!1)};return n.jsxs(n.Fragment,{children:[n.jsx(y,{label:e("panel.details.info.linePathType"),minW:"276",children:n.jsx(k,{options:A,disabledOptions:U,defaultValue:z,value:z,onChange:({target:{value:e}})=>{T(e),v(!0)}})}),n.jsx(y,{label:e("panel.details.info.lineStyleType"),minW:"276",children:n.jsx(k,{options:R,disabledOptions:$,defaultValue:P,value:P,onChange:({target:{value:e}})=>{L(e),v(!0)}})}),n.jsx(l,{isOpen:j,leastDestructiveRef:w,onClose:()=>q(!1),children:n.jsx(d,{children:n.jsxs(o,{children:[n.jsx(u,{children:e("warning")}),n.jsx(c,{children:e("panel.details.changeLineTypeContent")}),n.jsxs(p,{children:[n.jsx(a,{ref:w,onClick:()=>q(!1),children:e("cancel")}),n.jsx(a,{ml:"2",colorScheme:"red",onClick:()=>q(!0),children:e("panel.details.changeType")})]})]})})})]})}function J(){const{t:e}=D(),t=m(),r=F.useCallback((()=>{t(j()),t(b(h.current.export()))}),[t,j,b]),{selected:i}=x((e=>e.runtime)),[s]=i,h=F.useRef(window.graph),[g,f]=F.useState(!1),v=F.useRef(null),[w,A]=F.useState(void 0),N=h.current.getNodeAttribute(s,"type"),E=Object.fromEntries(Object.entries($).map((([t,n])=>[t,e(n.metadata.displayName).toString()]))),C=e=>{e&&w&&(q(h.current,s,w),r()),A(void 0),f(!1)};return n.jsxs(n.Fragment,{children:[n.jsx(y,{label:e("panel.details.info.stationType"),minW:"276",children:n.jsx(k,{options:E,disabledOptions:[N],value:N,onChange:({target:{value:e}})=>{A(e),f(!0)}})}),n.jsx(l,{isOpen:g,leastDestructiveRef:v,onClose:()=>C(!1),children:n.jsx(d,{children:n.jsxs(o,{children:[n.jsx(u,{children:e("warning")}),n.jsx(c,{children:e("panel.details.changeStationTypeContent")}),n.jsxs(p,{children:[n.jsx(a,{ref:v,onClick:()=>C(!1),children:e("cancel")}),n.jsx(a,{ml:"2",colorScheme:"red",onClick:()=>C(!0),children:e("panel.details.changeType")})]})]})})})]})}function Y(){const{t:e}=D(),s=m(),a=F.useCallback((()=>{s(j()),s(f()),s(b(o.current.export()))}),[s,f,b]),{selected:l}=x((e=>e.runtime)),[d]=l,o=F.useRef(window.graph),u=[];return 0===l.size||(1===l.size?(u.push({type:"input",label:e("panel.details.info.id"),value:d,minW:276}),u.push({type:"select",label:e("panel.details.info.zIndex"),value:d?o.current.hasNode(d)?o.current.getNodeAttribute(d,"zIndex"):o.current.hasEdge(d)?o.current.getEdgeAttribute(d,"zIndex"):0:0,options:Object.fromEntries(Array.from({length:11},((e,t)=>[t-5,(t-5).toString()]))),onChange:e=>(e=>{const t=Math.min(Math.max(e,-5),5);o.current.hasNode(d)&&o.current.setNodeAttribute(d,"zIndex",t),o.current.hasEdge(d)&&o.current.setEdgeAttribute(d,"zIndex",t),a()})(Number(e))})):l.size>1&&u.push({type:"input",label:e("panel.details.info.type"),value:"multiple selection",minW:276})),n.jsxs(r,{p:1,children:[n.jsx(i,{as:"h5",size:"sm",children:e("panel.details.info.title")}),n.jsx(z,{fields:u,minW:130}),1===l.size&&d.startsWith("stn")&&o.current.hasNode(d)&&o.current.getNodeAttribute(d,"type")in $&&n.jsx(J,{}),1===l.size&&d.startsWith("line")&&o.current.hasEdge(d)&&o.current.getEdgeAttribute(d,"type")in E&&o.current.getEdgeAttribute(d,"style")in C&&n.jsx(H,{}),l.size>1&&n.jsx(t,{})]})}function Z(){const{t:e}=D(),t=m(),{selected:s}=x((e=>e.runtime)),[l]=s,d=F.useRef(window.graph),[o,u]=F.useState("undefined"),[c,p]=F.useState("undefined"),[h,g]=F.useState("undefined"),[j,f]=F.useState("undefined");F.useEffect((()=>{if(null!=l&&l.startsWith("line")){const[i,s]=d.current.extremities(l);if(u(i),p(s),i.startsWith("stn")){var e,t;const n=d.current.getNodeAttribute(i,"type");g(null!==(e=null===(t=d.current.getNodeAttribute(i,n))||void 0===t?void 0:t.names.at(0))&&void 0!==e?e:"undefined")}if(s.startsWith("stn")){var n,r;const e=d.current.getNodeAttribute(s,"type");f(null!==(n=null===(r=d.current.getNodeAttribute(s,e))||void 0===r?void 0:r.names.at(0))&&void 0!==n?n:"undefined")}}}),[s]);const b=L((()=>{t(W()),t(O(o))})),y=L((()=>{t(W()),t(O(c))})),v=[{type:"custom",label:e("panel.details.lineExtremities.source"),component:n.jsx(a,{flex:1,size:"sm",variant:"link",onClick:b,children:o}),minW:"full"},{type:"input",label:e("panel.details.lineExtremities.sourceName"),value:h,minW:"full"},{type:"custom",label:e("panel.details.lineExtremities.target"),component:n.jsx(a,{flex:1,size:"sm",variant:"link",onClick:y,children:c}),minW:"full"},{type:"input",label:e("panel.details.lineExtremities.targetName"),value:j,minW:"full"}];return n.jsxs(r,{p:1,children:[n.jsx(i,{as:"h5",size:"sm",children:e("panel.details.lineExtremities.title")}),n.jsx(z,{fields:v,minW:130})]})}function G(){const{t:e}=D(),t=m(),s=F.useCallback((()=>{t(j()),t(f()),t(b(o.current.export()))}),[t,j,f,b]),{selected:a,refresh:{nodes:l}}=x((e=>e.runtime)),[d]=a,o=F.useRef(window.graph),[u,c]=F.useState({x:0,y:0});F.useEffect((()=>{if(null!=d&&d.startsWith("stn")||null!=d&&d.startsWith("misc_node_")){const e=o.current.getNodeAttribute(d,"x"),t=o.current.getNodeAttribute(d,"y");c({x:e,y:t})}}),[l,a]);const p=[{type:"input",label:e("panel.details.nodePosition.pos.x"),value:u.x.toString(),validator:e=>!Number.isNaN(e),onChange:e=>{o.current.mergeNodeAttributes(d,{x:Number(e)}),s()}},{type:"input",label:e("panel.details.nodePosition.pos.y"),value:u.y.toString(),validator:e=>!Number.isNaN(e),onChange:e=>{o.current.mergeNodeAttributes(d,{y:Number(e)}),s()}}];return n.jsxs(r,{p:1,children:[n.jsx(i,{as:"h5",size:"sm",children:e("panel.details.nodePosition.title")}),n.jsx(z,{fields:p,minW:130})]})}const K={...$,...B},Q=()=>{var e;const t=m(),{selected:r}=x((e=>e.runtime)),{t:i}=D(),[s]=r,a=window.graph.getNodeAttribute(s,"type"),l=a in K&&K[a].attrsComponent,d=null!==(e=window.graph.getNodeAttribute(s,a))&&void 0!==e?e:{};return l?n.jsx(l,{id:s,attrs:d,handleAttrsUpdate:(e,n)=>{const r=window.graph.getNodeAttribute(e,"type");window.graph.mergeNodeAttributes(e,{[r]:n}),t(j()),t(b(window.graph.export()))}}):n.jsx(h,{fontSize:"xs",m:"var(--chakra-space-1)",children:i("panel.details.unknown.error",{category:i("panel.details.unknown.node")})})},X=()=>{var e,t;const r=m(),{selected:i}=x((e=>e.runtime)),{t:s}=D(),[a]=i,l=window.graph.getEdgeAttribute(a,"type"),d=null!==(e=window.graph.getEdgeAttribute(a,l))&&void 0!==e?e:{},o=l in E&&E[l].attrsComponent,u=window.graph.getEdgeAttribute(a,"style"),c=null!==(t=window.graph.getEdgeAttribute(a,u))&&void 0!==t?t:{},p=u in C&&C[u].attrsComponent;return n.jsxs(n.Fragment,{children:[o?n.jsx(o,{id:a,attrs:d,handleAttrsUpdate:(e,t)=>{window.graph.mergeEdgeAttributes(e,{[l]:t}),r(f()),r(b(window.graph.export()))}}):n.jsx(h,{fontSize:"xs",m:"var(--chakra-space-1)",children:s("panel.details.unknown.error",{category:s("panel.details.unknown.linePath")})}),p?n.jsx(p,{id:a,attrs:c,handleAttrsUpdate:(e,t)=>{window.graph.mergeEdgeAttributes(e,{[u]:t}),r(f()),r(b(window.graph.export()))}}):n.jsx(h,{fontSize:"xs",m:"var(--chakra-space-1)",children:s("panel.details.unknown.error",{category:s("panel.details.unknown.lineStyle")})})]})};e("default",(()=>{const{t:e}=D(),t=m(),s=F.useRef(window.graph),l=F.useCallback((()=>{t(j()),t(f()),t(b(s.current.export()))}),[t,j,f,b]),{selected:d,mode:o}=x((e=>e.runtime)),[u]=d;return n.jsxs(T,{isOpen:d.size>0&&!o.startsWith("line"),width:300,header:"Dummy header",alwaysOverlay:!0,children:[n.jsx(R,{onClose:()=>t(W()),children:e("panel.details.header")}),n.jsxs(P,{children:[n.jsx(Y,{}),1===d.size&&s.current.hasNode(u)&&n.jsx(G,{}),1===d.size&&s.current.hasEdge(u)&&n.jsx(Z,{}),1===d.size&&n.jsxs(r,{p:1,children:[n.jsx(i,{as:"h5",size:"sm",children:e("panel.details.specificAttrsTitle")}),window.graph.hasNode(u)&&n.jsx(Q,{}),window.graph.hasEdge(u)&&n.jsx(X,{})]})]}),n.jsx(I,{children:n.jsxs(g,{children:[1===d.size&&s.current.hasNode([...d].at(0))&&n.jsx(a,{size:"sm",variant:"outline",onClick:()=>(e=>{const n=structuredClone(s.current.getNodeAttributes(e));n.x+=50,n.y+=50;const r=e.startsWith("stn")?`stn_${_(10)}`:`misc_node_${_(10)}`;s.current.addNode(r,n),t(j()),t(b(s.current.export()))})([...d].at(0)),children:e("panel.details.footer.duplicate")}),n.jsx(a,{size:"sm",variant:"outline",onClick:()=>(e=>{const t=U(s.current,e);navigator.clipboard.writeText(t)})(d),children:e("panel.details.footer.copy")}),n.jsx(a,{size:"sm",variant:"outline",onClick:()=>{return e=d,t(W()),e.forEach((e=>{s.current.hasNode(e)?s.current.dropNode(e):s.current.hasEdge(e)&&s.current.dropEdge(e)})),void l();var e},children:e("panel.details.footer.remove")})]})})]})}))}}}));
