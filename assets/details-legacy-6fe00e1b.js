!function(){function e(t){return e="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},e(t)}function t(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function n(e){for(var n=1;n<arguments.length;n++){var r=null!=arguments[n]?arguments[n]:{};n%2?t(Object(r),!0).forEach((function(t){i(e,t,r[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):t(Object(r)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(r,t))}))}return e}function r(e){return function(e){if(Array.isArray(e))return u(e)}(e)||function(e){if("undefined"!=typeof Symbol&&null!=e[Symbol.iterator]||null!=e["@@iterator"])return Array.from(e)}(e)||o(e)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function i(t,n,r){return(n=function(t){var n=function(t,n){if("object"!==e(t)||null===t)return t;var r=t[Symbol.toPrimitive];if(void 0!==r){var i=r.call(t,n||"default");if("object"!==e(i))return i;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===n?String:Number)(t)}(t,"string");return"symbol"===e(n)?n:String(n)}(n))in t?Object.defineProperty(t,n,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[n]=r,t}function a(e,t){return function(e){if(Array.isArray(e))return e}(e)||function(e,t){var n=null==e?null:"undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(null!=n){var r,i,a,o,u=[],s=!0,l=!1;try{if(a=(n=n.call(e)).next,0===t){if(Object(n)!==n)return;s=!1}else for(;!(s=(r=a.call(n)).done)&&(u.push(r.value),u.length!==t);s=!0);}catch(c){l=!0,i=c}finally{try{if(!s&&null!=n.return&&(o=n.return(),Object(o)!==o))return}finally{if(l)throw i}}return u}}(e,t)||o(e,t)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function o(e,t){if(e){if("string"==typeof e)return u(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);return"Object"===n&&e.constructor&&(n=e.constructor.name),"Map"===n||"Set"===n?Array.from(e):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?u(e,t):void 0}}function u(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=new Array(t);n<t;n++)r[n]=e[n];return r}System.register(["./chakra-legacy-286557eb.js","./index-legacy-5e58d251.js","./react-legacy-5e1577ad.js","./clipboard-legacy-52d7b8ef.js","./stations-legacy-7f14935f.js","./change-types-legacy-53382517.js","./misc-nodes-legacy-5dd4c40f.js"],(function(e,t){"use strict";var o,u,s,l,c,d,f,p,h,g,m,b,y,v,x,j,w,A,S,N,E,O,C,k,z,W,P,T,R,I,D,_,M,U,F,L,q,V,$,B,G,H,J,K;return{setters:[function(e){o=e.j,u=e.$,s=e.a0,l=e.a1,c=e.s,d=e.A,f=e.M,p=e.m,h=e.n,g=e.p,m=e.r,b=e.q,y=e.ae},function(e){v=e.c,x=e.j,j=e.d,w=e.y,A=e.z,S=e.A,N=e.ak,E=e.T,O=e.O,C=e.ah,k=e.v,z=e.t,W=e.N,P=e.q,T=e.al,R=e.n,I=e.D,D=e.aj,_=e.am,M=e.an,U=e.ao,F=e.ap,L=e.p},function(e){q=e.b},function(e){V=e.u,$=e.e},function(e){B=e.s},function(e){G=e.d,H=e.e,J=e.f},function(e){K=e.m}],execute:function(){function t(){var e=v().t,t=x(),n=j((function(e){return e.runtime})),d=n.selected,f=n.theme,p=n.paletteAppClip.output,h=q.useCallback((function(){t(w()),t(A()),t(S(g.current.export()))}),[t,w,A,S]),g=q.useRef(window.graph),m=function(e){if(g.current.hasNode(e)){var t=g.current.getNodeAttributes(e),n=t.type;return e.startsWith("stn")?t[n].names.join("/"):n}if(g.current.hasEdge(e)){var r=a(g.current.extremities(e),2),i=r[0],o=r[1],u=g.current.getSourceAttributes(e),s=g.current.getTargetAttributes(e),l=u.type,c=s.type;return(i.startsWith("stn")?u[l].names[0]:l)+" - "+(o.startsWith("stn")?s[c].names[0]:c)}},b=a(q.useState(!1),2),y=b[0],z=b[1];return q.useEffect((function(){var e;y&&p&&(e=p,d.forEach((function(t){if(g.current.hasEdge(t)){var n=g.current.getEdgeAttributes(t).style,r=g.current.getEdgeAttribute(t,n);n!==k.River&&void 0!==r.color&&(r.color=e),g.current.mergeEdgeAttributes(t,i({},n,r))}else if(g.current.hasNode(t)){var a=g.current.getNodeAttributes(t).type,o=g.current.getNodeAttribute(t,a);void 0!==o.color&&(o.color=e),g.current.mergeNodeAttributes(t,i({},a,o))}})),h(),z(!1))}),[null==p?void 0:p.toString()]),o.jsxs(u,{children:[o.jsxs(s,{as:"h5",size:"sm",children:[e("panel.details.selected")," ",d.size]}),o.jsx(N,{label:e("panel.details.multipleChangeColor"),children:o.jsx(E,{theme:f,onClick:function(){z(!0),t(O(f))}})}),o.jsx(l,{m:"var(--chakra-space-1)",children:r(d).map((function(e){var n;return o.jsx(c,{width:"100%",size:"sm",variant:"solid",onClick:function(){return t(C(new Set([e])))},overflow:"hidden",maxW:"270",textOverflow:"ellipsis",whiteSpace:"nowrap",display:"ruby",children:null===(n=m(e))||void 0===n?void 0:n.replaceAll("\\","⏎")},e)}))})]})}function Q(){var e=v().t,t=x(),n=q.useCallback((function(){t(A()),t(S(l.current.export()))}),[t,A,S]),r=j((function(e){return e.runtime})),i=r.selected,u=r.theme,s=a(i,1)[0],l=q.useRef(window.graph),b=a(q.useState(!1),2),y=b[0],w=b[1],E=q.useRef(null),O=Object.fromEntries(Object.entries(z).map((function(t){var n=a(t,2),r=n[0],i=n[1];return[r,e(i.metadata.displayName).toString()]}))),C=a(q.useState(l.current.getEdgeAttribute(s,"type")),2),R=C[0],I=C[1],D=a(q.useState(void 0),2),_=D[0],M=D[1],U=Object.fromEntries(Object.entries(W).map((function(t){var n=a(t,2),r=n[0],i=n[1];return[r,e(i.metadata.displayName).toString()]}))),F=a(q.useState(l.current.getEdgeAttribute(s,"style")),2),L=F[0],V=F[1],$=a(q.useState(void 0),2),B=$[0],J=$[1],K=Object.values(P).filter((function(e){return!W[L].metadata.supportLinePathType.includes(e)})),Q=Object.values(k).filter((function(e){return!W[e].metadata.supportLinePathType.includes(R)})),X=function(e){e&&(_?(_&&(G(l.current,s,_),I(l.current.getEdgeAttribute(s,"type")),n()),M(void 0)):B&&(B&&(H(l.current,s,B,u),V(l.current.getEdgeAttribute(s,"style")),n()),J(void 0))),w(!1)};return o.jsxs(o.Fragment,{children:[o.jsx(N,{label:e("panel.details.info.linePathType"),minW:"276",children:o.jsx(T,{options:O,disabledOptions:K,defaultValue:R,value:R,onChange:function(e){var t=e.target.value;M(t),w(!0)}})}),o.jsx(N,{label:e("panel.details.info.lineStyleType"),minW:"276",children:o.jsx(T,{options:U,disabledOptions:Q,defaultValue:L,value:L,onChange:function(e){var t=e.target.value;J(t),w(!0)}})}),o.jsx(d,{isOpen:y,leastDestructiveRef:E,onClose:function(){return X(!1)},children:o.jsx(f,{children:o.jsxs(p,{children:[o.jsx(h,{children:e("warning")}),o.jsx(g,{children:e("panel.details.changeLineTypeContent")}),o.jsxs(m,{children:[o.jsx(c,{ref:E,onClick:function(){return X(!1)},children:e("cancel")}),o.jsx(c,{ml:"2",colorScheme:"red",onClick:function(){return X(!0)},children:e("panel.details.changeType")})]})]})})})]})}function X(){var e=v().t,t=x(),n=q.useCallback((function(){t(w()),t(S(i.current.export()))}),[t,w,S]),r=a(j((function(e){return e.runtime})).selected,1)[0],i=q.useRef(window.graph),u=a(q.useState(!1),2),s=u[0],l=u[1],b=q.useRef(null),y=a(q.useState(void 0),2),A=y[0],E=y[1],O=i.current.getNodeAttribute(r,"type"),C=Object.fromEntries(Object.entries(B).map((function(t){var n=a(t,2),r=n[0],i=n[1];return[r,e(i.metadata.displayName).toString()]}))),k=function(e){e&&A&&(J(i.current,r,A),n()),E(void 0),l(!1)};return o.jsxs(o.Fragment,{children:[o.jsx(N,{label:e("panel.details.info.stationType"),minW:"276",children:o.jsx(T,{options:C,disabledOptions:[O],value:O,onChange:function(e){var t=e.target.value;E(t),l(!0)}})}),o.jsx(d,{isOpen:s,leastDestructiveRef:b,onClose:function(){return k(!1)},children:o.jsx(f,{children:o.jsxs(p,{children:[o.jsx(h,{children:e("warning")}),o.jsx(g,{children:e("panel.details.changeStationTypeContent")}),o.jsxs(m,{children:[o.jsx(c,{ref:b,onClick:function(){return k(!1)},children:e("cancel")}),o.jsx(c,{ml:"2",colorScheme:"red",onClick:function(){return k(!0)},children:e("panel.details.changeType")})]})]})})})]})}function Y(){var e=v().t,n=x(),r=q.useCallback((function(){n(w()),n(A()),n(S(c.current.export()))}),[n,A,S]),i=j((function(e){return e.runtime})).selected,l=a(i,1)[0],c=q.useRef(window.graph),d=[];return 0===i.size||(1===i.size?(d.push({type:"input",label:e("panel.details.info.id"),value:l,minW:276}),d.push({type:"select",label:e("panel.details.info.zIndex"),value:l?c.current.hasNode(l)?c.current.getNodeAttribute(l,"zIndex"):c.current.hasEdge(l)?c.current.getEdgeAttribute(l,"zIndex"):0:0,options:Object.fromEntries(Array.from({length:11},(function(e,t){return[t-5,(t-5).toString()]}))),onChange:function(e){return function(e){var t=Math.min(Math.max(e,-5),5);c.current.hasNode(l)&&c.current.setNodeAttribute(l,"zIndex",t),c.current.hasEdge(l)&&c.current.setEdgeAttribute(l,"zIndex",t),r()}(Number(e))}})):i.size>1&&d.push({type:"input",label:e("panel.details.info.type"),value:"multiple selection",minW:276})),o.jsxs(u,{p:1,children:[o.jsx(s,{as:"h5",size:"sm",children:e("panel.details.info.title")}),o.jsx(R,{fields:d,minW:130}),1===i.size&&l.startsWith("stn")&&c.current.hasNode(l)&&c.current.getNodeAttribute(l,"type")in B&&o.jsx(X,{}),1===i.size&&l.startsWith("line")&&c.current.hasEdge(l)&&c.current.getEdgeAttribute(l,"type")in z&&c.current.getEdgeAttribute(l,"style")in W&&o.jsx(Q,{}),i.size>1&&o.jsx(t,{})]})}function Z(){var e=v().t,t=x(),n=j((function(e){return e.runtime})).selected,r=a(n,1)[0],i=q.useRef(window.graph),l=a(q.useState("undefined"),2),d=l[0],f=l[1],p=a(q.useState("undefined"),2),h=p[0],g=p[1],m=a(q.useState("undefined"),2),b=m[0],y=m[1],w=a(q.useState("undefined"),2),A=w[0],S=w[1];q.useEffect((function(){if(null!=r&&r.startsWith("line")){var e=a(i.current.extremities(r),2),t=e[0],n=e[1];if(f(t),g(n),t.startsWith("stn")){var o,u,s=i.current.getNodeAttribute(t,"type");y(null!==(o=null===(u=i.current.getNodeAttribute(t,s))||void 0===u?void 0:u.names.at(0))&&void 0!==o?o:"undefined")}if(n.startsWith("stn")){var l,c,d=i.current.getNodeAttribute(n,"type");S(null!==(l=null===(c=i.current.getNodeAttribute(n,d))||void 0===c?void 0:c.names.at(0))&&void 0!==l?l:"undefined")}}}),[n]);var N=V((function(){t(I()),t(D(d))})),E=V((function(){t(I()),t(D(h))})),O=[{type:"custom",label:e("panel.details.lineExtremities.source"),component:o.jsx(c,{flex:1,size:"sm",variant:"link",onClick:N,children:d}),minW:"full"},{type:"input",label:e("panel.details.lineExtremities.sourceName"),value:b,minW:"full"},{type:"custom",label:e("panel.details.lineExtremities.target"),component:o.jsx(c,{flex:1,size:"sm",variant:"link",onClick:E,children:h}),minW:"full"},{type:"input",label:e("panel.details.lineExtremities.targetName"),value:A,minW:"full"}];return o.jsxs(u,{p:1,children:[o.jsx(s,{as:"h5",size:"sm",children:e("panel.details.lineExtremities.title")}),o.jsx(R,{fields:O,minW:130})]})}function ee(){var e=v().t,t=x(),n=q.useCallback((function(){t(w()),t(A()),t(S(d.current.export()))}),[t,w,A,S]),r=j((function(e){return e.runtime})),i=r.selected,l=r.refresh.nodes,c=a(i,1)[0],d=q.useRef(window.graph),f=a(q.useState({x:0,y:0}),2),p=f[0],h=f[1];q.useEffect((function(){if(null!=c&&c.startsWith("stn")||null!=c&&c.startsWith("misc_node_")){var e=d.current.getNodeAttribute(c,"x"),t=d.current.getNodeAttribute(c,"y");h({x:e,y:t})}}),[l,i]);var g=[{type:"input",label:e("panel.details.nodePosition.pos.x"),value:p.x.toString(),validator:function(e){return!Number.isNaN(e)},onChange:function(e){d.current.mergeNodeAttributes(c,{x:Number(e)}),n()}},{type:"input",label:e("panel.details.nodePosition.pos.y"),value:p.y.toString(),validator:function(e){return!Number.isNaN(e)},onChange:function(e){d.current.mergeNodeAttributes(c,{y:Number(e)}),n()}}];return o.jsxs(u,{p:1,children:[o.jsx(s,{as:"h5",size:"sm",children:e("panel.details.nodePosition.title")}),o.jsx(R,{fields:g,minW:130})]})}var te=n(n({},B),K),ne=function(){var e,t=x(),n=j((function(e){return e.runtime})).selected,r=v().t,u=a(n,1)[0],s=window.graph.getNodeAttribute(u,"type"),l=s in te&&te[s].attrsComponent,c=null!==(e=window.graph.getNodeAttribute(u,s))&&void 0!==e?e:{};return l?o.jsx(l,{id:u,attrs:c,handleAttrsUpdate:function(e,n){var r=window.graph.getNodeAttribute(e,"type");window.graph.mergeNodeAttributes(e,i({},r,n)),t(w()),t(S(window.graph.export()))}}):o.jsx(b,{fontSize:"xs",m:"var(--chakra-space-1)",children:r("panel.details.unknown.error",{category:r("panel.details.unknown.node")})})},re=function(){var e,t,n=x(),r=j((function(e){return e.runtime})).selected,u=v().t,s=a(r,1)[0],l=window.graph.getEdgeAttribute(s,"type"),c=null!==(e=window.graph.getEdgeAttribute(s,l))&&void 0!==e?e:{},d=l in z&&z[l].attrsComponent,f=window.graph.getEdgeAttribute(s,"style"),p=null!==(t=window.graph.getEdgeAttribute(s,f))&&void 0!==t?t:{},h=f in W&&W[f].attrsComponent;return o.jsxs(o.Fragment,{children:[d?o.jsx(d,{id:s,attrs:c,handleAttrsUpdate:function(e,t){window.graph.mergeEdgeAttributes(e,i({},l,t)),n(A()),n(S(window.graph.export()))}}):o.jsx(b,{fontSize:"xs",m:"var(--chakra-space-1)",children:u("panel.details.unknown.error",{category:u("panel.details.unknown.linePath")})}),h?o.jsx(h,{id:s,attrs:p,handleAttrsUpdate:function(e,t){window.graph.mergeEdgeAttributes(e,i({},f,t)),n(A()),n(S(window.graph.export()))}}):o.jsx(b,{fontSize:"xs",m:"var(--chakra-space-1)",children:u("panel.details.unknown.error",{category:u("panel.details.unknown.lineStyle")})})]})};e("default",(function(){var e=v().t,t=x(),n=q.useRef(window.graph),i=q.useCallback((function(){t(w()),t(A()),t(S(n.current.export()))}),[t,w,A,S]),l=j((function(e){return e.runtime})),d=l.selected,f=l.mode,p=a(d,1)[0];return o.jsxs(_,{isOpen:d.size>0&&!f.startsWith("line"),width:300,header:"Dummy header",alwaysOverlay:!0,children:[o.jsx(M,{onClose:function(){return t(I())},children:e("panel.details.header")}),o.jsxs(U,{children:[o.jsx(Y,{}),1===d.size&&n.current.hasNode(p)&&o.jsx(ee,{}),1===d.size&&n.current.hasEdge(p)&&o.jsx(Z,{}),1===d.size&&o.jsxs(u,{p:1,children:[o.jsx(s,{as:"h5",size:"sm",children:e("panel.details.specificAttrsTitle")}),window.graph.hasNode(p)&&o.jsx(ne,{}),window.graph.hasEdge(p)&&o.jsx(re,{})]})]}),o.jsx(F,{children:o.jsxs(y,{children:[1===d.size&&n.current.hasNode(r(d).at(0))&&o.jsx(c,{size:"sm",variant:"outline",onClick:function(){return function(e){var r=structuredClone(n.current.getNodeAttributes(e));r.x+=50,r.y+=50;var i=e.startsWith("stn")?"stn_".concat(L(10)):"misc_node_".concat(L(10));n.current.addNode(i,r),t(w()),t(S(n.current.export()))}(r(d).at(0))},children:e("panel.details.footer.duplicate")}),o.jsx(c,{size:"sm",variant:"outline",onClick:function(){return e=d,t=$(n.current,e),void navigator.clipboard.writeText(t);var e,t},children:e("panel.details.footer.copy")}),o.jsx(c,{size:"sm",variant:"outline",onClick:function(){return e=d,t(I()),e.forEach((function(e){n.current.hasNode(e)?n.current.dropNode(e):n.current.hasEdge(e)&&n.current.dropEdge(e)})),void i();var e},children:e("panel.details.footer.remove")})]})})]})}))}}}))}();
