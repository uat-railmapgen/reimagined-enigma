import{j as e,at as Z,$ as V,au as F,a1 as K,a2 as Y,a3 as q,g as nt,av as Pt,a4 as b,B as H,aw as ge,ax as Ce,ay as J,az as X,aA as $,as as Gt,h as Ke,O as R,a5 as pe,aB as us,aC as gs,aD as be,a7 as M,aE as T,a6 as Dt,aF as ut,aG as gt,af as ee,aH as mt,aI as se,U as ve,aJ as Ye,aK as ms,aL as Ut,al as Zt,aM as Be,aN as xs,ak as He,aO as fs,aP as js,aQ as G,aR as kt,aS as bs,aT as A,aU as C,d as Vt,R as Ft,q as Kt,Z as Yt,W as ws,m as Q,a8 as Ss,a9 as ys}from"./chakra-C3T8NphC.js";import{u as Cs,r as N,a as P,E as me,M as vs,c as qt,b as ze,S as I,C as zs,d as xt,n as ot,L as Jt,R as At,e as Xt,f as E,g as D,h as ks,i as As,j as Os,k as ke,s as Ms,l as Pe,m as qe,o as Es,p as Ts,q as Ot,t as $t,v as xe,w as de,x as he,y as Qt,z as it,A as Ae,B as Ne,D as Mt,F as es,G as Et,H as Rs,I as Ns,J as _s,K as Is,N as Ls,O as Tt,P as Hs,T as Ws,Q as Bs,U as Ps,V as Gs,W as Ds,X as Us,Y as Zs,Z as Vs,_ as we,$ as Fs,a0 as Ks,a1 as Ys,a2 as qs,a3 as ae,a4 as Js,a5 as Rt,a6 as Xs,a7 as $s,a8 as Qs,a9 as en,aa as tn,ab as sn,ac as Je,ad as nn,ae as on,af as rn,ag as an,ah as ln,ai as cn,aj as dn,ak as Nt,al as hn,am as pn,an as un}from"./index-u3MmKvJb.js";import{u as W,b as x,r as _t,T as It}from"./react-DV6nCJb6.js";import{I as ts}from"./index-CvYts115.js";import{F as Xe,l as gn,m as mn,a as xn,i as fn,s as jn,u as ss}from"./stations-DqwNQkXm.js";import{f as bn}from"./graph-BgFCBPtV.js";import{C as wn}from"./change-type-modal-CfUsEeVG.js";var Lt=function(t){return Cs(N.ready(),t)},Sn={ar:{ar:"العربية",en:"Arabic",ko:"아랍어","zh-Hans":"阿拉伯文","zh-Hant":"阿拉伯文"},az:{az:"Azərbaycanca",en:"Azerbaijani",ko:"아제르바이잔어","zh-Hans":"阿塞拜疆文","zh-Hant":"阿塞拜疆文"},ca:{ca:"Català",en:"Catalan",ko:"카탈루냐어","zh-Hans":"加泰罗尼亚文","zh-Hant":"加泰隆尼亞文"},da:{da:"Dansk",en:"Danish",ko:"덴마크어","zh-Hans":"丹麦文","zh-Hant":"丹麥文"},de:{de:"Deutsch",en:"German",ko:"독일어","zh-Hans":"德文","zh-Hant":"德文"},el:{el:"Ελληνικά",en:"Greek",ko:"그리스어","zh-Hans":"希腊文","zh-Hant":"希臘文"},en:{en:"English",ja:"英語",ko:"영어","zh-Hans":"英文","zh-Hant":"英文"},es:{en:"Spanish",es:"Español",ko:"스페인어","zh-Hans":"西班牙文","zh-Hant":"西班牙文"},fa:{en:"Persian",fa:"فارسی",ko:"페르시아어","zh-Hans":"波斯文","zh-Hant":"波斯文"},fr:{en:"French",fr:"Français",ko:"프랑스어","zh-Hans":"法文","zh-Hant":"法文"},ga:{en:"Irish",ga:"Gaeilge",ko:"아일랜드어","zh-Hans":"爱尔兰文","zh-Hant":"愛爾蘭文"},gd:{en:"Scottish Gaelic",gd:"Gàidhlig",ko:"스코틀랜드 게일어","zh-Hans":"苏格兰盖尔文","zh-Hant":"蘇格蘭蓋爾文"},hi:{en:"Hindi",hi:"हिन्दी",ko:"힌디어","zh-Hans":"印地文","zh-Hant":"印地文"},hu:{en:"Hungarian",hu:"Magyar",ko:"헝가리어","zh-Hans":"匈牙利文","zh-Hant":"匈牙利文"},id:{en:"Indoesian",id:"Bahasa Indonesia",ko:"인도네시아어","zh-Hans":"印尼文","zh-Hant":"印尼文"},it:{en:"Italian",it:"Italiano",ko:"이탈리아어","zh-Hans":"意大利文","zh-Hant":"意大利文"},ja:{en:"Japanese",ja:"日本語",ko:"일본어","zh-Hans":"日文","zh-Hant":"日文"},kk:{en:"Kazakh",kk:"Қазақша",ko:"카자흐어","zh-Hans":"哈萨克文","zh-Hant":"哈薩克文"},ko:{en:"Korean",ja:"韓国語",ko:"한국어","zh-Hans":"韩文","zh-Hant":"韓文"},ms:{en:"Malay",ko:"말레이어",ms:"Bahasa Melayu","zh-Hans":"马来文","zh-Hant":"馬來文"},no:{en:"Norwegian",ko:"노르웨이어",no:"Norsk","zh-Hans":"挪威文","zh-Hant":"挪威文"},pl:{en:"Polish",ko:"폴란드어",pl:"Polski","zh-Hans":"波兰文","zh-Hant":"波蘭文"},pt:{en:"Portuguese",ko:"포르투갈어",pt:"Português","zh-Hans":"葡萄牙文","zh-Hant":"葡萄牙文"},ro:{en:"Romanian",ko:"루마니아어",ro:"Română","zh-Hans":"罗马尼亚文","zh-Hant":"羅馬尼亞文"},ru:{en:"Russian",ko:"러시아어",ru:"Русский","zh-Hans":"俄文","zh-Hant":"俄文"},sv:{en:"Swedish",ko:"스웨덴어",sv:"Svenska","zh-Hans":"瑞典文","zh-Hant":"瑞典文"},th:{en:"Thai",ko:"태국어",th:"ภาษาไทย","zh-Hans":"泰文","zh-Hant":"泰文"},tr:{en:"Turkish",ko:"튀르키예어",tr:"Türkçe","zh-Hans":"土耳其文","zh-Hant":"土耳其文"},uk:{en:"Ukrainian",ko:"우크라이나어",uk:"Українська","zh-Hans":"乌克兰文","zh-Hant":"烏克蘭文"},ur:{en:"Urdo",ko:"우르두어",ur:"اردو","zh-Hans":"乌尔都文","zh-Hant":"烏爾都文"},uz:{en:"Uzbek",ko:"우즈베크어",uz:"Oʻzbekcha","zh-Hans":"乌兹别克文","zh-Hant":"烏茲別克文"},vi:{en:"Vietnamese",ko:"베트남어",vi:"Tiếng Việt","zh-Hans":"越南文","zh-Hant":"越南文"},"zh-Hans":{en:"Simplified Chinese",ja:"中国語（簡体字）",ko:"중국어 간체자","zh-Hans":"简体中文","zh-Hant":"簡體中文"},"zh-Hant":{en:"Traditional Chinese",ja:"中国語（繁体字）",ko:"중국어 정체자","zh-Hans":"繁体中文","zh-Hant":"繁體中文"}};const yn="data:image/svg+xml,%3csvg%20width='98'%20height='96'%20xmlns='http://www.w3.org/2000/svg'%3e%3cpath%20fill-rule='evenodd'%20clip-rule='evenodd'%20d='M48.854%200C21.839%200%200%2022%200%2049.217c0%2021.756%2013.993%2040.172%2033.405%2046.69%202.427.49%203.316-1.059%203.316-2.362%200-1.141-.08-5.052-.08-9.127-13.59%202.934-16.42-5.867-16.42-5.867-2.184-5.704-5.42-7.17-5.42-7.17-4.448-3.015.324-3.015.324-3.015%204.934.326%207.523%205.052%207.523%205.052%204.367%207.496%2011.404%205.378%2014.235%204.074.404-3.178%201.699-5.378%203.074-6.6-10.839-1.141-22.243-5.378-22.243-24.283%200-5.378%201.94-9.778%205.014-13.2-.485-1.222-2.184-6.275.486-13.038%200%200%204.125-1.304%2013.426%205.052a46.97%2046.97%200%200%201%2012.214-1.63c4.125%200%208.33.571%2012.213%201.63%209.302-6.356%2013.427-5.052%2013.427-5.052%202.67%206.763.97%2011.816.485%2013.038%203.155%203.422%205.015%207.822%205.015%2013.2%200%2018.905-11.404%2023.06-22.324%2024.283%201.78%201.548%203.316%204.481%203.316%209.126%200%206.6-.08%2011.897-.08%2013.526%200%201.304.89%202.853%203.316%202.364%2019.412-6.52%2033.405-24.935%2033.405-46.691C97.707%2022%2075.788%200%2048.854%200z'%20fill='%2324292f'/%3e%3c/svg%3e",Cn="data:image/svg+xml,%3c?xml%20version='1.0'%20encoding='utf-8'?%3e%3c!--%20Generator:%20Adobe%20Illustrator%2023.0.1,%20SVG%20Export%20Plug-In%20.%20SVG%20Version:%206.00%20Build%200)%20--%3e%3csvg%20version='1.1'%20id='Layer_1'%20xmlns='http://www.w3.org/2000/svg'%20xmlns:xlink='http://www.w3.org/1999/xlink'%20x='0px'%20y='0px'%20viewBox='0%200%20270%20270'%20style='enable-background:new%200%200%20270%20270;'%20xml:space='preserve'%3e%3cstyle%20type='text/css'%3e%20.st0{fill:%23E01E5A;}%20.st1{fill:%2336C5F0;}%20.st2{fill:%232EB67D;}%20.st3{fill:%23ECB22E;}%20%3c/style%3e%3cg%3e%3cg%3e%3cpath%20class='st0'%20d='M99.4,151.2c0,7.1-5.8,12.9-12.9,12.9c-7.1,0-12.9-5.8-12.9-12.9c0-7.1,5.8-12.9,12.9-12.9h12.9V151.2z'/%3e%3cpath%20class='st0'%20d='M105.9,151.2c0-7.1,5.8-12.9,12.9-12.9s12.9,5.8,12.9,12.9v32.3c0,7.1-5.8,12.9-12.9,12.9%20s-12.9-5.8-12.9-12.9V151.2z'/%3e%3c/g%3e%3cg%3e%3cpath%20class='st1'%20d='M118.8,99.4c-7.1,0-12.9-5.8-12.9-12.9c0-7.1,5.8-12.9,12.9-12.9s12.9,5.8,12.9,12.9v12.9H118.8z'/%3e%3cpath%20class='st1'%20d='M118.8,105.9c7.1,0,12.9,5.8,12.9,12.9s-5.8,12.9-12.9,12.9H86.5c-7.1,0-12.9-5.8-12.9-12.9%20s5.8-12.9,12.9-12.9H118.8z'/%3e%3c/g%3e%3cg%3e%3cpath%20class='st2'%20d='M170.6,118.8c0-7.1,5.8-12.9,12.9-12.9c7.1,0,12.9,5.8,12.9,12.9s-5.8,12.9-12.9,12.9h-12.9V118.8z'/%3e%3cpath%20class='st2'%20d='M164.1,118.8c0,7.1-5.8,12.9-12.9,12.9c-7.1,0-12.9-5.8-12.9-12.9V86.5c0-7.1,5.8-12.9,12.9-12.9%20c7.1,0,12.9,5.8,12.9,12.9V118.8z'/%3e%3c/g%3e%3cg%3e%3cpath%20class='st3'%20d='M151.2,170.6c7.1,0,12.9,5.8,12.9,12.9c0,7.1-5.8,12.9-12.9,12.9c-7.1,0-12.9-5.8-12.9-12.9v-12.9H151.2z'/%3e%3cpath%20class='st3'%20d='M151.2,164.1c-7.1,0-12.9-5.8-12.9-12.9c0-7.1,5.8-12.9,12.9-12.9h32.3c7.1,0,12.9,5.8,12.9,12.9%20c0,7.1-5.8,12.9-12.9,12.9H151.2z'/%3e%3c/g%3e%3c/g%3e%3c/svg%3e",vn=t=>{const{isOpen:r,onClose:a}=t,{t:s}=W(),i=N.getAppVersion();return e.jsxs(Z,{isOpen:r,onClose:a,size:"xl",scrollBehavior:"inside",children:[e.jsx(V,{}),e.jsxs(F,{children:[e.jsx(K,{children:s("header.about.title")}),e.jsx(Y,{}),e.jsxs(q,{paddingBottom:10,children:[e.jsxs(nt,{direction:"row",children:[e.jsx(Pt,{boxSize:"128px",src:"/rmp//logo192.png"}),e.jsxs(nt,{direction:"column",width:"100%",alignItems:"center",justifyContent:"center",children:[e.jsx(b,{fontSize:"xl",as:"b",children:s("header.about.rmp")}),e.jsx(b,{children:i}),e.jsx(b,{}),e.jsx(b,{fontSize:"sm",children:s("header.about.railmapgen")})]})]}),e.jsx(H,{margin:5,children:e.jsx(b,{fontSize:"xl",children:s("header.about.desc")})}),e.jsx(ge,{as:"h5",size:"sm",mt:3,mb:2,children:s("header.about.contributors")}),e.jsx(ge,{as:"h6",size:"xs",my:2,children:s("header.about.coreContributors")}),e.jsxs(Ce,{children:[e.jsxs(J,{size:"lg",w:"85%",onClick:()=>window.open("https://github.com/thekingofcity","_blank"),cursor:"pointer",children:[e.jsx(X,{src:"https://github.com/thekingofcity.png",size:"lg",my:2,ml:-1,mr:2}),e.jsxs($,{display:"block",width:"100%",children:[e.jsx(b,{fontSize:"lg",fontWeight:"bold",mb:1,children:"thekingofcity"}),e.jsx(b,{fontSize:"sm",children:s("header.about.content1")}),e.jsx(b,{fontSize:"sm",align:"right",mb:1,children:s("header.about.content2")})]})]}),e.jsxs(J,{size:"lg",w:"85%",onClick:()=>window.open("https://github.com/langonginc","_blank"),cursor:"pointer",children:[e.jsx(X,{src:"https://github.com/langonginc.png",size:"lg",my:2,ml:-1,mr:2}),e.jsxs($,{display:"block",width:"100%",children:[e.jsx(b,{fontSize:"lg",fontWeight:"bold",mb:1,children:"langonginc"}),e.jsx(b,{fontSize:"sm",children:s("header.about.langonginc")}),e.jsx(b,{fontSize:"sm",align:"right",mb:1,children:"--Avicii"})]})]})]}),e.jsx(ge,{as:"h6",size:"xs",my:2,children:s("header.about.styleContributors")}),e.jsxs(Ce,{children:[e.jsxs(J,{size:"lg",w:"85%",onClick:()=>window.open("https://github.com/203IhzElttil","_blank"),cursor:"pointer",children:[e.jsx(X,{src:"https://github.com/203IhzElttil.png",size:"lg",my:2,ml:-1,mr:2}),e.jsxs($,{display:"block",width:"100%",children:[e.jsx(b,{fontSize:"lg",fontWeight:"bold",mb:1,children:"203IhzElttil"}),e.jsx(b,{fontSize:"sm",mb:1,children:s("header.about.203IhzElttil")})]})]}),e.jsxs(J,{size:"lg",w:"85%",onClick:()=>window.open("https://github.com/Swiftiecott","_blank"),cursor:"pointer",children:[e.jsx(X,{src:"https://github.com/Swiftiecott.png",size:"lg",my:2,ml:-1,mr:2}),e.jsxs($,{display:"block",width:"100%",children:[e.jsx(b,{fontSize:"lg",fontWeight:"bold",mb:1,children:"Swiftiecott"}),e.jsx(b,{fontSize:"sm",mb:1,children:s("header.about.Swiftiecott")})]})]})]}),e.jsx(ge,{as:"h5",size:"sm",mt:3,mb:2,children:s("header.about.contactUs")}),e.jsxs(Ce,{children:[e.jsxs(J,{size:"lg",w:"85%",onClick:()=>window.open("https://github.com/railmapgen/rmp/issues","_blank"),cursor:"pointer",children:[e.jsx(X,{src:yn,size:"lg",my:2,ml:-1,mr:2}),e.jsxs($,{display:"block",width:"100%",children:[e.jsx(b,{fontSize:"lg",fontWeight:"bold",mb:1,children:s("header.about.github")}),e.jsx(b,{fontSize:"sm",children:s("header.about.githubContent")})]})]}),e.jsxs(J,{size:"lg",w:"85%",onClick:()=>window.open("https://join.slack.com/t/railmapgenerator/shared_invite/zt-1odhhta3n-DdZF~fnVwo_q0S0RJmgV8A","_blank"),cursor:"pointer",children:[e.jsx(X,{src:Cn,size:"lg",my:2,ml:-1,mr:2}),e.jsxs($,{display:"block",width:"100%",children:[e.jsx(b,{fontSize:"lg",fontWeight:"bold",mb:1,children:s("header.about.slack")}),e.jsx(b,{fontSize:"sm",children:s("header.about.slackContent")}),e.jsx(b,{fontSize:"sm",as:"i",children:"#rmp, #gallery, #rmg, #palette-and-templates"})]})]})]})]})]})]})},zn=vn;function kn(t){return Gt({tag:"svg",attr:{viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round"},child:[{tag:"path",attr:{d:"M12 21a9 9 0 0 0 9 -9a9 9 0 0 0 -9 -9a9 9 0 0 0 -9 9a9 9 0 0 0 9 9z"},child:[]},{tag:"path",attr:{d:"M12 12m-4.5 0a4.5 4.5 0 1 0 9 0a4.5 4.5 0 1 0 -9 0"},child:[]}]})(t)}function An(t){return Gt({tag:"svg",attr:{version:"1.1",viewBox:"0 0 17 17"},child:[{tag:"g",attr:{},child:[]},{tag:"path",attr:{d:"M13 10v-10h-13v13h13v-3zM1 1h11v8h-0.755l-2.564-3.319-1.159 1.214-2.248-3.881-3.576 5.986h-0.698v-8zM9.982 9h-7.119l2.398-4.014 2.064 3.564 1.275-1.337 1.382 1.787zM1 12v-2h11v2h-11zM17 3v13h-13v-1.984h1v0.984h11v-11h-2v-1h3z"},child:[]}]})(t)}const On="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAFAAAABQCAMAAAC5zwKfAAAC9FBMVEUAAACabOutif+ve/+FbLiVcuaQaOCWb+WYceiLYtuccOingvOYcOeRad6ZcuifeumXcOWhfO6jfPCmhPOUa+aLYtyac+iVbuSMZN2VbeWNZt6RaeGRauKhee2acumQauClfvGTa+OOZd6JYNqWb+Sog/SSauGPaOCogvSNZN2NZN2ngfKogvSngPOfeu6bdemTauSlfvGYcOiohPSngfKQaOCXb+aifO+XcOaVbuWTbOOogfOlf/GmgPKTbOOYceaMZN2pg/WQaN+hee2OZt6RaeCRauGKYtuSa9+bdOmog/SifO+ddumie+6Zcuelf/GSa+Ked+uYcealf/GSauGJYdqpg/SQaOCJYduOZd6jffCJX9qNZN6mgfKMZN2SauKfeOyKYtuXcOWpg/SngfOdduuJYNqQaN+WbuWUbeWmgfOLY9yUbOWlf/GZceeKYNqOaN6mgvKpgvSZceiMZNyVb+WNZt2cdumSauOfee2Wb+WPaN+geu2ddeqMZNypg/Wheu6lf/GZcueJYNmQaN+jffCTbOSphPWog/SWb+WmgPKWb+aYcuekf/Gac+iKYtuVbuWWbuSogvSSa+KWb+SOZt6ifO+feeyngfKRaeGpg/SYcOefeOujfe+VbeSMZd6ac+iJYdqVbeSog/OVbOWcdeqKYtungvObdOmfd+uSa+KNZNyeduuRaeGjfe+XcOWMY9ybdOmngvSOZt6UbuWacuiSbOKgee2bdOmMY9yVbuOmgvSUbeKviP6xif+UaueVa+mMY92ZcOyqhPaOZOKuh/2shPybcu2mf/WhePKcdO6ddeyYb+qZceirhPmpgfmedfCacuuWbuWogfemffefdfKacuqSaOaPZeSRaOKyiv+qg/iogvShd/SYbuyWbeiQZuWNZN+MYt+thvqlffSie/CXbeqTaOeKYdu1jP+jevOccvCbce6Xbeuth/uqgvukevinf/eiePaVau2WbOqXb+ahdvuUaumfdPehee+thP6bb/MemaUsAAAAvXRSTlMAAwEEAwb+/Qv6Cfv8IRAOXiwaFP7++9p3TkwvJSEeGf7++/r59+ri0MmCeFZCPjk3NDEk9PHi4NLIwq2djHp1bmNZUVBIPzwU/v38+fj49/bz6+rl5N7a0s7Hw8LAvq+opqSjlZOSiIBuaGRjYmJaVU1HREQ1KykW+/X19O7r6OXf29vV0c3Mxry4taupnpqZlZGRi4uGgXxzbWtjWlJG8/Px7ezk3dfQwbq4tp2Zh3t6cVxaVtrXz7GdcGlhNM13AAAH1ElEQVRYw+1YVVgbQRDezd2RkODu7pS6u7u7u7u7u7u7u7slkCZESUKCuxQoLVD3vnSPSyW9S6ClD33o/xHOdv6b2f1nZhPwH//xz4EFcRwi/CU2RKY/hayK0+EYdWhr6eGN6CrKCEk6qzZNtwxY0Wtxr8EtK8qIob+Zo/v6i7Ozk8U54jeFMwFeoaUAcMIA/2RxrjhZ6O9v7n/szWjA+nMXkWWbAbni3Nzk3BXDhvUSmpsnZ08BsCJ8E/yTC8XCXqPbzHbpa24u/ODoUpE5hGBKbm6h44ApELj1TRLnvMm50IYUDoQ4UiWGQJBAB/IfXuaLcDB3RXLhsdFbwtyHfXjiKDa/51aWIKBJmRJgilBYOLXpmyfm2ULznNCWsHTRWZDgWLX1tvRwr9p6ZquWU5sjtDwyy9LqW0axjEd8NTm7Lwj7UohWw9Hx9OCBoQMHDx44MLRfv5V9goMX11qwwM8MISUlxcysVtDK8zsmuhOkHW40ZJds8WkOMUyY9CQ7R5jyITIp6UmkHlFRUW8RCkpKSjIzM2MyMwsKYmKyuq4e05owSokBN0ehGC3rkS39FvulILIoPSIjfZFXfgtq1QoK6hkcHNwzqFZX35ji4pismGLf+g/bIlsWY8jc0CeO5jfQKWf2zOZNXcLG7Nq1a0xY2NV9TSfcmOp2pHVV99keHpZeXmg+W0/dt61+z6yiGJ1U6tyEg6wZXWyVkyMUhnHLm6aWh7c5a6U6raLuYdKaBpRjTZPEwshQUi5IbKVxsCgZYjRQLrW9uU4n1SlU962QYBlTxS/KL8nsghundBIIAofMFQ6SiqFIW63TJrIz6s5CNximEbQJjUryi0rpN6aVN/USjMAgi17hWHoZkiSTaycEJMy/xTSRLBxwXYJLIs0iM836DGnsZknoXcIxXJ8WLETnbeNOMeqvvTbKLbSJBxiXhhzustKhxME361GBWc/6l/a18uB89w2WumTjHFt7zo86CdFbxypVKsUBetR64Vu1vNTHLKsgqyDz0aMs36DVQ3aMc61qyaUmpfoGrSrx9WFA/Jy1YLJTYjulDWBKROqmVevGQ/p0dXiEEEN+fLsGrd7qygXWY+cr2FrpcA6Ahia3nNopnWYAjLnrUYOtZk3ccf72cZ20qKiY5E2Q1h9XL0P3LsHZ5tfpghDYKJ3kpzwBZrwvU2dzq9qMHV7f+WSAtIiti03QshMCdralTT+pwibPnOIvskxUeCQ04ttT69kzXHfOfxcQoIpdVwUtHaPkNsd3jL8G8LLKrte4nY1noGnnbmWz32V0PwCRUpiLi/XZZ8pu1QFmui1UdU5QKLS1m9jUTmArFBs9qNLCzFi5ozJ+qMkuhAOi3ssAaaxOoZCi/Ko9mZx+E014VN4n5CJhqi3MOa7S1a3HZltYSJXDLUk3TI5elB+/x9SGCANzl8cmbtj2jm2R0d2Gthj0cjU079U5DEBTvfpKLFulstDKN3jS3aO//2B+3lKkRVNREHVjLSwyOjdBEwrL7sTVFubNq2yCED2Z3F1l8bouqb3ybBW8lsryWwBonA9FnJiYMdyKWtyyPbSvI8s7BKBRPtbm1xZKVZPSelIuQrulr3yMeggB3Piys7y7K6llDC/X7sh24asOEVT2MSYn4ltuC6haDcuzXW2RH9fDFh2ZdX/ttZP8rBdyD/F5o/jL4eHuuBerrAHO/LZZnZWxy70AQTKNPTlkbhl1BEKk6P4aSUPmYBDJqJftjlYBBMnt7vDx/TiTwqH8r9JJFjeJeRwOrO/K5aNK8xICb+f3Dq4GA1m/9lZgd7kR3C3RLLMHXMaIUaLLlS3QkSpiW28alCVIZq5hGjd8KhlUJ12y3p756xIOKjvJj1YH8Ec8LMP4DOseIkztEifz8emybKQnumQgnNHu2SIkmW8zDg348Mb1Jv7isl3/p+k+6XFxaYIelRgYMVCl47OOVQDOLA/XovcOyH0DnzmNaqplXWQSXnTaJADphJ6nnuUfREdmwuKPBoQQWI/cZGsfUdk2YlMaj3+iBs0QAuJcfN5QNNuMEmEZhozMw58+7bHXljw/xEt/3gxg9ETZE/+pWzVaWWBeFByMT+epU3khjabVaFZTpKYTohu23fLjLwIjjCxDbSDzQfzA9qJoQfuaj3kCKmSayagX817tZmCkawZZT6qZns4TCdSP+aJUwX4AGavlHc082Z6yaj/VusJFoseBlaaP6B3YPnANKRvmxr1Q1kkz1A6dYkZLTWml9Gwg4Imej0eX9tUiqhHGej0E0zppOr2oc5BL2jF2W0h6Z319SWpgtGg8GvRjQ2ikJFau87mDTNN/vJ1+rw5Z3wEhTrIBu/0hAjXv6ZJpiB6ZYGiQqW/4nps0cR1exNW53MLu+034IxGtp4/szee35/Mb1ChXHyNjOLRKkybTSHyWNQifXoPz0zP7as0anuHxo0XR/JBKtD2UiU7KmdS/g0SSlqZW+/QIWd+wUfj1B+F7t48Y1DvwMf/5Y75AtKYZlxxYTpCBwIjtq7pI+BK1WhLN50cj8AUCRBYtSBX1HjENI0f99k85EXsbnKmZxhcgJgSBIDVVIFqydnslO0qIZYIuDlJjlcJHNhi0NiRkzdr1Ixrtn16Dq9f1HwD/bga5HGuOPh1pkv9NPw3FDXHyukKgRIhTH1Q9/uM//nl8BYlod8WjsBdLAAAAAElFTkSuQmCC",Mn="/rmp/assets/opencollective-icon-Ciasch0w.webp",En=t=>{const{isOpen:r,onClose:a}=t,{t:s}=W(),{telemetry:{project:i}}=P(l=>l.app),o=()=>{N.isStandaloneWindow()?window.open("/rmp-gallery/#/donation","_blank"):N.openApp({appId:"rmp-gallery",hash:"/donation"})},n=l=>new URLSearchParams({title:"Donation: New ".concat(l," request for [city name]"),body:"Hi, I'd like to have new ".concat(l,", and here is my support.\n\n<!-- your donation entry -->\n\n<!-- reference (images or URLs) -->\n\n")}).toString();return x.useEffect(()=>{r&&i&&N.event(me.OPEN_DONATION,{})},[r]),e.jsxs(Z,{isOpen:r,onClose:a,size:"xl",scrollBehavior:"inside",children:[e.jsx(V,{}),e.jsxs(F,{children:[e.jsx(K,{children:s("header.donation.title")}),e.jsx(Y,{}),e.jsxs(q,{paddingBottom:10,children:[e.jsxs(nt,{direction:"row",alignItems:"center",justifyContent:"space-around",children:[e.jsx(b,{fontSize:"96px",fontFamily:"serif",children:"I"}),e.jsx(ts,{size:"64px",color:"red"}),e.jsx(Pt,{boxSize:"96px",src:"/rmp//logo192.png"})]}),e.jsx(H,{margin:5,children:e.jsx(b,{fontSize:"xl",children:s("header.donation.content")})}),e.jsx(ge,{as:"h5",size:"sm",mb:2,children:s("header.donation.rewards")}),e.jsxs(Ce,{children:[e.jsxs(J,{size:"lg",w:"85%",onClick:o,cursor:"pointer",children:[e.jsx(X,{icon:e.jsx(An,{}),size:"lg",my:2,ml:-1,mr:2}),e.jsxs($,{display:"block",width:"100%",pb:1,children:[e.jsx(b,{fontSize:"lg",fontWeight:"bold",mb:1,children:s("header.donation.gallery")}),e.jsx(b,{fontSize:"sm",children:s("header.donation.galleryContent")})]})]}),e.jsxs(J,{size:"lg",w:"85%",onClick:()=>window.open("https://github.com/railmapgen/rmp/issues/new?"+n("stations/nodes"),"_blank"),cursor:"pointer",children:[e.jsx(X,{icon:e.jsx(kn,{}),size:"lg",my:2,ml:-1,mr:2}),e.jsxs($,{display:"block",width:"100%",pb:1,children:[e.jsx(b,{fontSize:"lg",fontWeight:"bold",mb:1,children:s("header.donation.nodes")}),e.jsx(b,{fontSize:"sm",children:s("header.donation.nodesContent")})]})]}),e.jsxs(J,{size:"lg",w:"85%",onClick:()=>window.open("https://github.com/railmapgen/rmp/issues/new?"+n("features"),"_blank"),cursor:"pointer",children:[e.jsx(X,{icon:e.jsx(vs,{}),size:"lg",my:2,ml:-1,mr:2}),e.jsxs($,{display:"block",width:"100%",pb:1,children:[e.jsx(b,{fontSize:"lg",fontWeight:"bold",mb:1,children:s("header.donation.features")}),e.jsx(b,{fontSize:"sm",children:s("header.donation.featuresContent")})]})]})]}),e.jsx(ge,{as:"h5",size:"sm",mt:3,mb:2,children:s("header.donation.methods")}),e.jsxs(Ce,{children:[e.jsxs(J,{size:"lg",w:"85%",onClick:()=>window.open("https://opencollective.com/rail-map-toolkit","_blank"),cursor:"pointer",children:[e.jsx(X,{src:Mn,size:"lg",my:2,ml:-1,mr:2}),e.jsxs($,{display:"block",width:"100%",pb:1,children:[e.jsx(b,{fontSize:"lg",fontWeight:"bold",mb:1,children:s("header.donation.openCollective")}),e.jsx(b,{fontSize:"sm",children:s("header.donation.viaUSD")})]})]}),e.jsxs(J,{size:"lg",w:"85%",onClick:()=>window.open("https://afdian.com/a/rail-map-toolkit","_blank"),cursor:"pointer",children:[e.jsx(X,{src:On,size:"lg",my:2,ml:-1,mr:2}),e.jsxs($,{display:"block",width:"100%",pb:1,children:[e.jsx(b,{fontSize:"lg",fontWeight:"bold",mb:1,children:s("header.donation.afdian")}),e.jsx(b,{fontSize:"sm",children:s("header.donation.viaCNY")})]})]})]})]})]})]})},Tn=En;/*!
 * canvas-size
 * v2.0.0
 * https://github.com/jhildenbiddle/canvas-size
 * (c) 2015-2024 John Hildenbiddle <http://hildenbiddle.com>
 * MIT license
 */function _e(t){const r=t.sizes.shift(),a=Math.max(Math.ceil(r[0]),1),s=Math.max(Math.ceil(r[1]),1),i=[a-1,s-1,1,1],o=performance.now(),n=typeof WorkerGlobalScope<"u"&&self instanceof WorkerGlobalScope;let l,d;n?(l=new OffscreenCanvas(1,1),d=new OffscreenCanvas(a,s)):(l=document.createElement("canvas"),l.width=1,l.height=1,d=document.createElement("canvas"),d.width=a,d.height=s);const c=l.getContext("2d"),g=d.getContext("2d");g&&(g.fillRect.apply(g,i),c.drawImage(d,a-1,s-1,1,1,0,0,1,1));const u=c&&c.getImageData(0,0,1,1).data[3]!==0,p=parseInt(performance.now()-o);return[l,d].forEach(h=>{h.height=0,h.width=0}),n?(postMessage({width:a,height:s,testTime:p,isTestPass:u}),!u&&t.sizes.length&&setTimeout(()=>{_e(t)},0)):u?t.onSuccess({width:a,height:s,testTime:p}):(t.onError({width:a,height:s,testTime:p}),t.sizes.length&&setTimeout(()=>{_e(t)},0)),u}const $e={area:[16384,14188,11402,11180,10836,8192,4096,1],height:[8388607,65535,32767,16384,8192,4096,1],width:[4194303,65535,32767,16384,8192,4096,1]},ye={max:null,min:1,sizes:[],step:1024,useWorker:!1,onError:Function.prototype,onSuccess:Function.prototype},Te={};function Qe(t){const r=t.width===t.height,a=t.height===1,s=t.width===1,i=[];if(!t.width||!t.height)t.sizes.forEach(o=>{const n=r||a?o:1,l=r||s?o:1;i.push([n,l])});else{const o=t.min||ye.min,n=t.step||ye.step;let l=Math.max(t.width,t.height);for(;l>=o;){const d=r||a?l:1,c=r||s?l:1;i.push([d,c]),l-=n}}return i}function We(t){const r=typeof window<"u",a=r&&"Promise"in window,s=r&&"HTMLCanvasElement"in window,i=r&&"OffscreenCanvas"in window,o=URL.createObjectURL(new Blob([])).slice(-36),n=performance.now(),{onError:l,onSuccess:d,...c}=t,g=()=>parseInt(performance.now()-n);let u=null;if(!s)return!1;if(t.useWorker&&i){const p="\n            var canvasTest = ".concat(_e.toString(),";\n            onmessage = function(e) {\n                canvasTest(e.data);\n            };\n        "),h=new Blob([p],{type:"application/javascript"}),m=URL.createObjectURL(h);u=new Worker(m),URL.revokeObjectURL(m),u.onmessage=function(j){const{width:f,height:w,testTime:S,isTestPass:y}=j.data,k={width:f,height:w,testTime:S,totalTime:g()};y?(Te[o].onSuccess(k),delete Te[o]):Te[o].onError(k)}}if(a)return new Promise(p=>{const h={...t,onError(m){let{width:j,height:f,testTime:w}=m;const S={width:j,height:f,testTime:w,totalTime:g()};let y;if(t.sizes.length===0)y=!0;else{const[[k,O]]=t.sizes.slice(-1);y=j===k&&f===O}l(S),y&&p({...S,success:!1})},onSuccess(m){let{width:j,height:f,testTime:w}=m;const S={width:j,height:f,testTime:w,totalTime:g()};d(S),p({...S,success:!0})}};if(u){const{onError:m,onSuccess:j}=h;Te[o]={onError:m,onSuccess:j},u.postMessage(c)}else _e(h)});if(u)Te[o]={onError:l,onSuccess:d},u.postMessage(c);else return _e(t)}const Rn={maxArea(){let t=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};const r=Qe({width:t.max,height:t.max,min:t.min,step:t.step,sizes:[...$e.area]}),a={...ye,...t,sizes:r};return We(a)},maxHeight(){let t=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};const r=Qe({width:1,height:t.max,min:t.min,step:t.step,sizes:[...$e.height]}),a={...ye,...t,sizes:r};return We(a)},maxWidth(){let t=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};const r=Qe({width:t.max,height:1,min:t.min,step:t.step,sizes:[...$e.width]}),a={...ye,...t,sizes:r};return We(a)},test(){let t=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};const r={...ye,...t};return r.sizes=[...r.sizes],r.width&&r.height&&(r.sizes=[[r.width,r.height]]),We(r)}},rt=(t,r,a)=>{const s=new Blob([a],{type:r});ns(t,s)},ns=(t,r)=>{const a=window.URL.createObjectURL(r),s=document.createElement("a");s.href=a,s.download=t,document.body.appendChild(s),s.click(),document.body.removeChild(s),window.URL.revokeObjectURL(a)},Nn=async(t,r,a,s)=>{const{xMin:i,yMin:o,xMax:n,yMax:l}=qt(t),[d,c]=[n-i,l-o],g=document.getElementById("canvas").cloneNode(!0);[...g.children].filter(p=>t.hasNode(p.id)&&t.getNodeAttribute(p.id,"type")===ze.Virtual).forEach(p=>g.removeChild(p)),r||g.appendChild(Ln(n-400,l-120)),g.setAttribute("viewBox","".concat(i," ").concat(o," ").concat(d," ").concat(c)),g.setAttribute("width",d.toString()),g.setAttribute("height",c.toString()),Object.entries({".rmp-name-outline":["paint-order","stroke","stroke-linejoin"]}).forEach(([p,h])=>{const m=document.querySelector(p);if(m===null)return;const j=window.getComputedStyle(m);g.querySelectorAll(p).forEach(f=>{if(p===".rmp-name-outline"&&s===1.1){const w=f.insertAdjacentElement("afterend",f.cloneNode(!0));w&&(w.classList.remove(p.slice(1)),w.classList.length===0&&f.removeAttribute("class"),w.removeAttribute("stroke-width"))}h.forEach(w=>{f.setAttribute(w,j.getPropertyValue(w))}),f.classList.remove(p.slice(1)),f.classList.length===0&&f.removeAttribute("class")})}),g.querySelectorAll('[fill="url(#opaque)"]').forEach(p=>{p.setAttribute("fill","white"),p.setAttribute("fill-opacity","0")});const u=bn(t);return await _n(g,t,u,a),await In(g,t,u),{elem:g,width:d,height:c}},_n=async(t,r,a,s)=>{var o;const i=new Set;if(Object.keys(Xe).filter(n=>a[n]).forEach(n=>i.add(n)),r.filterNodes((n,l)=>n.startsWith("misc_node_")&&l.type===ze.Text).map(n=>r.getNodeAttribute(n,ze.Text).language).map(n=>gn[n]).filter(n=>n!==I.ShmetroBasic).forEach(n=>i.add(n)),s)[".rmp-name__zh",".rmp-name__en"].forEach(n=>{t.querySelectorAll(n).forEach(l=>{l.classList.remove(n.slice(1)),l.classList.length===0&&l.removeAttribute("class")})}),i.forEach(n=>{Xe[n].className.forEach(l=>{t.querySelectorAll(l).forEach(d=>{d.classList.remove(l.slice(1)),d.classList.length===0&&d.removeAttribute("class")})})});else{const n=document.createElement("style");for(let l=0;l<document.styleSheets.length;l=l+1)if((o=document.styleSheets[l].href)!=null&&o.endsWith("styles/fonts.css")){n.textContent=[...document.styleSheets[l].cssRules].map(d=>d.cssText).join("\n");break}t.prepend(n),await Promise.all([...i.values()].map(l=>Xe[l]).map(async({cssName:l,cssFont:d})=>{try{t.prepend(await mn(d,l))}catch(c){alert("Failed to load fonts. Fonts in the exported PNG will be missing."),console.error(c)}}))}},In=async(t,r,a)=>{if(a[ze.Facilities]){const s=r.filterNodes((l,d)=>d.type===ze.Facilities),i=Object.fromEntries(Object.values(xn).map(l=>[l,[]]));s.forEach(l=>{var c;const d=(c=r.getNodeAttribute(l,ze.Facilities))==null?void 0:c.type;d&&i[d].push(l)});const o=Object.entries(i).filter(([l,d])=>d.length>0).map(([l,d])=>l),n=await Promise.all((await Promise.all(o.map(async l=>await fetch("/rmp//images/facilities/".concat(l,".svg"))))).map(l=>l.text()));o.forEach((l,d)=>{const c=document.createElement("div");c.innerHTML=n[d];const g=c.querySelector("svg"),u=document.createElementNS("http://www.w3.org/2000/svg","symbol");for(const p of g.attributes)u.setAttribute(p.name,p.value);for(;g.firstChild;)u.appendChild(g.firstChild);g.replaceWith(u),u.id=l,t.appendChild(u),i[l].forEach(p=>{const h=t.querySelector("#".concat(p)),m=h==null?void 0:h.querySelector("image");if(m){h.removeChild(m);const j=document.createElementNS("http://www.w3.org/2000/svg","use");j.setAttribute("href","#".concat(l)),j.setAttribute("height",u.getAttribute("height")),j.setAttribute("width",u.getAttribute("width")),h.appendChild(j)}}),c.remove()})}},Ln=(t,r)=>{const a=document.createElementNS("http://www.w3.org/2000/svg","g");a.setAttribute("transform","translate(".concat(t,", ").concat(r,")scale(2)"));const s=document.createElementNS("http://www.w3.org/2000/svg","image");s.setAttribute("width","40"),s.setAttribute("height","40"),s.setAttribute("x","-50"),s.setAttribute("y","-20");const i=document.createElementNS("http://www.w3.org/2000/svg","text");i.setAttribute("font-family","Arial, sans-serif"),i.setAttribute("font-size","16"),i.appendChild(document.createTextNode("Rail Map Painter"));const o=document.createElementNS("http://www.w3.org/2000/svg","text");return o.setAttribute("font-family","Arial, sans-serif"),o.setAttribute("font-size","10"),o.setAttribute("y","10"),o.appendChild(document.createTextNode("https://railmapgen.github.io/rmp/")),a.appendChild(s),a.appendChild(i),a.appendChild(o),a};var Ie=(t=>(t.left="l",t.right="r",t))(Ie||{}),ue=(t=>(t.through="through",t.nonThrough="nonthrough",t))(ue||{}),De=(t=>(t.local="local",t.express="express",t.direct="direct",t))(De||{}),le=(t=>(t.MTR="mtr",t.GZMTR="gzmtr",t.SHMetro="shmetro",t))(le||{}),ft=(t=>(t.sh="sh",t.sh2020="sh2020",t))(ft||{});const ne=new Set,at=new Set,lt=new Set,ct=new Set,dt=new Map,ce=new Map,et=new Set,tt=new Map,U=new Map;let _=[],Re=0;const Ge=new Map,st=new Map,ht=new Set,Hn={name:["LEFT END","LEFT END"],num:"00",services:[De.local],parents:[],children:["lineend"],transfer:{groups:[{}],tick_direc:Ie.right,paid_area:!0},loop_pivot:!1,one_line:!0,int_padding:355},Wn={name:["RIGHT END","RIGHT END"],num:"00",services:[De.local],parents:[],children:[],transfer:{groups:[{}],tick_direc:Ie.right,paid_area:!0},loop_pivot:!1,one_line:!0,int_padding:355},Bn={},os={svgWidth:{destination:1500,runin:1500,railmap:1500,indoor:1500},svg_height:400,style:le.SHMetro,y_pc:50,padding:10,branchSpacingPct:33,direction:Ie.right,platform_num:"1",theme:[zs.Shanghai,"sh1","#E3002B",xt.white],line_name:["地鐵線","Metro Line"],current_stn_idx:"jlaMj2",stn_list:Bn,namePosMTR:{isStagger:!0,isFlip:!0},customiseMTRDest:{isLegacy:!1,terminal:!1},line_num:"1",psd_num:"1",info_panel_type:ft.sh,direction_gz_x:40,direction_gz_y:70,coline:{},loop:!1,loop_info:{bank:!0,left_and_right_factor:0,bottom_factor:1}},Pn={name:["",""],num:"",services:[De.local],parents:[],children:[],transfer:{groups:[{}],tick_direc:Ie.right,paid_area:!0},loop_pivot:!1,one_line:!0,int_padding:355},v=t=>"".concat(t[0],"/").concat(t[1],"=").concat(t[2]).concat(t[3]),jt=t=>Jt.includes(t),Gn=t=>{if(jt(t.style))return structuredClone(t[t.style].color)},Dn=(t,r)=>{const[a,s]=t.extremities(r),i=t.getEdgeAttributes(r),o=i.style;if(a!=s&&jt(o)){const n=Gn(i);ct.has(v(n))||(lt.add(n),ct.add(v(n)),dt.set(n,a),ce.set(v(n),new Set)),ce.get(v(n)).add(a),ce.get(v(n)).add(s),U.has(a)?_.push({target:s,next:U.get(a),color:n}):_.push({target:s,next:-1,color:n}),U.set(a,Re),Re++,U.has(s)?_.push({target:a,next:U.get(s),color:n}):_.push({target:a,next:-1,color:n}),U.set(s,Re),Re++}},is=(t,r,a)=>{if(ce.get(v(a)).has(t)){ce.get(v(a)).delete(t);for(let s=U.get(t);s!=-1;s=_[s].next){const i=_[s].target,o=_[s].color;v(o)==v(a)&&is(i,t,a)}}},rs=(t,r,a)=>{if(ne.has(t))return;ne.add(t);let s=0;const i=new Set;for(let o=U.get(t);o!=-1;o=_[o].next){const n=_[o].target,l=_[o].color;v(l)==v(a)&&(i.has(n)||(i.add(n),s++,n!=r&&rs(n,t,a)))}Ge.set(t,s)},Ht=(t,r)=>{const a=t.stn_list.lineend.parents;a.push(r),t.stn_list.lineend.parents=structuredClone(a).reverse(),t.stn_list.lineend.branch={...t.stn_list.lineend.branch,left:t.stn_list.lineend.parents.length==2?[ue.through,a[1]]:void 0}},Un=(t,r)=>{let a=0;for(let s=U.get(t);s!=-1;s=_[s].next){_[s].target;const i=_[s].color;v(i)==v(r)&&a++}return a},as=(t,r,a)=>{if(ht.has(t))return[];ht.add(t);const s=[];for(let i=U.get(t);i!=-1;i=_[i].next){const o=_[i].target,n=_[i].color;o!=r&&v(n)==v(a)&&(o.startsWith("stn")?s.push(o):s.push(...as(o,t,a)))}return s},pt=(t,r,a,s,i,o,n)=>{var p;if(ne.has(t)&&(!t.startsWith("misc_node_")&&n.stn_list[t]==null||t.startsWith("misc_node_")&&!at.has(t)||n.loop))return[];if(ne.has(t)&&n.stn_list[t]!=null&&Un(t,o)-1>=2){const h=[...n.stn_list[t].parents,r];if(n.stn_list[h[1]]==null){const f=h[0];h[0]=h[1],h[1]=f}n.stn_list[t].parents=structuredClone(h).reverse(),n.stn_list[t].branch={...n.stn_list[t].branch,left:[ue.through,h[1]]};const m=[];for(const f of n.stn_list[t].children)f!=r&&m.push(f);n.stn_list[t].children=structuredClone(m),(p=n.stn_list[t].branch)==null||delete p.right;const j=[];for(const f of n.stn_list.lineend.parents)f!=t&&j.push(f);return n.stn_list.lineend.parents=structuredClone(j).reverse(),n.stn_list.lineend.branch={...n.stn_list.lineend.branch,left:n.stn_list.lineend.parents.length==2?[ue.through,j[1]]:void 0},m.length==0&&(n.stn_list[t].children=["lineend"],Ht(n,t)),[t]}ne.add(t);const l=[],d=[],c=[],g=new Set,u=new Set;for(let h=U.get(t);h!=-1;h=_[h].next){const m=_[h].target,j=_[h].color;if(m!=a){if(v(j)==v(o)){if(u.has(m))continue;if(u.add(m),t.startsWith("misc_node_")){const f=pt(m,r,t,s+1,i,o,n);f.length!=0&&l.push(...f)}else{const f=pt(m,t,t,s+1,i,o,n);f.length!=0&&l.push(...f)}}if(!g.has(v(j))&&v(j)!=v(o)){g.add(v(j));const f={theme:j,name:["ch_".concat(v(j)),"en_".concat(v(j))]};c.push(f)}}}if(l.length==2){for(let h=0;h<2;h++)l[h]=="lineend"&&l.splice(h,1);if(n.stn_list[l[1]].parents.length>=2){const h=l[0];l[0]=l[1],l[1]=h}}if(ne.has(t)&&n.stn_list[t]!=null){const h=[];for(const m of n.stn_list.lineend.parents)m!=t&&h.push(m);n.stn_list.lineend.parents=structuredClone(h).reverse(),n.stn_list.lineend.branch={...n.stn_list.lineend.branch,left:n.stn_list.lineend.parents.length==2?[ue.through,h[1]]:void 0},l.length==0&&(ht.clear(),d.push(...as(t,r,o)))}if(t.startsWith("misc_node_"))return at.add(t),l;{const h=i.getNodeAttributes(t).type,m=i.getNodeAttributes(t)[h];if(n.stn_list[t]=structuredClone(Pn),n.stn_list[t].name=[m.names[0],m.names[1]],n.stn_list[t].num=String(s),i.getNodeAttributes(t).type==I.GzmtrBasic){const j=m;n.stn_list[t].num=j.stationCode,n.stn_list[t].secondaryName=j.secondaryNames}if(i.getNodeAttributes(t).type==I.GzmtrInt){const j=m,f=j.transfer[0];for(const w of f)if(v(w)==v(o)){n.stn_list[t].num=String(w[5]);break}n.stn_list[t].secondaryName=j.secondaryNames}return l.length!=0?(n.stn_list[t].children=structuredClone(l).reverse(),l.length==2&&(n.stn_list[t].branch={...n.stn_list[t].branch,right:[ue.through,l[1]]})):(n.stn_list[t].children=["lineend"],Ht(n,t)),d.push(r),n.stn_list[t].parents=structuredClone(d).reverse(),d.length==2&&(n.stn_list[t].branch={...n.stn_list[t].branch,left:[ue.through,d[1]]}),c.length!=0&&(n.stn_list[t].transfer.groups[0].lines=structuredClone(c)),[t]}},Zn=(t,r,a,s)=>{const i=structuredClone(os);s=="LOOP"&&(i.loop=!0);let o;switch(t.getNodeAttributes(a).type){case I.GzmtrBasic:case I.GzmtrInt:o=le.GZMTR;break;case I.MTR:o=le.MTR;break;default:o=le.SHMetro;break}i.theme=structuredClone(r),i.style=o,i.stn_list.linestart=structuredClone(Hn),i.stn_list.lineend=structuredClone(Wn),ne.clear(),at.clear();const n=pt(a,"linestart","linestart",1,t,r,i);if(i.current_stn_idx=n[0],i.stn_list.linestart.children=[n[0]],!(Object.keys(i.stn_list).length<=3||i.stn_list.lineend.parents.length>=3))return structuredClone(i)},Vn=t=>{ne.clear(),lt.clear(),ct.clear(),dt.clear(),ce.clear(),et.clear(),tt.clear(),U.clear(),_=[],Re=0,Ge.clear(),st.clear(),t.filterEdges(s=>s.startsWith("line")).forEach(s=>{jt(t.getEdgeAttributes(s).style)&&Dn(t,s)});let r=0;t.forEachNode(s=>{st.set(s,++r)}),st.set("lineend",++r);const a=[];for(const s of lt){let i=0;for(;ce.get(v(s)).size!=0;){let o="line_root";ce.get(v(s)).forEach(l=>{o=="line_root"&&(o=l)}),is(o,"line_root",s);const n={theme:s,index:++i};et.add(n),tt.set(n,o)}}for(const s of et){const{theme:i}=s;ne.clear(),Ge.clear(),rs(tt.get(s),"line_root",i);let o=!0,n="LINE";const l=[];for(const[c,g]of Ge)g==1&&l.push(c),g==3&&(n="BRANCH"),g>3&&(o=!1);if(!o)continue;l.length==0&&(n="LOOP",l.push(dt.get(i)));const d=[];for(const c of l){const g=Zn(t,i,c,n);g!=null&&d.push([g,g.stn_list[g.current_stn_idx].name[0],g.stn_list[g.current_stn_idx].name[1]])}d.length!=0&&a.push({id:ot(10),theme:i,param:structuredClone(d),type:n})}return a},Fn=t=>t[0]!=""&&t[1]!=""?t[0]+"_"+t[1]:t[0]!=""?t[0]:t[1]!=""?t[1]:"".concat(new Date().valueOf()),Kn=(t,r)=>{let a=t;return r.forEach((s,i)=>{const o=new RegExp("ch_".concat(i),"g"),n=new RegExp("en_".concat(i),"g");a=a.replace(o,s[0]),a=a.replace(n,s[1])}),a},Yn=(t,r,a,s)=>{t.line_name=r,t.line_num=String(a),rt("RMG_".concat(Fn(r),".json"),"application/json",Kn(JSON.stringify(t),s))},qn={LINE:"#33ccff",BRANCH:"#007B61",LOOP:"#ff6666"},Jn=t=>{const{isOpen:r,onClose:a}=t,{t:s}=W(),i=x.useRef(window.graph),[o,n]=x.useState(!1),[l,d]=x.useState([[os,"",""]]),[c,g]=x.useState(["","",""]),[u,p]=x.useState(new Map),[h,m]=x.useState(new Map),[j,f]=x.useState([]);x.useEffect(()=>{if(r){const S=Vn(i.current),y=new Map;S.forEach(({id:k,theme:O})=>{y.set(v(O),k)}),f(S),p(y)}},[r]);const w=(S,y)=>document.getElementById("2RMG_"+y+"_"+S).value.trim();return e.jsxs(Z,{isOpen:r,onClose:a,size:"2xl",scrollBehavior:"inside",children:[e.jsx(V,{}),e.jsxs(F,{children:[e.jsx(K,{children:e.jsx(b,{as:"b",fontSize:"xl",children:s("header.download.2rmg.title")})}),e.jsx(Y,{}),e.jsxs(q,{children:[e.jsx(b,{fontSize:"sm",mt:"3",lineHeight:"100%",children:s("header.download.2rmg.info1")}),e.jsx(b,{fontSize:"sm",mt:"3",lineHeight:"100%",children:s("header.download.2rmg.info2")}),e.jsx("br",{}),j.length===0?e.jsx(b,{fontSize:"md",children:s("header.download.2rmg.noline")}):e.jsx("table",{children:e.jsx("tbody",{children:j.map(({id:S,theme:y,param:k,type:O})=>e.jsxs("tr",{children:[e.jsx("td",{children:e.jsx(At,{name:y[0]=="other"&&y[1]=="other"?y[2]:y[1],bg:y[2],fg:y[3]})}),e.jsx("td",{children:e.jsx(Ke,{placeholder:s("header.download.2rmg.placeholder.chinese"),id:"2RMG_nameCh_".concat(S),size:"sm"})}),e.jsx("td",{children:e.jsx(Ke,{placeholder:s("header.download.2rmg.placeholder.english"),id:"2RMG_nameEn_".concat(S),size:"sm"})}),e.jsx("td",{children:e.jsx(Ke,{placeholder:s("header.download.2rmg.placeholder.lineCode"),id:"2RMG_lineNum_".concat(S),size:"sm"})}),e.jsx("td",{children:e.jsx(At,{name:s("header.download.2rmg.type.".concat(O.toLowerCase())),bg:qn[O],fg:xt.white})}),e.jsx("td",{children:e.jsx(R,{colorScheme:"blue",variant:"ghost",mr:"1",onClick:()=>{const B=w(S,"nameCh"),oe=w(S,"nameEn"),Oe=w(S,"lineNum"),ie=new Map;u.forEach((re,L)=>{ie.set(L,[w(re,"nameCh"),w(re,"nameEn")])}),d(k),g([B,oe,Oe]),m(ie),n(!0)},size:"sm",children:e.jsx(Xt,{})})})]},JSON.stringify(y)))})})]}),e.jsx(pe,{children:e.jsx(R,{colorScheme:"blue",variant:"outline",mr:"1",onClick:a,children:s("close")})})]}),e.jsx(Xn,{isOpen:o,onClose:()=>n(!1),param:l,nameList:c,interchangeName:h})]})},Xn=t=>{const{isOpen:r,onClose:a,param:s,nameList:i,interchangeName:o}=t,{t:n}=W(),[l,d]=x.useState("");return x.useEffect(()=>{i[0]!=""&&i[1]!=""?d(i[0]+"/"+i[1]):i[0]!=""?d(i[0]):i[1]!=""?d(i[1]):d("")},[...i]),e.jsxs(Z,{isOpen:r,onClose:a,size:"md",scrollBehavior:"inside",children:[e.jsx(V,{}),e.jsxs(F,{children:[e.jsx(K,{children:e.jsxs(b,{as:"b",fontSize:"xl",children:[n("header.download.2rmg.download")," ",l]})}),e.jsx(Y,{}),e.jsx(q,{children:e.jsxs(us,{children:[e.jsx(b,{fontSize:"sm",mb:"2",lineHeight:"100%",children:n("header.download.2rmg.downloadInfo")}),s.map(([c,g,u])=>e.jsxs(R,{onClick:()=>{Yn(c,[i[0],i[1]],i[2],o)},overflow:"hidden",size:"md",textOverflow:"ellipsis",whiteSpace:"nowrap",display:"ruby",children:[g.replaceAll("\\","⏎"),"/",u.replaceAll("\\","⏎")]},"".concat(g).concat(u)))]})}),e.jsx(pe,{children:e.jsx(R,{colorScheme:"blue",variant:"outline",mr:"1",onClick:a,children:n("close")})})]})]})},$n=t=>{const{isOpen:r,onClose:a}=t,{t:s}=W();return e.jsxs(Z,{isOpen:r,onClose:a,size:"xl",scrollBehavior:"inside",children:[e.jsx(V,{}),e.jsxs(F,{children:[e.jsx(K,{children:s("header.download.termsAndConditions")}),e.jsx(Y,{}),e.jsx(q,{children:e.jsxs(gs,{children:[e.jsxs(be,{children:["The layout of the elements on the signage or rail map, is designed by"," ",e.jsxs(M,{color:"teal.500",href:"https://www.shmetro.com/",isExternal:!0,children:["Shanghai Shentong Metro Group ",e.jsx(T,{as:E})]}),", ",e.jsxs(M,{color:"teal.500",href:"https://www.gzmtr.com/",isExternal:!0,children:["Guangzhou Metro Group ",e.jsx(T,{as:E})]})," or ",e.jsxs(M,{color:"teal.500",href:"https://www.mtr.com.hk/",isExternal:!0,children:["MTR Corporation ",e.jsx(T,{as:E})]}),", depending on your selection. You shall grant appropriate permit or license from the relevant company above before using the generated images for commercial purposes, if it is required to do so.",e.jsx("br",{}),"标志版或路线图的元素或布局，基于你所选择的风格，为",e.jsxs(M,{color:"teal.500",href:"https://www.shmetro.com/",isExternal:!0,children:["上海申通地铁集团 ",e.jsx(T,{as:E})]}),"，",e.jsxs(M,{color:"teal.500",href:"https://www.gzmtr.com/",isExternal:!0,children:["广州地铁集团公司 ",e.jsx(T,{as:E})]}),"或",e.jsxs(M,{color:"teal.500",href:"https://www.mtr.com.hk/",isExternal:!0,children:["港铁公司 ",e.jsx(T,{as:E})]}),"所设计。在产生的图像用作商业用途前，你应向相关公司取得适当之许可证或授权。"]}),e.jsxs(be,{children:["The elements including shapes and lines on the image are drawn by"," ",e.jsxs(M,{color:"teal.500",href:"https://www.github.com/thekingofcity",isExternal:!0,children:["thekingofcity ",e.jsx(T,{as:E})]})," and ",e.jsxs(M,{color:"teal.500",href:"https://www.github.com/wongchito",isExternal:!0,children:["Chito Wong ",e.jsx(T,{as:E})]}),", based on the design standards or rules of the companies listed above. You may use them for any purposes, but it is recommended to state the name and the link of software alongside.",e.jsx("br",{}),"图像的元素，包括图形及线条，均由",e.jsxs(M,{color:"teal.500",href:"https://www.github.com/thekingofcity",isExternal:!0,children:["thekingofcity ",e.jsx(T,{as:E})]}),"及",e.jsxs(M,{color:"teal.500",href:"https://www.github.com/wongchito",isExternal:!0,children:["Chito Wong ",e.jsx(T,{as:E})]}),"基于上述公司设计标准或准则绘制。你可将其用于任何目的，但我们建议你于使用同时附以我们的名字以及本网站地址。"]}),e.jsxs(be,{children:["Due to copyright, licensing and other legal restrictions, Rail Map Painter uses"," ",e.jsxs(M,{color:"teal.500",href:"https://github.com/ButTaiwan/genyo-font",isExternal:!0,children:["GenYoMin provided by ButTaiwan ",e.jsx(T,{as:E})]}),", and Vegur instead of MTRSung and Myriad Pro respectively to display and generate MTR-style signage. You shall grant appropriate permit or license from the manufacturers before using those generated images for commercial purposes.",e.jsx("br",{}),"由于著作权及其他法律限制，铁路路线图绘制器使用由",e.jsxs(M,{color:"teal.500",href:"https://github.com/ButTaiwan/genyo-font",isExternal:!0,children:["ButTaiwan提供的源樣明體 ",e.jsx(T,{as:E})]}),"，以及Vegur，以代替港铁样式标志牌所使用的地铁宋及Myriad Pro。在产生之图像用作商业用途前，你应向字型生产厂商取得适当之许可证或授权。"]}),e.jsxs(be,{children:["The exported images in PNG or SVG format may be modified, published, or used for other purposes except commercial use, under the conditions above.",e.jsx("br",{}),"输出的PNG或SVG图像可基于上述条款，在非商业使用时，用于修改、发行或其他用途。"]}),e.jsxs(be,{children:["All flag emojis shown on Windows platforms are designed by"," ",e.jsxs(M,{color:"teal.500",href:"https://openmoji.org/",isExternal:!0,children:["OpenMoji ",e.jsx(T,{as:E})]})," ","– the open-source emoji and icon project. License:",e.jsxs(M,{color:"teal.500",href:"https://creativecommons.org/licenses/by-sa/4.0/",isExternal:!0,children:["CC BY-SA 4.0 ",e.jsx(T,{as:E})]}),e.jsx("br",{}),"于Windows作业系统上显示的国旗Emoji为",e.jsxs(M,{color:"teal.500",href:"https://openmoji.org/",isExternal:!0,children:["OpenMoji ",e.jsx(T,{as:E})]}),"所设计。许可证：",e.jsxs(M,{color:"teal.500",href:"https://creativecommons.org/licenses/by-sa/4.0/",isExternal:!0,children:["CC BY-SA 4.0 ",e.jsx(T,{as:E})]})]}),e.jsxs(be,{children:["We reserve the rights, without prior notice, to modify, add, or remove these terms. The Chinese translation is for reference only. In case of any discrepancy between the English version and the Chinese version, the English version shall prevail.",e.jsx("br",{}),"我们保留修改、新增或移除上述条款之权利，而无需另行通知。中文译本仅供参考，文义如与英文有歧异，概以英文本为准。"]})]})})]})]})},Qn=$n;function eo(){const t=Dt("white","var(--chakra-colors-gray-800)"),r=D(),{telemetry:{app:a,project:s}}=P(z=>z.app),i=P(z=>z.param),{t:o}=W(),n=x.useRef(window.graph),[l,d]=x.useState("png"),c={png:o("header.download.png"),svg:o("header.download.svg")},[g,u]=x.useState(2),[p,h]=x.useState({width:1,height:1,benchmark:.001}),[m,j]=x.useState(200),f=[10,25,33,50,67,75,100,125,150,175,200,250,300,400,500,750,1e3],w=Object.fromEntries(f.map(z=>[z,"".concat(z,"%")])),[S,y]=x.useState([]),[k,O]=x.useState(!1),B=[{type:"select",label:o("header.download.format"),value:l,options:c,onChange:z=>d(z==="png"?"png":"svg")}],oe=[{type:"select",label:o("header.download.svgVersion"),value:g,options:{1.1:o("header.download.svg1.1"),2:o("header.download.svg2")},onChange:z=>{u(z),z===1.1&&St(!0)}}],Oe=[{type:"select",label:o("header.download.scale"),value:m,options:w,disabledOptions:S,onChange:z=>j(z)},{type:"switch",label:o("header.download.transparent"),isChecked:k,onChange:O}],[ie,re]=x.useState(!1),[L,bt]=x.useState(!1),[wt,St]=x.useState(!1),[yt,ls]=x.useState(!1),[Ct,cs]=x.useState(!1),[ds,vt]=x.useState(!1);x.useEffect(()=>{(async()=>{const Me=await Rn.maxArea({usePromise:!0,useWorker:!0});h(Me)})()},[]),x.useEffect(()=>{if(ie){const{xMin:z,yMin:Me,xMax:Ue,yMax:Le}=qt(n.current),[Ze,fe]=[Ue-z,Le-Me],Ee=f.filter(je=>Ze*je/100>p.width&&fe*je/100>p.height);y(Ee)}},[ie]);const hs=()=>{a&&N.event(me.DOWNLOAD_PARAM,s?{"#nodes":n.current.order,"#edges":n.current.size}:{}),rt("RMP_".concat(new Date().valueOf(),".json"),"application/json",Ms(i))},ps=async()=>{re(!1),a&&N.event(me.DOWNLOAD_IMAGES,s?{numberOfNodes:n.current.order,numberOfEdges:n.current.size}:{});const{elem:z,width:Me,height:Ue}=await Nn(n.current,yt,wt,g),Le=z.outerHTML.replace(/&nbsp;/g," ");if(l==="svg"){rt("RMP_".concat(new Date().valueOf(),".svg"),"image/svg+xml",Le);return}document.body.appendChild(z);const Ze="data:image/svg+xml;base64,"+btoa(unescape(encodeURIComponent(Le)));document.body.removeChild(z),z.remove();const fe=document.createElement("canvas"),[Ee,je]=[Me*m/100,Ue*m/100];fe.width=Ee,fe.height=je;const Ve=fe.getContext("2d");k||(Ve.fillStyle=t,Ve.fillRect(0,0,Ee,je));const Fe=new Image;Fe.onload=()=>{setTimeout(()=>{Ve.drawImage(Fe,0,0,Ee,je),fe.toBlob(zt=>{if(!zt){r(Pe({status:"error",message:o("header.download.imageTooBig")}));return}ns("RMP_".concat(new Date().valueOf(),".png"),zt)},"image/png")},fn()?2e3:0)},Fe.src=Ze};return e.jsxs(ut,{id:"download",children:[e.jsx(gt,{as:ee,size:"sm",variant:"ghost",icon:e.jsx(Xt,{})}),e.jsxs(mt,{children:[e.jsx(se,{icon:e.jsx(ks,{}),onClick:hs,children:o("header.download.config")}),e.jsxs(se,{icon:e.jsx(As,{}),onClick:()=>vt(!0),children:[o("header.download.2rmg.title"),e.jsx(ve,{ml:"1",colorScheme:"green",children:"New"})]}),e.jsx(se,{icon:e.jsx(Os,{}),onClick:()=>re(!0),children:o("header.download.image")})]}),e.jsxs(Z,{size:"xl",isOpen:ie,onClose:()=>re(!1),children:[e.jsx(V,{}),e.jsxs(F,{children:[e.jsx(K,{children:o("header.download.image")}),e.jsx(Y,{}),e.jsxs(q,{children:[e.jsx(ke,{fields:B}),l==="svg"&&e.jsx(ke,{fields:oe}),l==="png"&&e.jsx(ke,{fields:Oe}),l==="png"&&S.length>0&&e.jsxs(e.Fragment,{children:[e.jsx(b,{as:"i",fontSize:"sm",children:o("header.download.disabledScaleOptions")}),e.jsx("br",{}),e.jsx(b,{as:"i",fontSize:"sm",children:o("header.download.disabledScaleOptionsWorkarounds")}),e.jsxs(M,{color:"teal.500",onClick:()=>window.open("https://github.com/RazrFalcon/resvg","_blank"),children:["RazrFalcon/resvg ",e.jsx(T,{as:E})]}),e.jsx("br",{})]}),e.jsx("br",{}),e.jsx(Ye,{isChecked:wt,isDisabled:l==="svg"&&g===1.1,onChange:z=>St(z.target.checked),children:e.jsx(b,{children:o("header.download.useSystemFonts")})}),e.jsx(Ye,{isChecked:yt,onChange:z=>ls(z.target.checked),children:e.jsxs(b,{children:[o("header.download.shareInfo1"),e.jsxs(M,{color:"teal.500",onClick:()=>window.open("https://railmapgen.github.io/rmp","_blank"),children:[o("header.about.rmp")," ",e.jsx(T,{as:E})]}),o("header.download.shareInfo2")]})}),e.jsx(Ye,{isChecked:Ct,onChange:z=>cs(z.target.checked),children:e.jsxs(b,{children:[o("header.download.termsAndConditionsInfo"),e.jsxs(M,{color:"teal.500",onClick:()=>bt(!0),children:[o("header.download.termsAndConditions")," ",e.jsx(T,{as:E})]}),o("header.download.period")]})})]}),e.jsx(pe,{children:e.jsx(ms,{children:e.jsx(R,{colorScheme:"teal",variant:"outline",size:"sm",isDisabled:!Ct||S.includes(m),onClick:ps,children:o("header.download.confirm")})})}),e.jsx(Qn,{isOpen:L,onClose:()=>bt(!1)})]})]}),e.jsx(Jn,{isOpen:ds,onClose:()=>vt(!1)})]})}const to=(t,{info_panel_type:r,line_num:a,stn_list:s,style:i,theme:o},n)=>{const l=Object.fromEntries(Object.keys(s).filter(d=>!["linestart","lineend"].includes(d)).map(d=>[d,"stn_".concat(ot(10))]));Object.entries(s).filter(([d,c])=>!["linestart","lineend"].includes(d)).forEach(([d,c])=>{const g=t.filterNodes((u,p)=>Object.values(I).includes(p.type)&&p[p.type].names[0]===c.name[0]);g.length!==0&&(l[d]=g[0])}),Object.entries(s).filter(([d,c])=>!["linestart","lineend"].includes(d)).filter(([d,c])=>t.filterNodes((g,u)=>Object.values(I).includes(u.type)&&u[u.type].names[0]===c.name[0]).length===0).forEach(([d,c],g)=>{var j;let u=I.ShmetroBasic;const p=c.transfer.groups,h=p.map(f=>{var w;return(w=f.lines)!=null?w:[]}).flat();i===le.SHMetro?h.length>0?u=I.ShmetroInt:r===ft.sh2020?u=I.ShmetroBasic2020:u=I.ShmetroBasic:i===le.GZMTR?h.length>0?u=I.GzmtrInt:u=I.GzmtrBasic:i===le.MTR&&(u=I.MTR);const m={...structuredClone(jn[u].defaultAttrs),names:c.name};u===I.ShmetroBasic2020?m.color=o:u===I.GzmtrBasic?(m.color=o,m.lineCode=a,m.stationCode=c.num):u===I.GzmtrInt?m.transfer=p.map((f,w)=>{var y,k;const S=(k=(y=f.lines)==null?void 0:y.map(O=>{var B;return[...(B=O.theme)!=null?B:o,"1","01"]}))!=null?k:[];return w===0?[[...o,a,c.num],...S]:S}):u===I.MTR&&((j=p[0].lines)!=null&&j.length?m.transfer=[[[...o,"",""],...p[0].lines.map(f=>{var w;return[...(w=f.theme)!=null?w:o,"",""]})]]:m.transfer=[[]]),t.addNode(l[d],{visible:!0,zIndex:0,x:100+g*50,y:1e3,type:u,[u]:m})}),Object.entries(s).filter(([d,c])=>!["linestart","lineend"].includes(d)).forEach(([d,c])=>{c.children.filter(g=>!["linestart","lineend"].includes(g)).forEach(g=>{const u=qe.Diagonal,[p,h]=[l[d],l[g]],m=n?Es(t,u,p,h,"from"):-1;t.addDirectedEdgeWithKey("line_".concat(ot(10)),p,h,{visible:!0,zIndex:0,type:u,[qe.Diagonal]:structuredClone(Ts[qe.Diagonal].defaultAttrs),style:Ot.SingleColor,[Ot.SingleColor]:{color:o},reconcileId:"",parallelIndex:m})})})},so="rmg-bridge--",no={h:500,maxH:"70%","& iframe":{h:"100%",w:"100%"}};function oo(t){const{isOpen:r,onClose:a,onImport:s}=t,[i]=_t.useState(crypto.randomUUID()),o="/rmg/#/import?"+new URLSearchParams({parentComponent:N.getAppName(),parentId:i});return _t.useEffect(()=>{const n=new BroadcastChannel(so+i);return n.onmessage=l=>{const{event:d,data:c}=l.data;console.log("[rmp] Received event from RMG app clip:",d),d==="CLOSE"?a():d==="IMPORT"&&s(c)},()=>n.close()},[]),e.jsx($t,{isOpen:r,onClose:a,sx:no,children:e.jsx("iframe",{src:o,loading:"lazy"})})}const io="RMP_GALLERY_CHANNEL",ro="OPEN_TEMPLATE",Wt=new BroadcastChannel(io),ao={h:"80%",w:"80%","& iframe":{h:"100%",w:"100%"},"& div":{h:"100%",w:"100%"}};function lo(t){const{isOpen:r,onClose:a}=t,s=Ut(),{t:i}=W(),o=D(),{telemetry:{app:n,project:l}}=P(p=>p.app),d=x.useRef(window.graph),c=x.useCallback(()=>{o(xe()),o(de()),o(he(d.current.export()))},[o,xe,de,he,d]),g=async p=>{const{version:h,...m}=JSON.parse(await Qt(JSON.stringify(p)));o(it()),d.current.clear(),d.current.import(m.graph),c();const{svgViewBoxZoom:j,svgViewBoxMin:f}=m;typeof j=="number"&&o(Ae(j)),typeof f.x=="number"&&typeof f.y=="number"&&o(Ne(f))},u=async(p,h)=>{var f;const m=h?"https://".concat(h):"",j=await((f=(await Promise.allSettled([fetch("".concat(m,"/rmp-gallery/resources/real_world/").concat(p,".json")),fetch("".concat(m,"/rmp-gallery/resources/fantasy/").concat(p,".json"))])).filter(w=>w.status==="fulfilled").find(w=>w.value.status===200))==null?void 0:f.value.json());if(j){if(n){const w={id:p};l&&h&&(w.host=h),N.event(me.IMPORT_WORK_FROM_GALLERY,w)}g(j),s({title:i("header.open.importFromRMPGallery",{id:p}),status:"success",duration:9e3,isClosable:!0})}else s({title:i("header.open.failToImportFromRMPGallery",{id:p}),status:"error",duration:9e3,isClosable:!0})};return x.useEffect(()=>{const h=new URL(window.location.href).searchParams;if(h.size>0){const m=h.keys().next().value,j=m.indexOf("."),f=m.substring(0,j===-1?void 0:j);let w;j!==-1&&(w=m.substring(j+1)),u(f,w)}},[]),x.useEffect(()=>(Wt.onmessage=p=>{const{event:h,data:m}=p.data;h===ro&&(u(m),a())},()=>Wt.close()),[]),e.jsxs($t,{isOpen:r,onClose:a,size:"full",sx:ao,children:[e.jsx("iframe",{src:"/rmp-gallery/",loading:"lazy"}),e.jsx(Zt,{onClick:a,position:"fixed",top:"5px",right:"15px"})]})}function co(){const{t}=W(),r=D(),{telemetry:{project:a},preference:{autoParallel:s}}=P(S=>S.app),i=x.useRef(window.graph),o=x.useRef(null),[n,l]=x.useState(!1),[d,c]=x.useState(!1),g=x.useCallback(()=>{r(xe()),r(de()),r(he(i.current.export()))},[r,xe,de,he,i]),u=()=>{r(it()),i.current.clear(),r(Ae(100)),r(Ne({x:0,y:0})),g()},p=S=>{try{a&&N.event(me.IMPORT_RMG_PARAM,{}),to(i.current,S,s),g()}catch(y){r(Pe({status:"error",message:t("header.open.unknownError")})),console.error("OpenActions.handleUploadRMG():: Unknown error occurred while parsing the RMG project",y)}finally{l(!1)}},h=async S=>{const{version:y,...k}=JSON.parse(await Qt(S));r(it()),i.current.clear(),i.current.import(k.graph),g();const{svgViewBoxZoom:O,svgViewBoxMin:B}=k;typeof O=="number"&&r(Ae(O)),typeof B.x=="number"&&typeof B.y=="number"&&r(Ne(B))},m=async S=>{var k;const y=(k=S.target.files)==null?void 0:k[0];if(console.log("OpenActions.handleUpload():: received file",y),(y==null?void 0:y.type)!=="application/json")r(Pe({status:"error",message:t("header.open.invalidType")})),console.error("OpenActions.handleUpload():: Invalid file type! Only file in JSON format is accepted.");else try{const O=await ho(y);await h(O)}catch(O){r(Pe({status:"error",message:t("header.open.unknownError")})),console.error("OpenActions.handleUpload():: Unknown error occurred while parsing the uploaded file",O)}S.target.value=""},j=async()=>{await h(await Is()),r(Ne({x:-10,y:-13}));const S=Math.max(0,Math.min(400,-.132*w+117.772));r(Ae(S)),N.event(me.LOAD_TUTORIAL,{})};x.useEffect(()=>{const S=async y=>{const{type:k,key:O,from:B}=y.data;if(k===Ls.SAVE_CHANGED&&O===Tt.PARAM&&B==="rmt"){Hs.debug("Received save changed event on key: ".concat(O));const oe=localStorage.getItem(Tt.PARAM);if(!oe)return;await h(oe)}};return Mt.addEventListener("message",S),()=>Mt.removeEventListener("message",S)},[]);const f=ss(),{height:w}=es(f);return e.jsxs(ut,{children:[e.jsx(gt,{as:ee,size:"sm",variant:"ghost",icon:e.jsx(Et,{})}),e.jsxs(mt,{children:[e.jsx(se,{icon:e.jsx(Rs,{}),onClick:u,children:t("header.open.new")}),e.jsx("input",{id:"upload_project",ref:o,type:"file",accept:".json",hidden:!0,onChange:m,"data-testid":"file-upload"}),e.jsx(se,{icon:e.jsx(Et,{}),onClick:()=>{var S;return(S=o==null?void 0:o.current)==null?void 0:S.click()},children:t("header.open.config")}),e.jsx(se,{icon:e.jsx(Ns,{}),onClick:()=>l(!0),children:t("header.open.projectRMG")}),e.jsxs(se,{icon:e.jsx(E,{}),onClick:()=>c(!0),children:[t("header.open.gallery"),e.jsx(ve,{ml:"1",colorScheme:"green",children:"New"})]}),e.jsx(se,{icon:e.jsx(_s,{}),onClick:j,children:t("header.open.tutorial")})]}),e.jsx(oo,{isOpen:n,onClose:()=>l(!1),onImport:p}),e.jsx(lo,{isOpen:d,onClose:()=>c(!1)})]})}const ho=t=>new Promise(r=>{const a=new FileReader;a.onloadend=()=>r(a.result),a.readAsText(t)}),po=t=>{const{isOpen:r,onClose:a}=t,s=D(),{theme:i,paletteAppClip:{output:o}}=P(h=>h.runtime),{t:n}=W(),l=x.useRef(window.graph),[d,c]=x.useState(i),[g,u]=x.useState(!1);x.useEffect(()=>{g&&o&&(c(o),u(!1))},[o==null?void 0:o.toString()]);const p=()=>{l.current.filterEdges((h,m,j,f,w,S,y)=>Jt.includes(m.style)&&JSON.stringify(m[m.style].color)===JSON.stringify(d)).forEach(h=>l.current.dropEdge(h)),s(de()),s(he(l.current.export())),a()};return e.jsxs(Z,{isOpen:r,onClose:a,size:"xl",scrollBehavior:"inside",trapFocus:!1,children:[e.jsx(V,{}),e.jsxs(F,{children:[e.jsx(K,{children:n("header.settings.procedures.removeLines.title")}),e.jsx(Y,{}),e.jsxs(q,{children:[n("header.settings.procedures.removeLines.content"),e.jsx(Ws,{theme:d,onClick:()=>{u(!0),s(Bs(d))}})]}),e.jsxs(pe,{children:[e.jsx(R,{colorScheme:"blue",variant:"outline",mr:"1",onClick:a,children:n("cancel")}),e.jsx(R,{colorScheme:"red",onClick:p,children:n("remove")})]})]})]})},uo=t=>{const{isOpen:r,onClose:a}=t,s=D(),{t:i}=W(),o=x.useRef(window.graph),[n,l]=x.useState(1),d=[{type:"input",label:i("header.settings.procedures.scale.factor"),value:n.toString(),variant:"number",onChange:g=>l(Number(g)),minW:"full"}],c=()=>{o.current.forEachNode((g,u)=>{o.current.updateNodeAttribute(g,"x",p=>(p!=null?p:0)*n),o.current.updateNodeAttribute(g,"y",p=>(p!=null?p:0)*n)}),s(xe()),s(de()),s(he(o.current.export())),a()};return e.jsxs(Z,{isOpen:r,onClose:a,size:"xl",scrollBehavior:"inside",children:[e.jsx(V,{}),e.jsxs(F,{children:[e.jsx(K,{children:i("header.settings.procedures.scale.title")}),e.jsx(Y,{}),e.jsxs(q,{children:[i("header.settings.procedures.scale.content"),e.jsx(ke,{fields:d})]}),e.jsxs(pe,{children:[e.jsx(R,{colorScheme:"blue",variant:"outline",mr:"1",onClick:a,children:i("cancel")}),e.jsx(R,{colorScheme:"red",onClick:c,children:i("apply")})]})]})]})},go=t=>{const{isOpen:r,onClose:a}=t,s=D(),{t:i}=W(),o=x.useRef(window.graph),[n,l]=x.useState(0),[d,c]=x.useState(0),g=[{type:"input",label:i("header.settings.procedures.translate.x"),value:n.toString(),variant:"number",onChange:p=>l(Number(p)),minW:"full"},{type:"input",label:i("header.settings.procedures.translate.y"),value:d.toString(),variant:"number",onChange:p=>c(Number(p)),minW:"full"}],u=()=>{o.current.forEachNode((p,h)=>{o.current.updateNodeAttribute(p,"x",m=>(m!=null?m:0)+n),o.current.updateNodeAttribute(p,"y",m=>(m!=null?m:0)+d)}),s(xe()),s(de()),s(he(o.current.export())),a()};return e.jsxs(Z,{isOpen:r,onClose:a,size:"xl",scrollBehavior:"inside",children:[e.jsx(V,{}),e.jsxs(F,{children:[e.jsx(K,{children:i("header.settings.procedures.translate.title")}),e.jsx(Y,{}),e.jsxs(q,{children:[i("header.settings.procedures.translate.content"),e.jsx(ke,{fields:g})]}),e.jsxs(pe,{children:[e.jsx(R,{colorScheme:"blue",variant:"outline",mr:"1",onClick:a,children:i("cancel")}),e.jsx(R,{colorScheme:"red",onClick:u,children:i("apply")})]})]})]})},mo=t=>{const{isOpen:r,onClose:a}=t,s=D(),{activeSubscriptions:i}=P(l=>l.account),{t:o}=W(),n=()=>{s(Ps(-1))};return e.jsxs(Z,{isOpen:r,onClose:a,size:"5xl",scrollBehavior:"inside",children:[e.jsx(V,{}),e.jsxs(F,{children:[e.jsx(K,{children:o("header.settings.procedures.unlockSimplePath.title")}),e.jsx(Y,{}),e.jsxs(q,{children:[e.jsx(b,{mb:"2",children:o("header.settings.procedures.unlockSimplePath.content1")}),e.jsx(b,{mb:"2",children:o("header.settings.procedures.unlockSimplePath.content2")}),e.jsx(b,{mb:"2",children:o("header.settings.procedures.unlockSimplePath.content3")})]}),e.jsx(pe,{children:e.jsx(Be,{label:o("header.settings.pro"),isOpen:!i.RMP_CLOUD,children:e.jsx(R,{onClick:n,isDisabled:!i.RMP_CLOUD,children:o("header.settings.procedures.unlockSimplePath.check")})})})]})]})},xo=t=>{const{isOpen:r,onClose:a}=t,s=D(),i=Ut(),{t:o}=W(),n=x.useRef(window.graph),[l,d]=x.useState(!1),c=async()=>{d(!0);const g=JSON.stringify(n.current.export());try{const u=await bo(g);n.current.clear(),n.current.import(u),s(xe()),s(de()),s(he(n.current.export())),i({title:o("header.settings.procedures.updateColor.success"),status:"success",duration:9e3,isClosable:!0})}catch(u){console.error("[rmp] Error in updating all colors: ".concat(u)),i({title:o("header.settings.procedures.updateColor.error",{e:u}),status:"error",duration:9e3,isClosable:!0})}d(!1),a()};return e.jsxs(Z,{isOpen:r,onClose:a,size:"xl",scrollBehavior:"inside",children:[e.jsx(V,{}),e.jsxs(F,{children:[e.jsx(K,{children:o("header.settings.procedures.updateColor.title")}),e.jsx(Y,{}),e.jsx(q,{children:e.jsx(b,{children:o("header.settings.procedures.updateColor.content")})}),e.jsxs(pe,{children:[e.jsx(R,{colorScheme:"blue",variant:"outline",mr:"1",onClick:a,children:o("cancel")}),e.jsx(R,{colorScheme:"red",onClick:c,isLoading:l,children:o("apply")})]})]})]})},Bt=t=>t.length>=4&&t.every(r=>typeof r=="string")&&!!t[2].match(/^#[0-9a-fA-F]{6}$/)&&Object.values(xt).includes(t[3]),fo=t=>{const r=[],a=(s,i)=>{if(Array.isArray(s)&&Bt(s)){r.push({path:i||"",value:s});return}for(const o in s){const n=s[o],l=i?"".concat(i,".").concat(o):o;Array.isArray(n)?Bt(n)?r.push({path:l,value:n}):n.forEach((d,c)=>a(d,"".concat(l,".").concat(c))):n&&typeof n=="object"&&a(n,l)}};return a(t),r},jo=(t,r,a)=>{const s=r.split(".");let i=t;for(let o=0;o<s.length-1;o++)i=i[s[o]];i[s[s.length-1]]=a},bo=async t=>{const r=JSON.parse(t),a=new Date().getTime(),s=fo(r);console.log("[rmp] Found all themes pending for update",s);const i=1e4;let o,n=!1;const l=new Promise((d,c)=>{o=setTimeout(()=>{n=!0,c("Executing time exceeds ".concat(i,"ms"))},i),(async()=>{for(const{path:g,value:u}of s){if(n)throw new Error("Update aborted");const[p,h,m,j,...f]=u,w=await Gs([p,h,m,j]);jo(r,g,[...w,...f])}})().then(d).catch(c)});try{return await l,console.log("[rmp] Themes update completed, elapsed time ".concat((new Date().getTime()-a)/1e3," sec")),r}finally{clearTimeout(o)}},Se={width:"100%",justifyContent:"space-between"},te={fontFamily:"-apple-system"},wo=t=>{const{isOpen:r,onClose:a}=t,{activeSubscriptions:s}=P(L=>L.account),{telemetry:{app:i},preference:{autoParallel:o}}=P(L=>L.app),{keepLastPath:n,parallelLinesCount:l}=P(L=>L.runtime),d=D(),{t:c}=W(),g=Dt("primary.500","primary.300"),[u,p]=x.useState(!1),[h,m]=x.useState(!1),[j,f]=x.useState(!1),[w,S]=x.useState(!1),[y,k]=x.useState(!1),[O,B]=x.useState(!1),oe=N.isAllowAnalytics(),Oe=L=>d(Js(L)),ie=s.RMP_CLOUD?Ds:Us,re=l>ie;return e.jsxs(Z,{isOpen:r,onClose:a,size:"xl",scrollBehavior:"inside",trapFocus:!1,children:[e.jsx(V,{}),e.jsxs(F,{children:[e.jsx(K,{children:c("header.settings.title")}),e.jsx(Y,{}),e.jsx(q,{children:e.jsxs(Ce,{divider:e.jsx(xs,{borderColor:"gray.200"}),children:[e.jsxs(H,{width:"100%",mb:"3",children:[e.jsx(b,{as:"b",fontSize:"xl",children:c("header.settings.preference.title")}),e.jsxs(H,{mt:"3",children:[e.jsxs(H,{display:"flex",mb:"1",children:[e.jsx(b,{flex:"1",children:c("header.settings.preference.keepLastPath")}),e.jsx(He,{isChecked:n,onChange:({target:{checked:L}})=>d(Zs(L))})]}),e.jsxs(H,{display:"flex",mb:"1",children:[e.jsx(b,{children:c("header.settings.preference.autoParallel")}),e.jsx(Be,{label:c("header.settings.proLimitExceed"),children:e.jsx(ve,{ml:"1",color:"gray.50",background:"radial-gradient(circle, #3f5efb, #fc466b)",mr:"auto",children:"PRO"})}),e.jsx(He,{isDisabled:re,isChecked:o,onChange:({target:{checked:L}})=>d(Vs(L))})]})]})]}),e.jsxs(H,{width:"100%",mb:"3",children:[e.jsx(b,{as:"b",fontSize:"xl",children:c("header.settings.procedures.title")}),e.jsxs(H,{mt:"3",children:[e.jsx(R,{sx:Se,rightIcon:e.jsx(we,{}),onClick:()=>p(!0),children:c("header.settings.procedures.translate.title")}),e.jsx(go,{isOpen:u,onClose:()=>p(!1)}),e.jsx(R,{sx:Se,rightIcon:e.jsx(we,{}),onClick:()=>m(!0),children:c("header.settings.procedures.scale.title")}),e.jsx(uo,{isOpen:h,onClose:()=>m(!1)}),e.jsxs(R,{sx:Se,rightIcon:e.jsx(we,{}),onClick:()=>f(!0),children:[c("header.settings.procedures.changeType.title"),e.jsx(Be,{label:c("header.settings.pro"),children:e.jsx(ve,{ml:"1",color:"gray.50",background:"radial-gradient(circle, #3f5efb, #fc466b)",mr:"auto",children:"PRO"})})]}),e.jsx(wn,{isOpen:j,onClose:()=>f(!1),isSelect:!1}),e.jsx(R,{sx:Se,rightIcon:e.jsx(we,{}),onClick:()=>S(!0),children:c("header.settings.procedures.removeLines.title")}),e.jsx(po,{isOpen:w,onClose:()=>S(!1)}),e.jsx(R,{sx:Se,rightIcon:e.jsx(we,{}),onClick:()=>k(!0),children:c("header.settings.procedures.updateColor.title")}),e.jsx(xo,{isOpen:y,onClose:()=>k(!1)}),e.jsxs(R,{sx:Se,rightIcon:e.jsx(we,{}),onClick:()=>B(!0),children:[c("header.settings.procedures.unlockSimplePath.title"),e.jsx(Be,{label:c("header.settings.pro"),children:e.jsx(ve,{ml:"1",color:"gray.50",background:"radial-gradient(circle, #3f5efb, #fc466b)",mr:"auto",children:"PRO"})})]}),e.jsx(mo,{isOpen:O,onClose:()=>B(!1)})]})]}),e.jsxs(H,{width:"100%",mb:"3",children:[e.jsx(b,{as:"b",fontSize:"xl",children:c("header.settings.shortcuts.title")}),e.jsx(H,{mt:"3",children:e.jsxs(fs,{children:[e.jsx(js,{children:e.jsxs(G,{children:[e.jsx(kt,{children:c("header.settings.shortcuts.keys")}),e.jsx(kt,{children:c("header.settings.shortcuts.description")})]})}),e.jsxs(bs,{children:[e.jsxs(G,{children:[e.jsx(A,{children:e.jsx(C,{children:"f"})}),e.jsx(A,{children:c("header.settings.shortcuts.f")})]}),e.jsxs(G,{children:[e.jsx(A,{children:e.jsx(C,{children:"s"})}),e.jsx(A,{children:c("header.settings.shortcuts.s")})]}),e.jsxs(G,{children:[e.jsx(A,{children:e.jsxs(H,{display:"flex",flexDirection:"row",children:[e.jsx(Fs,{}),e.jsx(Ks,{}),e.jsx(Ys,{}),e.jsx(qs,{})]})}),e.jsx(A,{children:c("header.settings.shortcuts.arrows")})]}),e.jsxs(G,{children:[e.jsx(A,{children:e.jsxs(H,{display:"flex",flexDirection:"row",children:[e.jsx(C,{children:"i"}),e.jsx(C,{children:"j"}),e.jsx(C,{children:"k"}),e.jsx(C,{children:"l"})]})}),e.jsx(A,{children:c("header.settings.shortcuts.ijkl")})]}),e.jsxs(G,{children:[e.jsx(A,{children:ae?e.jsx(C,{sx:te,children:"⇧"}):e.jsx(C,{children:"shift"})}),e.jsx(A,{children:c("header.settings.shortcuts.shift")})]}),e.jsxs(G,{children:[e.jsx(A,{children:ae?e.jsx(C,{sx:te,children:"⌥"}):e.jsx(C,{children:"alt"})}),e.jsx(A,{children:c("header.settings.shortcuts.alt")})]}),e.jsxs(G,{children:[e.jsx(A,{children:ae?e.jsx(C,{sx:te,children:"⌫"}):e.jsx(C,{children:"delete"})}),e.jsx(A,{children:c("header.settings.shortcuts.delete")})]}),e.jsxs(G,{children:[e.jsxs(A,{children:[ae?e.jsx(C,{sx:te,children:"⌘"}):e.jsx(C,{children:"ctrl"})," + ",e.jsx(C,{children:"x"})]}),e.jsx(A,{children:c("header.settings.shortcuts.cut")})]}),e.jsxs(G,{children:[e.jsxs(A,{children:[ae?e.jsx(C,{sx:te,children:"⌘"}):e.jsx(C,{children:"ctrl"})," + ",e.jsx(C,{children:"c"})]}),e.jsx(A,{children:c("header.settings.shortcuts.copy")})]}),e.jsxs(G,{children:[e.jsxs(A,{children:[ae?e.jsx(C,{sx:te,children:"⌘"}):e.jsx(C,{children:"ctrl"})," + ",e.jsx(C,{children:"v"})]}),e.jsx(A,{children:c("header.settings.shortcuts.paste")})]}),e.jsxs(G,{children:[e.jsxs(A,{children:[ae?e.jsx(C,{sx:te,children:"⌘"}):e.jsx(C,{children:"ctrl"})," + ",e.jsx(C,{children:"z"})]}),e.jsx(A,{children:c("header.settings.shortcuts.undo")})]}),e.jsxs(G,{children:[e.jsx(A,{children:ae?e.jsxs(e.Fragment,{children:[e.jsx(C,{sx:te,children:"⇧"})," + ",e.jsx(C,{sx:te,children:"⌘"})," + ",e.jsx(C,{children:"z"})]}):e.jsxs(e.Fragment,{children:[e.jsx(C,{children:"ctrl"})," + ",e.jsx(C,{children:"y"})]})}),e.jsx(A,{children:c("header.settings.shortcuts.redo")})]})]})]})})]}),e.jsxs(H,{width:"100%",mb:"3",children:[e.jsx(b,{as:"b",fontSize:"xl",children:c("header.settings.telemetry.title")}),e.jsxs(H,{mt:"3",children:[e.jsxs(H,{display:"flex",mb:"1",children:[e.jsx(b,{flex:"1",children:c("header.settings.telemetry.essential")}),e.jsx(He,{isChecked:oe,isDisabled:!0})]}),e.jsx(b,{fontSize:"sm",lineHeight:"100%",color:"gray.600",children:c("header.settings.telemetry.essentialInfo")}),e.jsxs(M,{color:g,fontSize:"sm",lineHeight:"100%",href:"https://support.google.com/analytics/answer/11593727",isExternal:!0,children:[c("header.settings.telemetry.essentialLink")," ",e.jsx(T,{as:E})]}),e.jsxs(H,{display:"flex",mb:"1",children:[e.jsx(b,{flex:"1",children:c("header.settings.telemetry.additional")}),e.jsx(He,{isChecked:i,onChange:({target:{checked:L}})=>Oe(L)})]}),e.jsx(b,{fontSize:"sm",lineHeight:"100%",color:"gray.600",children:c("header.settings.telemetry.additionalInfo")})]})]})]})})]})]})},So=wo,yo=()=>{const[t,r]=x.useState(!1),{svgViewBoxZoom:a}=P(o=>o.param),s=D(),i=[{type:"slider",label:"",value:400-a,min:10,max:390,step:1,onChange:o=>s(Ae(400-o)),leftIcon:e.jsx(Xs,{}),rightIcon:e.jsx(Rt,{}),minW:160}];return e.jsxs(Vt,{isOpen:t,onOpen:()=>r(!0),onClose:()=>r(!1),children:[e.jsx(Ft,{children:e.jsx(ee,{"aria-label":"zoom",variant:"ghost",size:"sm",icon:e.jsx(Rt,{}),onClick:()=>r(!t)})}),e.jsx(Kt,{children:e.jsx(Yt,{children:e.jsx(ke,{fields:i,noLabel:!0})})})]})},Co=()=>{const[t,r]=x.useState(!1),{t:a}=W(),s=D(),i=x.useRef(window.graph),o=ss(),{width:n,height:l}=es(o),[d,c]=x.useState([]);x.useEffect(()=>{t&&c(i.current.nodes().filter(u=>u.startsWith("stn")).map(u=>{const p=i.current.getNodeAttributes(u),h=p.type,m=p[h].names.join("/");return{id:u,value:m}}))},[t]);const g=u=>{s(tn(new Set([u])));const p=Math.max(0,Math.min(400,-.132*l+117.772)),{x:h,y:m}=sn((n-300)/2,l/2,p,{x:-i.current.getNodeAttribute(u,"x"),y:-i.current.getNodeAttribute(u,"y")});s(Ae(p)),s(Ne({x:-h,y:-m}))};return e.jsxs(Vt,{isOpen:t,onOpen:()=>r(!0),onClose:()=>r(!1),children:[e.jsx(Ft,{children:e.jsx(ee,{"aria-label":"zoom",variant:"ghost",size:"sm",icon:e.jsx($s,{}),onClick:()=>r(!t)})}),e.jsx(Kt,{children:e.jsx(Yt,{children:e.jsx(Qs,{label:a("header.search"),children:e.jsx(en,{data:d,displayHandler:u=>e.jsx(ve,{children:u.value}),filter:(u,p)=>p.value.toLowerCase().includes(u.toLowerCase())||Object.values(p.value).some(h=>h.toLowerCase().includes(u.toLowerCase())),value:"",onChange:u=>g(u.id)})})})})]})};function vo(){const{t}=W(),r=D(),{telemetry:{app:a}}=P(h=>h.app),{past:s,future:i}=P(h=>h.param),{isDonationModalOpen:o}=P(h=>h.runtime),[n,l]=x.useState(!1),[d,c]=x.useState(!1),g=Lt(N.getEnv),u=Lt(N.getAppVersion);x.useEffect(()=>{a&&g!==Je.DEV&&N.event(me.APP_LOAD,{isStandaloneWindow:N.isStandaloneWindow()})},[g]);const p=async h=>{N.getI18nInstance().changeLanguage(h)};return e.jsxs(nn,{children:[e.jsx(ge,{as:"h4",size:"md",whiteSpace:"nowrap",overflow:"hidden",textOverflow:"ellipsis",children:t("header.about.rmp")}),e.jsx(on,{environment:g,version:u,popoverHeader:g===Je.PRD?void 0:e.jsxs(It,{i18nKey:"header.popoverHeader",environment:g,children:["You're on ",{environment:g}," environment!"]}),popoverBody:g===Je.PRD?void 0:e.jsx(It,{i18nKey:"header.popoverBody",children:"This is a testing environment where we test the latest beta RMP."})}),e.jsxs(ws,{ml:"auto",children:[e.jsx(Q,{children:e.jsx(Co,{})}),e.jsx(Q,{children:e.jsx(ee,{size:"sm",variant:"ghost","aria-label":"Undo",icon:e.jsx(rn,{}),isDisabled:s.length===0,onClick:()=>r(an())})}),e.jsx(Q,{children:e.jsx(ee,{size:"sm",variant:"ghost","aria-label":"Redo",icon:e.jsx(ln,{}),isDisabled:i.length===0,onClick:()=>r(cn())})}),e.jsx(Q,{children:e.jsx(yo,{})}),e.jsx(Q,{children:e.jsx(co,{})}),e.jsx(Q,{children:e.jsx(eo,{})}),N.isStandaloneWindow()&&e.jsx(Q,{children:e.jsxs(ut,{children:[e.jsx(gt,{as:ee,icon:e.jsx(dn,{}),variant:"ghost",size:"sm"}),e.jsx(mt,{children:["en","zh-Hans","zh-Hant","ja","ko"].map(h=>e.jsx(se,{onClick:()=>p(h),children:Sn[h][h]},h))})]})}),e.jsx(Q,{children:e.jsx(ee,{size:"sm",variant:"ghost","aria-label":"Donation",color:"red",icon:e.jsx(ts,{}),onClick:()=>r(Nt(!0))})}),e.jsx(Q,{children:e.jsx(ee,{size:"sm",variant:"ghost","aria-label":"Settings",icon:e.jsx(hn,{}),onClick:()=>l(!0)})}),e.jsx(Q,{children:e.jsx(ee,{size:"sm",variant:"ghost","aria-label":"Help",icon:e.jsx(pn,{}),onClick:()=>c(!0)})})]}),e.jsx(Tn,{isOpen:o,onClose:()=>r(Nt(!1))}),e.jsx(So,{isOpen:n,onClose:()=>l(!1)}),e.jsx(zn,{isOpen:d,onClose:()=>c(!1)})]})}function zo(){const t=D(),r=P(s=>s.runtime.globalAlerts),a=s=>{N.isStandaloneWindow()?window.open("/".concat(s),"_blank"):N.openApp({appId:s})};return e.jsx(e.Fragment,{children:Object.entries(r).map(([s,{message:i,url:o,linkedApp:n}])=>e.jsxs(Ss,{status:s,variant:"solid",size:"xs",pl:3,pr:1,py:0,zIndex:"1",children:[e.jsx(ys,{}),n?e.jsx(M,{onClick:()=>a(n),children:i}):o?e.jsx(M,{href:o,target:"_blank",children:i}):i,e.jsx(Zt,{ml:"auto",onClick:()=>t(un(s))})]},s))})}function No(){return e.jsxs(e.Fragment,{children:[e.jsx(vo,{}),e.jsx(zo,{})]})}export{No as default};
