System.register(["./chakra-legacy-HBaSrP-q.js","./index-legacy-VtngjhF1.js","./react-legacy-T1GznqXM.js","./graph-legacy-bAdSaElj.js","./stations-legacy-VuevPiy7.js"],(function(e,t){"use strict";var s,n,a,i,r,l,o,c,d,u,g,h,p,y,m,f,b,S,j,A,C,x,E,v,O,T,L,N,w,W,k,P,z,B,F,_,I,M;return{setters:[e=>{s=e.j,n=e.at,a=e.$,i=e.au,r=e.a1,l=e.a4,o=e.a2,c=e.a3,d=e.aM,u=e.aN,g=e.aO,h=e.B,p=e.aP,y=e.aQ,m=e.a5,f=e.O},e=>{b=e.S,S=e.ac,j=e.m,A=e.L,C=e.o,x=e.f,E=e.a,v=e.q,O=e.t,T=e.v,L=e.C,N=e.c,w=e.l,W=e._,k=e.R,P=e.T,z=e.H,B=e.j},e=>{F=e.u,_=e.b},e=>{I=e.c},e=>{M=e.s}],execute:function(){const t=[b.ShmetroBasic2020,b.LondonTubeBasic],R=e("b",((e,s,n)=>{const a=e.getNodeAttribute(s,"type"),i=structuredClone(e.getNodeAttribute(s,a).names);for(let t=0;t<Math.abs(M[n].defaultAttrs.names.length-i.length);t++)M[n].defaultAttrs.names.length>i.length?i.push("Stn"):i.pop();const r={...M[n].defaultAttrs,names:i};Object.values(t).includes(a)&&Object.values(t).includes(n)||(r.nameOffsetX=e.getNodeAttribute(s,a).nameOffsetX,r.nameOffsetY=e.getNodeAttribute(s,a).nameOffsetY),e.removeNodeAttribute(s,a),e.mergeNodeAttributes(s,{type:n,[n]:r})})),D=e("c",((e,t,s)=>{const n=e.getEdgeAttribute(t,"type"),a=e.getEdgeAttribute(t,"style");if(S[a].metadata.supportLinePathType.includes(s)){e.removeEdgeAttribute(t,n);const a=structuredClone(j[s].defaultAttrs);e.mergeEdgeAttributes(t,{type:s,[s]:a})}})),H=e("a",((e,t,s,n)=>{const a=e.getEdgeAttribute(t,"type"),i=e.getEdgeAttribute(t,"style");if(S[s].metadata.supportLinePathType.includes(a)){const a=e.getEdgeAttribute(t,"zIndex"),r=e.getEdgeAttribute(t,i);e.removeEdgeAttribute(t,i);const l=structuredClone(S[s].defaultAttrs);A.includes(i)&&A.includes(s)?l.color=r.color:A.includes(s)&&n&&(l.color=n),e.mergeEdgeAttributes(t,{style:s,[s]:l}),s===C.River?e.setEdgeAttribute(t,"zIndex",-5):e.setEdgeAttribute(t,"zIndex",null!=a?a:0)}}));e("C",(e=>{const{isOpen:t,onClose:X,isSelect:Y,filter:q}=e,{t:Q}=F(),$=x(),{selected:G,theme:J,paletteAppClip:{output:K}}=E((e=>e.runtime)),U=_.useCallback((()=>{$(v()),$(O()),$(T(V.current.export()))}),[$,v,O,T]),V=_.useRef(window.graph),Z={any:Q("header.settings.procedures.changeType.any"),...Object.fromEntries(Object.entries(j).map((([e,t])=>[e,Q(t.metadata.displayName).toString()])))},ee={any:Q("header.settings.procedures.changeType.any"),...Object.fromEntries(Object.entries(S).map((([e,t])=>[e,Q(t.metadata.displayName).toString()])))},te={any:Q("header.settings.procedures.changeType.any"),...Object.fromEntries(Object.entries(M).map((([e,t])=>[e,Q(t.metadata.displayName).toString()])))},se={id:"any",theme:[L.Other,"other","#ffffff",N.black],value:Q("header.settings.procedures.changeType.any")},[ne,ae]=_.useState(!1),[ie,re]=_.useState("any"),[le,oe]=_.useState(b.ShmetroBasic),[ce,de]=_.useState(!1),[ue,ge]=_.useState("any"),[he,pe]=_.useState(C.SingleColor),[ye,me]=_.useState(!1),[fe,be]=_.useState("any"),[Se,je]=_.useState(w.Diagonal),[Ae,Ce]=_.useState(!1),[xe,Ee]=_.useState(se),[ve,Oe]=_.useState(J),[Te,Le]=_.useState(!1);_.useEffect((()=>{Te&&K&&(Oe(K),Le(!1))}),[null==K?void 0:K.toString()]);const[Ne,we]=_.useState([]),We=[{id:"changeStationType",title:Q("header.settings.procedures.changeStationType.title"),onClose:()=>ae(!ne),field:[{type:"select",label:Q("header.settings.procedures.changeStationType.changeFrom"),options:te,value:ie,disabledOptions:[le],onChange:e=>re(e)},{type:"select",label:Q("header.settings.procedures.changeStationType.changeTo"),options:te,value:le,disabledOptions:["any",ie],onChange:e=>oe(e)}]},{id:"changeLineStyleType",title:Q("header.settings.procedures.changeLineStyleType.title"),onClose:()=>de(!ce),field:[{type:"select",label:Q("header.settings.procedures.changeLineStyleType.changeFrom"),options:ee,value:ue,disabledOptions:[he],onChange:e=>ge(e)},{type:"select",label:Q("header.settings.procedures.changeLineStyleType.changeTo"),options:ee,value:he,disabledOptions:["any",ue],onChange:e=>pe(e)}]},{id:"changeLinePathType",title:Q("header.settings.procedures.changeLinePathType.title"),onClose:()=>me(!ye),field:[{type:"select",label:Q("header.settings.procedures.changeLinePathType.changeFrom"),options:Z,value:fe,disabledOptions:[Se],onChange:e=>be(e)},{type:"select",label:Q("header.settings.procedures.changeLinePathType.changeTo"),options:Z,value:Se,disabledOptions:["any","simple",fe],onChange:e=>je(e)}]},{id:"changeColor",title:Q("header.settings.procedures.changeColor.title"),onClose:()=>Ce(!Ae),field:[{type:"custom",label:Q("header.settings.procedures.changeColor.changeFrom"),component:s.jsx(W,{data:Ne,displayHandler:e=>s.jsx(k,{name:e.value,fg:e.theme[3],bg:e.theme[2],title:e.theme[1],sx:{display:"inline-block",overflow:"hidden",textOverflow:"ellipsis"}}),filter:(e,t)=>t.id.toLowerCase().includes(e.toLowerCase())||Object.values(t.id).some((t=>t.toLowerCase().includes(e.toLowerCase()))),value:xe.value,onChange:e=>Ee(e)})},{type:"custom",label:Q("header.settings.procedures.changeColor.changeTo"),component:s.jsx(P,{theme:ve,onClick:()=>{Le(!0),$(z(J))}})}]}];return _.useEffect((()=>{t&&(ae(!1),de(!1),me(!1),Ce(!1),we([se,...I(V.current,Y?[...G].filter((e=>e.startsWith("stn")||e.startsWith("misc_node"))):V.current.nodes(),Y?[...G].filter((e=>e.startsWith("line"))):V.current.edges()).map((e=>({id:e.toString(),theme:e,value:"other"===e[1]?e[2]:e[1]})))]),Ee(se))}),[t]),s.jsxs(n,{isOpen:t,onClose:X,size:"md",scrollBehavior:"inside",children:[s.jsx(a,{}),s.jsxs(i,{children:[s.jsxs(r,{children:[s.jsx(l,{as:"b",fontSize:"xl",children:Q(Y?"panel.details.multipleSelection.change":"header.settings.procedures.changeType.title")}),s.jsx(o,{})]}),s.jsx(c,{children:s.jsx(d,{allowMultiple:!0,children:We.map((e=>s.jsxs(u,{children:[s.jsxs(g,{onClick:e.onClose,children:[s.jsx(h,{as:"span",flex:"1",textAlign:"left",children:s.jsx(l,{as:"b",fontSize:"md",children:e.title})}),s.jsx(p,{})]}),s.jsx(y,{pb:4,children:s.jsx(B,{fields:e.field,minW:270})})]},e.id)))})}),s.jsxs(m,{children:[s.jsx(f,{colorScheme:"blue",variant:"outline",mr:"1",onClick:X,children:Q("cancel")}),s.jsx(f,{colorScheme:"red",mr:"1",onClick:()=>{const e=null!=q&&q.includes("station")?[...G].filter((e=>e.startsWith("stn"))):Y?[]:V.current.filterNodes((e=>e.startsWith("stn"))),t=null!=q&&q.includes("misc-node")?[...G].filter((e=>e.startsWith("misc_node"))):Y?[]:V.current.filterNodes((e=>e.startsWith("misc_node"))),s=Y?[...G].filter((e=>e.startsWith("line"))):V.current.edges();q&&!q.includes("station")||!ne||((e,t,s,n)=>{n.filter((s=>"any"===t||e.getNodeAttribute(s,"type")===t)).forEach((t=>{R(e,t,s)}))})(V.current,ie,le,e),q&&!q.includes("line")||!ce||((e,t,s,n,a)=>{a.filter((s=>"any"===t||e.getEdgeAttribute(s,"style")===t)).forEach((t=>{H(e,t,s,n)}))})(V.current,ue,he,J,s),q&&!q.includes("line")||!ye||((e,t,s,n)=>{n.filter((s=>"any"===t||e.getEdgeAttribute(s,"type")===t)).forEach((t=>{D(e,t,s)}))})(V.current,fe,Se,s),Ae&&(q&&!q.includes("line")||((e,t,s,n)=>{n.filter((t=>A.includes(e.getEdgeAttribute(t,"style")))).forEach((n=>{const a=e.getEdgeAttributes(n),i=a[a.style].color;("any"===t||i[0]==t[0]&&i[1]==t[1]&&i[2]==t[2]&&i[3]==t[3])&&e.mergeEdgeAttributes(n,{[a.style]:{color:s}})}))})(V.current,"any"===xe.id?"any":xe.theme,ve,s),(!q||q.includes("misc-node")||q.includes("station"))&&((e,t,s,n,a)=>{[...n,...a].forEach((n=>{const a=e.getNodeAttributes(n).type,i=e.getNodeAttribute(n,a);if(void 0!==i.color){const e=i.color;("any"===t||e[0]==t[0]&&e[1]==t[1]&&e[2]==t[2]&&e[3]==t[3])&&(i.color=s)}e.mergeNodeAttributes(n,{[a]:i})}))})(V.current,"any"===xe.id?"any":xe.theme,ve,e,t)),U(),X()},isDisabled:!(ne||ce||ye||Ae),children:Q("apply")})]})]})]})}))}}}));
