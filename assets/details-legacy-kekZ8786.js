System.register(["./chakra-legacy-6R1jBPuQ.js","./index-legacy-SJXbxk3L.js","./react-legacy-J6S8G-Zx.js","./clipboard-legacy-GfEbKLQY.js","./stations-legacy-hvb1JNjK.js","./change-types-legacy-2Uwe1cRY.js","./misc-nodes-legacy-jOcpHp5f.js"],(function(e,t){"use strict";var n,r,s,i,a,l,d,o,u,c,p,h,g,m,x,j,f,b,y,v,w,A,N,E,C,z,S,k,W,O,T,R,P,I,_,D,F,L,M,U,q,V,$,B;return{setters:[e=>{n=e.j,r=e.a0,s=e.a1,i=e.a2,a=e.s,l=e.A,d=e.M,o=e.m,u=e.n,c=e.p,p=e.r,h=e.q,g=e.af},e=>{m=e.c,x=e.j,j=e.d,f=e.y,b=e.z,y=e.A,v=e.ak,w=e.T,A=e.O,N=e.ah,E=e.v,C=e.t,z=e.N,S=e.q,k=e.al,W=e.o,O=e.D,T=e.aj,R=e.am,P=e.an,I=e.ao,_=e.ap,D=e.n},e=>{F=e.b},e=>{L=e.u,M=e.e},e=>{U=e.s},e=>{q=e.d,V=e.e,$=e.f},e=>{B=e.m}],execute:function(){function t(){const{t:e}=m(),t=x(),{selected:l,theme:d,paletteAppClip:{output:o}}=j((e=>e.runtime)),u=F.useCallback((()=>{t(f()),t(b()),t(y(c.current.export()))}),[t,f,b,y]),c=F.useRef(window.graph),p=e=>{if(c.current.hasNode(e)){const t=c.current.getNodeAttributes(e),n=t.type;return e.startsWith("stn")?t[n].names.join("/"):n}if(c.current.hasEdge(e)){const[t,n]=c.current.extremities(e),r=c.current.getSourceAttributes(e),s=c.current.getTargetAttributes(e),i=r.type,a=s.type;return(t.startsWith("stn")?r[i].names[0]:i)+" - "+(n.startsWith("stn")?s[a].names[0]:a)}},[h,g]=F.useState(!1);return F.useEffect((()=>{var e;h&&o&&(e=o,l.forEach((t=>{if(c.current.hasEdge(t)){const n=c.current.getEdgeAttributes(t).style,r=c.current.getEdgeAttribute(t,n);n!==E.River&&void 0!==r.color&&(r.color=e),c.current.mergeEdgeAttributes(t,{[n]:r})}else if(c.current.hasNode(t)){const n=c.current.getNodeAttributes(t).type,r=c.current.getNodeAttribute(t,n);void 0!==r.color&&(r.color=e),c.current.mergeNodeAttributes(t,{[n]:r})}})),u(),g(!1))}),[null==o?void 0:o.toString()]),n.jsxs(r,{children:[n.jsxs(s,{as:"h5",size:"sm",children:[e("panel.details.selected")," ",l.size]}),n.jsx(v,{label:e("panel.details.multipleChangeColor"),children:n.jsx(w,{theme:d,onClick:()=>{g(!0),t(A(d))}})}),n.jsx(i,{m:"var(--chakra-space-1)",children:[...l].map((e=>{var r;return n.jsx(a,{width:"100%",size:"sm",variant:"solid",onClick:()=>t(N(new Set([e]))),overflow:"hidden",maxW:"270",textOverflow:"ellipsis",whiteSpace:"nowrap",display:"ruby",children:null===(r=p(e))||void 0===r?void 0:r.replaceAll("\\","⏎")},e)}))})]})}function G(){const{t:e}=m(),t=x(),r=F.useCallback((()=>{t(b()),t(y(g.current.export()))}),[t,b,y]),{selected:s,theme:i}=j((e=>e.runtime)),[h]=s,g=F.useRef(window.graph),[f,w]=F.useState(!1),A=F.useRef(null),N=Object.fromEntries(Object.entries(C).map((([t,n])=>[t,e(n.metadata.displayName).toString()]))),[W,O]=F.useState(g.current.getEdgeAttribute(h,"type")),[T,R]=F.useState(void 0),P=Object.fromEntries(Object.entries(z).map((([t,n])=>[t,e(n.metadata.displayName).toString()]))),[I,_]=F.useState(g.current.getEdgeAttribute(h,"style")),[D,L]=F.useState(void 0),M=Object.values(S).filter((e=>!z[I].metadata.supportLinePathType.includes(e))),U=Object.values(E).filter((e=>!z[e].metadata.supportLinePathType.includes(W))),$=e=>{e&&(T?(T&&(q(g.current,h,T),O(g.current.getEdgeAttribute(h,"type")),r()),R(void 0)):D&&(D&&(V(g.current,h,D,i),_(g.current.getEdgeAttribute(h,"style")),r()),L(void 0))),w(!1)};return n.jsxs(n.Fragment,{children:[n.jsx(v,{label:e("panel.details.info.linePathType"),minW:"276",children:n.jsx(k,{options:N,disabledOptions:M,defaultValue:W,value:W,onChange:({target:{value:e}})=>{R(e),w(!0)}})}),n.jsx(v,{label:e("panel.details.info.lineStyleType"),minW:"276",children:n.jsx(k,{options:P,disabledOptions:U,defaultValue:I,value:I,onChange:({target:{value:e}})=>{L(e),w(!0)}})}),n.jsx(l,{isOpen:f,leastDestructiveRef:A,onClose:()=>$(!1),children:n.jsx(d,{children:n.jsxs(o,{children:[n.jsx(u,{children:e("warning")}),n.jsx(c,{children:e("panel.details.changeLineTypeContent")}),n.jsxs(p,{children:[n.jsx(a,{ref:A,onClick:()=>$(!1),children:e("cancel")}),n.jsx(a,{ml:"2",colorScheme:"red",onClick:()=>$(!0),children:e("panel.details.changeType")})]})]})})})]})}function H(){const{t:e}=m(),t=x(),r=F.useCallback((()=>{t(f()),t(y(h.current.export()))}),[t,f,y]),{selected:s}=j((e=>e.runtime)),[i]=s,h=F.useRef(window.graph),[g,b]=F.useState(!1),w=F.useRef(null),[A,N]=F.useState(void 0),E=h.current.getNodeAttribute(i,"type"),C=Object.fromEntries(Object.entries(U).map((([t,n])=>[t,e(n.metadata.displayName).toString()]))),z=e=>{e&&A&&($(h.current,i,A),r()),N(void 0),b(!1)};return n.jsxs(n.Fragment,{children:[n.jsx(v,{label:e("panel.details.info.stationType"),minW:"276",children:n.jsx(k,{options:C,disabledOptions:[E],value:E,onChange:({target:{value:e}})=>{N(e),b(!0)}})}),n.jsx(l,{isOpen:g,leastDestructiveRef:w,onClose:()=>z(!1),children:n.jsx(d,{children:n.jsxs(o,{children:[n.jsx(u,{children:e("warning")}),n.jsx(c,{children:e("panel.details.changeStationTypeContent")}),n.jsxs(p,{children:[n.jsx(a,{ref:w,onClick:()=>z(!1),children:e("cancel")}),n.jsx(a,{ml:"2",colorScheme:"red",onClick:()=>z(!0),children:e("panel.details.changeType")})]})]})})})]})}function J(){const{t:e}=m(),i=x(),a=F.useCallback((()=>{i(f()),i(b()),i(y(o.current.export()))}),[i,b,y]),{selected:l}=j((e=>e.runtime)),[d]=l,o=F.useRef(window.graph),u=[];return 0===l.size||(1===l.size?(u.push({type:"input",label:e("panel.details.info.id"),value:d,minW:276}),u.push({type:"select",label:e("panel.details.info.zIndex"),value:d?o.current.hasNode(d)?o.current.getNodeAttribute(d,"zIndex"):o.current.hasEdge(d)?o.current.getEdgeAttribute(d,"zIndex"):0:0,options:Object.fromEntries(Array.from({length:11},((e,t)=>[t-5,(t-5).toString()]))),onChange:e=>(e=>{const t=Math.min(Math.max(e,-5),5);o.current.hasNode(d)&&o.current.setNodeAttribute(d,"zIndex",t),o.current.hasEdge(d)&&o.current.setEdgeAttribute(d,"zIndex",t),a()})(Number(e))})):l.size>1&&u.push({type:"input",label:e("panel.details.info.type"),value:"multiple selection",minW:276})),n.jsxs(r,{p:1,children:[n.jsx(s,{as:"h5",size:"sm",children:e("panel.details.info.title")}),n.jsx(W,{fields:u,minW:130}),1===l.size&&d.startsWith("stn")&&o.current.hasNode(d)&&o.current.getNodeAttribute(d,"type")in U&&n.jsx(H,{}),1===l.size&&d.startsWith("line")&&o.current.hasEdge(d)&&o.current.getEdgeAttribute(d,"type")in C&&o.current.getEdgeAttribute(d,"style")in z&&n.jsx(G,{}),l.size>1&&n.jsx(t,{})]})}function K(){const{t:e}=m(),t=x(),{selected:i}=j((e=>e.runtime)),[l]=i,d=F.useRef(window.graph),[o,u]=F.useState("undefined"),[c,p]=F.useState("undefined"),[h,g]=F.useState("undefined"),[f,b]=F.useState("undefined");F.useEffect((()=>{if(null!=l&&l.startsWith("line")){const[s,i]=d.current.extremities(l);if(u(s),p(i),s.startsWith("stn")){var e,t;const n=d.current.getNodeAttribute(s,"type");g(null!==(e=null===(t=d.current.getNodeAttribute(s,n))||void 0===t?void 0:t.names.at(0))&&void 0!==e?e:"undefined")}if(i.startsWith("stn")){var n,r;const e=d.current.getNodeAttribute(i,"type");b(null!==(n=null===(r=d.current.getNodeAttribute(i,e))||void 0===r?void 0:r.names.at(0))&&void 0!==n?n:"undefined")}}}),[i]);const y=L((()=>{t(O()),t(T(o))})),v=L((()=>{t(O()),t(T(c))})),w=[{type:"custom",label:e("panel.details.lineExtremities.source"),component:n.jsx(a,{flex:1,size:"sm",variant:"link",onClick:y,children:o}),minW:"full"},{type:"input",label:e("panel.details.lineExtremities.sourceName"),value:h,minW:"full"},{type:"custom",label:e("panel.details.lineExtremities.target"),component:n.jsx(a,{flex:1,size:"sm",variant:"link",onClick:v,children:c}),minW:"full"},{type:"input",label:e("panel.details.lineExtremities.targetName"),value:f,minW:"full"}];return n.jsxs(r,{p:1,children:[n.jsx(s,{as:"h5",size:"sm",children:e("panel.details.lineExtremities.title")}),n.jsx(W,{fields:w,minW:130})]})}function Q(){const{t:e}=m(),t=x(),i=F.useCallback((()=>{t(f()),t(b()),t(y(o.current.export()))}),[t,f,b,y]),{selected:a,refresh:{nodes:l}}=j((e=>e.runtime)),[d]=a,o=F.useRef(window.graph),[u,c]=F.useState({x:0,y:0});F.useEffect((()=>{if(null!=d&&d.startsWith("stn")||null!=d&&d.startsWith("misc_node_")){const e=o.current.getNodeAttribute(d,"x"),t=o.current.getNodeAttribute(d,"y");c({x:e,y:t})}}),[l,a]);const p=[{type:"input",label:e("panel.details.nodePosition.pos.x"),value:u.x.toString(),validator:e=>!Number.isNaN(e),onChange:e=>{o.current.mergeNodeAttributes(d,{x:Number(e)}),i()}},{type:"input",label:e("panel.details.nodePosition.pos.y"),value:u.y.toString(),validator:e=>!Number.isNaN(e),onChange:e=>{o.current.mergeNodeAttributes(d,{y:Number(e)}),i()}}];return n.jsxs(r,{p:1,children:[n.jsx(s,{as:"h5",size:"sm",children:e("panel.details.nodePosition.title")}),n.jsx(W,{fields:p,minW:130})]})}const X={...U,...B},Y=()=>{var e;const t=x(),{selected:r}=j((e=>e.runtime)),{t:s}=m(),[i]=r,a=window.graph.getNodeAttribute(i,"type"),l=a in X&&X[a].attrsComponent,d=null!==(e=window.graph.getNodeAttribute(i,a))&&void 0!==e?e:{};return l?n.jsx(l,{id:i,attrs:d,handleAttrsUpdate:(e,n)=>{const r=window.graph.getNodeAttribute(e,"type");window.graph.mergeNodeAttributes(e,{[r]:n}),t(f()),t(y(window.graph.export()))}}):n.jsx(h,{fontSize:"xs",m:"var(--chakra-space-1)",children:s("panel.details.unknown.error",{category:s("panel.details.unknown.node")})})},Z=()=>{var e,t;const r=x(),{selected:s}=j((e=>e.runtime)),{t:i}=m(),[a]=s,l=window.graph.getEdgeAttribute(a,"type"),d=null!==(e=window.graph.getEdgeAttribute(a,l))&&void 0!==e?e:{},o=l in C&&C[l].attrsComponent,u=window.graph.getEdgeAttribute(a,"style"),c=null!==(t=window.graph.getEdgeAttribute(a,u))&&void 0!==t?t:{},p=u in z&&z[u].attrsComponent;return n.jsxs(n.Fragment,{children:[o?n.jsx(o,{id:a,attrs:d,handleAttrsUpdate:(e,t)=>{window.graph.mergeEdgeAttributes(e,{[l]:t}),r(b()),r(y(window.graph.export()))}}):n.jsx(h,{fontSize:"xs",m:"var(--chakra-space-1)",children:i("panel.details.unknown.error",{category:i("panel.details.unknown.linePath")})}),p?n.jsx(p,{id:a,attrs:c,handleAttrsUpdate:(e,t)=>{window.graph.mergeEdgeAttributes(e,{[u]:t}),r(b()),r(y(window.graph.export()))}}):n.jsx(h,{fontSize:"xs",m:"var(--chakra-space-1)",children:i("panel.details.unknown.error",{category:i("panel.details.unknown.lineStyle")})})]})};e("default",(()=>{const{t:e}=m(),t=x(),i=F.useRef(window.graph),l=F.useCallback((()=>{t(f()),t(b()),t(y(i.current.export()))}),[t,f,b,y]),{selected:d,mode:o}=j((e=>e.runtime)),[u]=d;return n.jsxs(R,{isOpen:d.size>0&&!o.startsWith("line"),width:300,header:"Dummy header",alwaysOverlay:!0,children:[n.jsx(P,{onClose:()=>t(O()),children:e("panel.details.header")}),n.jsxs(I,{children:[n.jsx(J,{}),1===d.size&&i.current.hasNode(u)&&n.jsx(Q,{}),1===d.size&&i.current.hasEdge(u)&&n.jsx(K,{}),1===d.size&&n.jsxs(r,{p:1,children:[n.jsx(s,{as:"h5",size:"sm",children:e("panel.details.specificAttrsTitle")}),window.graph.hasNode(u)&&n.jsx(Y,{}),window.graph.hasEdge(u)&&n.jsx(Z,{})]})]}),n.jsx(_,{children:n.jsxs(g,{children:[1===d.size&&i.current.hasNode([...d].at(0))&&n.jsx(a,{size:"sm",variant:"outline",onClick:()=>(e=>{const n=structuredClone(i.current.getNodeAttributes(e));n.x+=50,n.y+=50;const r=e.startsWith("stn")?`stn_${D(10)}`:`misc_node_${D(10)}`;i.current.addNode(r,n),t(f()),t(y(i.current.export()))})([...d].at(0)),children:e("panel.details.footer.duplicate")}),n.jsx(a,{size:"sm",variant:"outline",onClick:()=>(e=>{const t=M(i.current,e);navigator.clipboard.writeText(t)})(d),children:e("panel.details.footer.copy")}),n.jsx(a,{size:"sm",variant:"outline",onClick:()=>{return e=d,t(O()),e.forEach((e=>{i.current.hasNode(e)?i.current.dropNode(e):i.current.hasEdge(e)&&i.current.dropEdge(e)})),void l();var e},children:e("panel.details.footer.remove")})]})})]})}))}}}));
