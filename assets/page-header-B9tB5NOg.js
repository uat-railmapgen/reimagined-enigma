import{j as e,at as U,$ as Z,au as V,a1 as F,a2 as K,a3 as Y,g as st,av as Gt,a4 as w,B as L,aw as de,ax as Se,ay as q,az as J,aA as X,as as Pt,h as Ve,O as R,a5 as le,aB as us,aC as gs,aD as fe,a7 as O,aE as E,a6 as Dt,aF as ut,aG as gt,af as Q,aH as mt,aI as te,U as Ee,aJ as Fe,aK as ms,aL as Ut,al as Zt,aM as nt,aN as xs,ak as Ke,aO as fs,aP as js,aQ as G,aR as kt,aS as bs,aT as A,aU as v,d as Vt,R as Ft,q as Kt,Z as Yt,W as ws,m as $,a8 as Ss,a9 as ys}from"./chakra-6oTi0Wmk.js";import{u as vs,r as T,a as B,E as he,M as Cs,c as qt,b as ye,S as _,C as zs,d as xt,n as ot,L as Jt,R as At,e as Xt,f as M,g as P,h as ks,i as As,j as Os,k as ve,s as Ms,l as _e,m as Ye,o as Ts,p as Ot,q as $t,t as pe,v as re,w as ae,x as Qt,y as it,z as Ce,A as Me,B as Mt,D as es,F as Tt,G as Es,H as Rs,I as Ns,J as Is,K as _s,N as Et,O as Hs,T as Ws,P as Ls,Q as Bs,U as Gs,V as Ps,W as je,X as Ds,Y as Us,Z as Zs,_ as Vs,$ as ne,a0 as Fs,a1 as Rt,a2 as Ks,a3 as Ys,a4 as qs,a5 as Js,a6 as Xs,a7 as $s,a8 as qe,a9 as Qs,aa as en,ab as tn,ac as sn,ad as nn,ae as on,af as rn,ag as Nt,ah as an,ai as ln,aj as cn}from"./index-CyduEWZJ.js";import{u as W,b as j,r as It,T as _t}from"./react-BuIY-1St.js";import{I as ts}from"./index-B_gHJ4Lp.js";import{F as Je,l as dn,m as hn,a as pn,i as un,s as gn,u as ss}from"./stations-BwJGRdt_.js";import{f as mn}from"./graph-BZkNb6Ve.js";import{C as xn}from"./change-type-modal-BjoBcCyK.js";var Ht=function(t){return vs(T.ready(),t)},fn={ar:{ar:"العربية",en:"Arabic",ko:"아랍어","zh-Hans":"阿拉伯文","zh-Hant":"阿拉伯文"},az:{az:"Azərbaycanca",en:"Azerbaijani",ko:"아제르바이잔어","zh-Hans":"阿塞拜疆文","zh-Hant":"阿塞拜疆文"},ca:{ca:"Català",en:"Catalan",ko:"카탈루냐어","zh-Hans":"加泰罗尼亚文","zh-Hant":"加泰隆尼亞文"},da:{da:"Dansk",en:"Danish",ko:"덴마크어","zh-Hans":"丹麦文","zh-Hant":"丹麥文"},de:{de:"Deutsch",en:"German",ko:"독일어","zh-Hans":"德文","zh-Hant":"德文"},el:{el:"Ελληνικά",en:"Greek",ko:"그리스어","zh-Hans":"希腊文","zh-Hant":"希臘文"},en:{en:"English",ja:"英語",ko:"영어","zh-Hans":"英文","zh-Hant":"英文"},es:{en:"Spanish",es:"Español",ko:"스페인어","zh-Hans":"西班牙文","zh-Hant":"西班牙文"},fa:{en:"Persian",fa:"فارسی",ko:"페르시아어","zh-Hans":"波斯文","zh-Hant":"波斯文"},fr:{en:"French",fr:"Français",ko:"프랑스어","zh-Hans":"法文","zh-Hant":"法文"},ga:{en:"Irish",ga:"Gaeilge",ko:"아일랜드어","zh-Hans":"爱尔兰文","zh-Hant":"愛爾蘭文"},gd:{en:"Scottish Gaelic",gd:"Gàidhlig",ko:"스코틀랜드 게일어","zh-Hans":"苏格兰盖尔文","zh-Hant":"蘇格蘭蓋爾文"},hi:{en:"Hindi",hi:"हिन्दी",ko:"힌디어","zh-Hans":"印地文","zh-Hant":"印地文"},hu:{en:"Hungarian",hu:"Magyar",ko:"헝가리어","zh-Hans":"匈牙利文","zh-Hant":"匈牙利文"},id:{en:"Indoesian",id:"Bahasa Indonesia",ko:"인도네시아어","zh-Hans":"印尼文","zh-Hant":"印尼文"},it:{en:"Italian",it:"Italiano",ko:"이탈리아어","zh-Hans":"意大利文","zh-Hant":"意大利文"},ja:{en:"Japanese",ja:"日本語",ko:"일본어","zh-Hans":"日文","zh-Hant":"日文"},kk:{en:"Kazakh",kk:"Қазақша",ko:"카자흐어","zh-Hans":"哈萨克文","zh-Hant":"哈薩克文"},ko:{en:"Korean",ja:"韓国語",ko:"한국어","zh-Hans":"韩文","zh-Hant":"韓文"},ms:{en:"Malay",ko:"말레이어",ms:"Bahasa Melayu","zh-Hans":"马来文","zh-Hant":"馬來文"},no:{en:"Norwegian",ko:"노르웨이어",no:"Norsk","zh-Hans":"挪威文","zh-Hant":"挪威文"},pl:{en:"Polish",ko:"폴란드어",pl:"Polski","zh-Hans":"波兰文","zh-Hant":"波蘭文"},pt:{en:"Portuguese",ko:"포르투갈어",pt:"Português","zh-Hans":"葡萄牙文","zh-Hant":"葡萄牙文"},ro:{en:"Romanian",ko:"루마니아어",ro:"Română","zh-Hans":"罗马尼亚文","zh-Hant":"羅馬尼亞文"},ru:{en:"Russian",ko:"러시아어",ru:"Русский","zh-Hans":"俄文","zh-Hant":"俄文"},sv:{en:"Swedish",ko:"스웨덴어",sv:"Svenska","zh-Hans":"瑞典文","zh-Hant":"瑞典文"},th:{en:"Thai",ko:"태국어",th:"ภาษาไทย","zh-Hans":"泰文","zh-Hant":"泰文"},tr:{en:"Turkish",ko:"튀르키예어",tr:"Türkçe","zh-Hans":"土耳其文","zh-Hant":"土耳其文"},uk:{en:"Ukrainian",ko:"우크라이나어",uk:"Українська","zh-Hans":"乌克兰文","zh-Hant":"烏克蘭文"},ur:{en:"Urdo",ko:"우르두어",ur:"اردو","zh-Hans":"乌尔都文","zh-Hant":"烏爾都文"},uz:{en:"Uzbek",ko:"우즈베크어",uz:"Oʻzbekcha","zh-Hans":"乌兹别克文","zh-Hant":"烏茲別克文"},vi:{en:"Vietnamese",ko:"베트남어",vi:"Tiếng Việt","zh-Hans":"越南文","zh-Hant":"越南文"},"zh-Hans":{en:"Simplified Chinese",ja:"中国語（簡体字）",ko:"중국어 간체자","zh-Hans":"简体中文","zh-Hant":"簡體中文"},"zh-Hant":{en:"Traditional Chinese",ja:"中国語（繁体字）",ko:"중국어 정체자","zh-Hans":"繁体中文","zh-Hant":"繁體中文"}};const jn="data:image/svg+xml,%3csvg%20width='98'%20height='96'%20xmlns='http://www.w3.org/2000/svg'%3e%3cpath%20fill-rule='evenodd'%20clip-rule='evenodd'%20d='M48.854%200C21.839%200%200%2022%200%2049.217c0%2021.756%2013.993%2040.172%2033.405%2046.69%202.427.49%203.316-1.059%203.316-2.362%200-1.141-.08-5.052-.08-9.127-13.59%202.934-16.42-5.867-16.42-5.867-2.184-5.704-5.42-7.17-5.42-7.17-4.448-3.015.324-3.015.324-3.015%204.934.326%207.523%205.052%207.523%205.052%204.367%207.496%2011.404%205.378%2014.235%204.074.404-3.178%201.699-5.378%203.074-6.6-10.839-1.141-22.243-5.378-22.243-24.283%200-5.378%201.94-9.778%205.014-13.2-.485-1.222-2.184-6.275.486-13.038%200%200%204.125-1.304%2013.426%205.052a46.97%2046.97%200%200%201%2012.214-1.63c4.125%200%208.33.571%2012.213%201.63%209.302-6.356%2013.427-5.052%2013.427-5.052%202.67%206.763.97%2011.816.485%2013.038%203.155%203.422%205.015%207.822%205.015%2013.2%200%2018.905-11.404%2023.06-22.324%2024.283%201.78%201.548%203.316%204.481%203.316%209.126%200%206.6-.08%2011.897-.08%2013.526%200%201.304.89%202.853%203.316%202.364%2019.412-6.52%2033.405-24.935%2033.405-46.691C97.707%2022%2075.788%200%2048.854%200z'%20fill='%2324292f'/%3e%3c/svg%3e",bn="data:image/svg+xml,%3c?xml%20version='1.0'%20encoding='utf-8'?%3e%3c!--%20Generator:%20Adobe%20Illustrator%2023.0.1,%20SVG%20Export%20Plug-In%20.%20SVG%20Version:%206.00%20Build%200)%20--%3e%3csvg%20version='1.1'%20id='Layer_1'%20xmlns='http://www.w3.org/2000/svg'%20xmlns:xlink='http://www.w3.org/1999/xlink'%20x='0px'%20y='0px'%20viewBox='0%200%20270%20270'%20style='enable-background:new%200%200%20270%20270;'%20xml:space='preserve'%3e%3cstyle%20type='text/css'%3e%20.st0{fill:%23E01E5A;}%20.st1{fill:%2336C5F0;}%20.st2{fill:%232EB67D;}%20.st3{fill:%23ECB22E;}%20%3c/style%3e%3cg%3e%3cg%3e%3cpath%20class='st0'%20d='M99.4,151.2c0,7.1-5.8,12.9-12.9,12.9c-7.1,0-12.9-5.8-12.9-12.9c0-7.1,5.8-12.9,12.9-12.9h12.9V151.2z'/%3e%3cpath%20class='st0'%20d='M105.9,151.2c0-7.1,5.8-12.9,12.9-12.9s12.9,5.8,12.9,12.9v32.3c0,7.1-5.8,12.9-12.9,12.9%20s-12.9-5.8-12.9-12.9V151.2z'/%3e%3c/g%3e%3cg%3e%3cpath%20class='st1'%20d='M118.8,99.4c-7.1,0-12.9-5.8-12.9-12.9c0-7.1,5.8-12.9,12.9-12.9s12.9,5.8,12.9,12.9v12.9H118.8z'/%3e%3cpath%20class='st1'%20d='M118.8,105.9c7.1,0,12.9,5.8,12.9,12.9s-5.8,12.9-12.9,12.9H86.5c-7.1,0-12.9-5.8-12.9-12.9%20s5.8-12.9,12.9-12.9H118.8z'/%3e%3c/g%3e%3cg%3e%3cpath%20class='st2'%20d='M170.6,118.8c0-7.1,5.8-12.9,12.9-12.9c7.1,0,12.9,5.8,12.9,12.9s-5.8,12.9-12.9,12.9h-12.9V118.8z'/%3e%3cpath%20class='st2'%20d='M164.1,118.8c0,7.1-5.8,12.9-12.9,12.9c-7.1,0-12.9-5.8-12.9-12.9V86.5c0-7.1,5.8-12.9,12.9-12.9%20c7.1,0,12.9,5.8,12.9,12.9V118.8z'/%3e%3c/g%3e%3cg%3e%3cpath%20class='st3'%20d='M151.2,170.6c7.1,0,12.9,5.8,12.9,12.9c0,7.1-5.8,12.9-12.9,12.9c-7.1,0-12.9-5.8-12.9-12.9v-12.9H151.2z'/%3e%3cpath%20class='st3'%20d='M151.2,164.1c-7.1,0-12.9-5.8-12.9-12.9c0-7.1,5.8-12.9,12.9-12.9h32.3c7.1,0,12.9,5.8,12.9,12.9%20c0,7.1-5.8,12.9-12.9,12.9H151.2z'/%3e%3c/g%3e%3c/g%3e%3c/svg%3e",wn=t=>{const{isOpen:r,onClose:l}=t,{t:s}=W(),i=T.getAppVersion();return e.jsxs(U,{isOpen:r,onClose:l,size:"xl",scrollBehavior:"inside",children:[e.jsx(Z,{}),e.jsxs(V,{children:[e.jsx(F,{children:s("header.about.title")}),e.jsx(K,{}),e.jsxs(Y,{paddingBottom:10,children:[e.jsxs(st,{direction:"row",children:[e.jsx(Gt,{boxSize:"128px",src:"/rmp//logo192.png"}),e.jsxs(st,{direction:"column",width:"100%",alignItems:"center",justifyContent:"center",children:[e.jsx(w,{fontSize:"xl",as:"b",children:s("header.about.rmp")}),e.jsx(w,{children:i}),e.jsx(w,{}),e.jsx(w,{fontSize:"sm",children:s("header.about.railmapgen")})]})]}),e.jsx(L,{margin:5,children:e.jsx(w,{fontSize:"xl",children:s("header.about.desc")})}),e.jsx(de,{as:"h5",size:"sm",mt:3,mb:2,children:s("header.about.contributors")}),e.jsx(de,{as:"h6",size:"xs",my:2,children:s("header.about.coreContributors")}),e.jsxs(Se,{children:[e.jsxs(q,{size:"lg",w:"85%",onClick:()=>window.open("https://github.com/thekingofcity","_blank"),cursor:"pointer",children:[e.jsx(J,{src:"https://github.com/thekingofcity.png",size:"lg",my:2,ml:-1,mr:2}),e.jsxs(X,{display:"block",width:"100%",children:[e.jsx(w,{fontSize:"lg",fontWeight:"bold",mb:1,children:"thekingofcity"}),e.jsx(w,{fontSize:"sm",children:s("header.about.content1")}),e.jsx(w,{fontSize:"sm",align:"right",mb:1,children:s("header.about.content2")})]})]}),e.jsxs(q,{size:"lg",w:"85%",onClick:()=>window.open("https://github.com/langonginc","_blank"),cursor:"pointer",children:[e.jsx(J,{src:"https://github.com/langonginc.png",size:"lg",my:2,ml:-1,mr:2}),e.jsxs(X,{display:"block",width:"100%",children:[e.jsx(w,{fontSize:"lg",fontWeight:"bold",mb:1,children:"langonginc"}),e.jsx(w,{fontSize:"sm",children:s("header.about.langonginc")}),e.jsx(w,{fontSize:"sm",align:"right",mb:1,children:"--Avicii"})]})]})]}),e.jsx(de,{as:"h6",size:"xs",my:2,children:s("header.about.styleContributors")}),e.jsxs(Se,{children:[e.jsxs(q,{size:"lg",w:"85%",onClick:()=>window.open("https://github.com/203IhzElttil","_blank"),cursor:"pointer",children:[e.jsx(J,{src:"https://github.com/203IhzElttil.png",size:"lg",my:2,ml:-1,mr:2}),e.jsxs(X,{display:"block",width:"100%",children:[e.jsx(w,{fontSize:"lg",fontWeight:"bold",mb:1,children:"203IhzElttil"}),e.jsx(w,{fontSize:"sm",mb:1,children:s("header.about.203IhzElttil")})]})]}),e.jsxs(q,{size:"lg",w:"85%",onClick:()=>window.open("https://github.com/Swiftiecott","_blank"),cursor:"pointer",children:[e.jsx(J,{src:"https://github.com/Swiftiecott.png",size:"lg",my:2,ml:-1,mr:2}),e.jsxs(X,{display:"block",width:"100%",children:[e.jsx(w,{fontSize:"lg",fontWeight:"bold",mb:1,children:"Swiftiecott"}),e.jsx(w,{fontSize:"sm",mb:1,children:s("header.about.Swiftiecott")})]})]})]}),e.jsx(de,{as:"h5",size:"sm",mt:3,mb:2,children:s("header.about.contactUs")}),e.jsxs(Se,{children:[e.jsxs(q,{size:"lg",w:"85%",onClick:()=>window.open("https://github.com/railmapgen/rmp/issues","_blank"),cursor:"pointer",children:[e.jsx(J,{src:jn,size:"lg",my:2,ml:-1,mr:2}),e.jsxs(X,{display:"block",width:"100%",children:[e.jsx(w,{fontSize:"lg",fontWeight:"bold",mb:1,children:s("header.about.github")}),e.jsx(w,{fontSize:"sm",children:s("header.about.githubContent")})]})]}),e.jsxs(q,{size:"lg",w:"85%",onClick:()=>window.open("https://join.slack.com/t/railmapgenerator/shared_invite/zt-1odhhta3n-DdZF~fnVwo_q0S0RJmgV8A","_blank"),cursor:"pointer",children:[e.jsx(J,{src:bn,size:"lg",my:2,ml:-1,mr:2}),e.jsxs(X,{display:"block",width:"100%",children:[e.jsx(w,{fontSize:"lg",fontWeight:"bold",mb:1,children:s("header.about.slack")}),e.jsx(w,{fontSize:"sm",children:s("header.about.slackContent")}),e.jsx(w,{fontSize:"sm",as:"i",children:"#rmp, #gallery, #rmg, #palette-and-templates"})]})]})]})]})]})]})},Sn=wn;function yn(t){return Pt({tag:"svg",attr:{viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round"},child:[{tag:"path",attr:{d:"M12 21a9 9 0 0 0 9 -9a9 9 0 0 0 -9 -9a9 9 0 0 0 -9 9a9 9 0 0 0 9 9z"},child:[]},{tag:"path",attr:{d:"M12 12m-4.5 0a4.5 4.5 0 1 0 9 0a4.5 4.5 0 1 0 -9 0"},child:[]}]})(t)}function vn(t){return Pt({tag:"svg",attr:{version:"1.1",viewBox:"0 0 17 17"},child:[{tag:"g",attr:{},child:[]},{tag:"path",attr:{d:"M13 10v-10h-13v13h13v-3zM1 1h11v8h-0.755l-2.564-3.319-1.159 1.214-2.248-3.881-3.576 5.986h-0.698v-8zM9.982 9h-7.119l2.398-4.014 2.064 3.564 1.275-1.337 1.382 1.787zM1 12v-2h11v2h-11zM17 3v13h-13v-1.984h1v0.984h11v-11h-2v-1h3z"},child:[]}]})(t)}const Cn="data:image/png;base64,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",zn="/rmp/assets/opencollective-icon-Ciasch0w.webp",kn=t=>{const{isOpen:r,onClose:l}=t,{t:s}=W(),{telemetry:{project:i}}=B(a=>a.app),n=()=>{T.isStandaloneWindow()?window.open("/rmp-gallery/#/donation","_blank"):T.openApp({appId:"rmp-gallery",hash:"/donation"})},o=a=>new URLSearchParams({title:"Donation: New ".concat(a," request for [city name]"),body:"Hi, I'd like to have new ".concat(a,", and here is my support.\n\n<!-- your donation entry -->\n\n<!-- reference (images or URLs) -->\n\n")}).toString();return j.useEffect(()=>{r&&i&&T.event(he.OPEN_DONATION,{})},[r]),e.jsxs(U,{isOpen:r,onClose:l,size:"xl",scrollBehavior:"inside",children:[e.jsx(Z,{}),e.jsxs(V,{children:[e.jsx(F,{children:s("header.donation.title")}),e.jsx(K,{}),e.jsxs(Y,{paddingBottom:10,children:[e.jsxs(st,{direction:"row",alignItems:"center",justifyContent:"space-around",children:[e.jsx(w,{fontSize:"96px",fontFamily:"serif",children:"I"}),e.jsx(ts,{size:"64px",color:"red"}),e.jsx(Gt,{boxSize:"96px",src:"/rmp//logo192.png"})]}),e.jsx(L,{margin:5,children:e.jsx(w,{fontSize:"xl",children:s("header.donation.content")})}),e.jsx(de,{as:"h5",size:"sm",mb:2,children:s("header.donation.rewards")}),e.jsxs(Se,{children:[e.jsxs(q,{size:"lg",w:"85%",onClick:n,cursor:"pointer",children:[e.jsx(J,{icon:e.jsx(vn,{}),size:"lg",my:2,ml:-1,mr:2}),e.jsxs(X,{display:"block",width:"100%",pb:1,children:[e.jsx(w,{fontSize:"lg",fontWeight:"bold",mb:1,children:s("header.donation.gallery")}),e.jsx(w,{fontSize:"sm",children:s("header.donation.galleryContent")})]})]}),e.jsxs(q,{size:"lg",w:"85%",onClick:()=>window.open("https://github.com/railmapgen/rmp/issues/new?"+o("stations/nodes"),"_blank"),cursor:"pointer",children:[e.jsx(J,{icon:e.jsx(yn,{}),size:"lg",my:2,ml:-1,mr:2}),e.jsxs(X,{display:"block",width:"100%",pb:1,children:[e.jsx(w,{fontSize:"lg",fontWeight:"bold",mb:1,children:s("header.donation.nodes")}),e.jsx(w,{fontSize:"sm",children:s("header.donation.nodesContent")})]})]}),e.jsxs(q,{size:"lg",w:"85%",onClick:()=>window.open("https://github.com/railmapgen/rmp/issues/new?"+o("features"),"_blank"),cursor:"pointer",children:[e.jsx(J,{icon:e.jsx(Cs,{}),size:"lg",my:2,ml:-1,mr:2}),e.jsxs(X,{display:"block",width:"100%",pb:1,children:[e.jsx(w,{fontSize:"lg",fontWeight:"bold",mb:1,children:s("header.donation.features")}),e.jsx(w,{fontSize:"sm",children:s("header.donation.featuresContent")})]})]})]}),e.jsx(de,{as:"h5",size:"sm",mt:3,mb:2,children:s("header.donation.methods")}),e.jsxs(Se,{children:[e.jsxs(q,{size:"lg",w:"85%",onClick:()=>window.open("https://opencollective.com/rail-map-toolkit","_blank"),cursor:"pointer",children:[e.jsx(J,{src:zn,size:"lg",my:2,ml:-1,mr:2}),e.jsxs(X,{display:"block",width:"100%",pb:1,children:[e.jsx(w,{fontSize:"lg",fontWeight:"bold",mb:1,children:s("header.donation.openCollective")}),e.jsx(w,{fontSize:"sm",children:s("header.donation.viaUSD")})]})]}),e.jsxs(q,{size:"lg",w:"85%",onClick:()=>window.open("https://afdian.com/a/rail-map-toolkit","_blank"),cursor:"pointer",children:[e.jsx(J,{src:Cn,size:"lg",my:2,ml:-1,mr:2}),e.jsxs(X,{display:"block",width:"100%",pb:1,children:[e.jsx(w,{fontSize:"lg",fontWeight:"bold",mb:1,children:s("header.donation.afdian")}),e.jsx(w,{fontSize:"sm",children:s("header.donation.viaCNY")})]})]})]})]})]})]})},An=kn;/*!
 * canvas-size
 * v2.0.0
 * https://github.com/jhildenbiddle/canvas-size
 * (c) 2015-2024 John Hildenbiddle <http://hildenbiddle.com>
 * MIT license
 */function Te(t){const r=t.sizes.shift(),l=Math.max(Math.ceil(r[0]),1),s=Math.max(Math.ceil(r[1]),1),i=[l-1,s-1,1,1],n=performance.now(),o=typeof WorkerGlobalScope<"u"&&self instanceof WorkerGlobalScope;let a,c;o?(a=new OffscreenCanvas(1,1),c=new OffscreenCanvas(l,s)):(a=document.createElement("canvas"),a.width=1,a.height=1,c=document.createElement("canvas"),c.width=l,c.height=s);const m=a.getContext("2d"),h=c.getContext("2d");h&&(h.fillRect.apply(h,i),m.drawImage(c,l-1,s-1,1,1,0,0,1,1));const u=m&&m.getImageData(0,0,1,1).data[3]!==0,p=parseInt(performance.now()-n);return[a,c].forEach(d=>{d.height=0,d.width=0}),o?(postMessage({width:l,height:s,testTime:p,isTestPass:u}),!u&&t.sizes.length&&setTimeout(()=>{Te(t)},0)):u?t.onSuccess({width:l,height:s,testTime:p}):(t.onError({width:l,height:s,testTime:p}),t.sizes.length&&setTimeout(()=>{Te(t)},0)),u}const Xe={area:[16384,14188,11402,11180,10836,8192,4096,1],height:[8388607,65535,32767,16384,8192,4096,1],width:[4194303,65535,32767,16384,8192,4096,1]},we={max:null,min:1,sizes:[],step:1024,useWorker:!1,onError:Function.prototype,onSuccess:Function.prototype},Ae={};function $e(t){const r=t.width===t.height,l=t.height===1,s=t.width===1,i=[];if(!t.width||!t.height)t.sizes.forEach(n=>{const o=r||l?n:1,a=r||s?n:1;i.push([o,a])});else{const n=t.min||we.min,o=t.step||we.step;let a=Math.max(t.width,t.height);for(;a>=n;){const c=r||l?a:1,m=r||s?a:1;i.push([c,m]),a-=o}}return i}function Ie(t){const r=typeof window<"u",l=r&&"Promise"in window,s=r&&"HTMLCanvasElement"in window,i=r&&"OffscreenCanvas"in window,n=URL.createObjectURL(new Blob([])).slice(-36),o=performance.now(),{onError:a,onSuccess:c,...m}=t,h=()=>parseInt(performance.now()-o);let u=null;if(!s)return!1;if(t.useWorker&&i){const p="\n            var canvasTest = ".concat(Te.toString(),";\n            onmessage = function(e) {\n                canvasTest(e.data);\n            };\n        "),d=new Blob([p],{type:"application/javascript"}),g=URL.createObjectURL(d);u=new Worker(g),URL.revokeObjectURL(g),u.onmessage=function(x){const{width:f,height:b,testTime:S,isTestPass:y}=x.data,k={width:f,height:b,testTime:S,totalTime:h()};y?(Ae[n].onSuccess(k),delete Ae[n]):Ae[n].onError(k)}}if(l)return new Promise(p=>{const d={...t,onError(g){let{width:x,height:f,testTime:b}=g;const S={width:x,height:f,testTime:b,totalTime:h()};let y;if(t.sizes.length===0)y=!0;else{const[[k,I]]=t.sizes.slice(-1);y=x===k&&f===I}a(S),y&&p({...S,success:!1})},onSuccess(g){let{width:x,height:f,testTime:b}=g;const S={width:x,height:f,testTime:b,totalTime:h()};c(S),p({...S,success:!0})}};if(u){const{onError:g,onSuccess:x}=d;Ae[n]={onError:g,onSuccess:x},u.postMessage(m)}else Te(d)});if(u)Ae[n]={onError:a,onSuccess:c},u.postMessage(m);else return Te(t)}const On={maxArea(){let t=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};const r=$e({width:t.max,height:t.max,min:t.min,step:t.step,sizes:[...Xe.area]}),l={...we,...t,sizes:r};return Ie(l)},maxHeight(){let t=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};const r=$e({width:1,height:t.max,min:t.min,step:t.step,sizes:[...Xe.height]}),l={...we,...t,sizes:r};return Ie(l)},maxWidth(){let t=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};const r=$e({width:t.max,height:1,min:t.min,step:t.step,sizes:[...Xe.width]}),l={...we,...t,sizes:r};return Ie(l)},test(){let t=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};const r={...we,...t};return r.sizes=[...r.sizes],r.width&&r.height&&(r.sizes=[[r.width,r.height]]),Ie(r)}},rt=(t,r,l)=>{const s=new Blob([l],{type:r});ns(t,s)},ns=(t,r)=>{const l=window.URL.createObjectURL(r),s=document.createElement("a");s.href=l,s.download=t,document.body.appendChild(s),s.click(),document.body.removeChild(s),window.URL.revokeObjectURL(l)},Mn=async(t,r,l,s)=>{const{xMin:i,yMin:n,xMax:o,yMax:a}=qt(t),[c,m]=[o-i,a-n],h=document.getElementById("canvas").cloneNode(!0);[...h.children].filter(p=>t.hasNode(p.id)&&t.getNodeAttribute(p.id,"type")===ye.Virtual).forEach(p=>h.removeChild(p)),r||h.appendChild(Rn(o-400,a-120)),h.setAttribute("viewBox","".concat(i," ").concat(n," ").concat(c," ").concat(m)),h.setAttribute("width",c.toString()),h.setAttribute("height",m.toString()),Object.entries({".rmp-name-outline":["paint-order","stroke","stroke-linejoin"]}).forEach(([p,d])=>{const g=document.querySelector(p);if(g===null)return;const x=window.getComputedStyle(g);h.querySelectorAll(p).forEach(f=>{if(p===".rmp-name-outline"&&s===1.1){const b=f.insertAdjacentElement("afterend",f.cloneNode(!0));b&&(b.classList.remove(p.slice(1)),b.classList.length===0&&f.removeAttribute("class"),b.removeAttribute("stroke-width"))}d.forEach(b=>{f.setAttribute(b,x.getPropertyValue(b))}),f.classList.remove(p.slice(1)),f.classList.length===0&&f.removeAttribute("class")})}),h.querySelectorAll('[fill="url(#opaque)"]').forEach(p=>{p.setAttribute("fill","white"),p.setAttribute("fill-opacity","0")});const u=mn(t);return await Tn(h,t,u,l),await En(h,t,u),{elem:h,width:c,height:m}},Tn=async(t,r,l,s)=>{var n;const i=new Set;if(Object.keys(Je).filter(o=>l[o]).forEach(o=>i.add(o)),r.filterNodes((o,a)=>o.startsWith("misc_node_")&&a.type===ye.Text).map(o=>r.getNodeAttribute(o,ye.Text).language).map(o=>dn[o]).filter(o=>o!==_.ShmetroBasic).forEach(o=>i.add(o)),s)[".rmp-name__zh",".rmp-name__en"].forEach(o=>{t.querySelectorAll(o).forEach(a=>{a.classList.remove(o.slice(1)),a.classList.length===0&&a.removeAttribute("class")})}),i.forEach(o=>{Je[o].className.forEach(a=>{t.querySelectorAll(a).forEach(c=>{c.classList.remove(a.slice(1)),c.classList.length===0&&c.removeAttribute("class")})})});else{const o=document.createElement("style");for(let a=0;a<document.styleSheets.length;a=a+1)if((n=document.styleSheets[a].href)!=null&&n.endsWith("styles/fonts.css")){o.textContent=[...document.styleSheets[a].cssRules].map(c=>c.cssText).join("\n");break}t.prepend(o),await Promise.all([...i.values()].map(a=>Je[a]).map(async({cssName:a,cssFont:c})=>{try{t.prepend(await hn(c,a))}catch(m){alert("Failed to load fonts. Fonts in the exported PNG will be missing."),console.error(m)}}))}},En=async(t,r,l)=>{if(l[ye.Facilities]){const s=r.filterNodes((a,c)=>c.type===ye.Facilities),i=Object.fromEntries(Object.values(pn).map(a=>[a,[]]));s.forEach(a=>{var m;const c=(m=r.getNodeAttribute(a,ye.Facilities))==null?void 0:m.type;c&&i[c].push(a)});const n=Object.entries(i).filter(([a,c])=>c.length>0).map(([a,c])=>a),o=await Promise.all((await Promise.all(n.map(async a=>await fetch("/rmp//images/facilities/".concat(a,".svg"))))).map(a=>a.text()));n.forEach((a,c)=>{const m=document.createElement("div");m.innerHTML=o[c];const h=m.querySelector("svg"),u=document.createElementNS("http://www.w3.org/2000/svg","symbol");for(const p of h.attributes)u.setAttribute(p.name,p.value);for(;h.firstChild;)u.appendChild(h.firstChild);h.replaceWith(u),u.id=a,t.appendChild(u),i[a].forEach(p=>{const d=t.querySelector("#".concat(p)),g=d==null?void 0:d.querySelector("image");if(g){d.removeChild(g);const x=document.createElementNS("http://www.w3.org/2000/svg","use");x.setAttribute("href","#".concat(a)),x.setAttribute("height",u.getAttribute("height")),x.setAttribute("width",u.getAttribute("width")),d.appendChild(x)}}),m.remove()})}},Rn=(t,r)=>{const l=document.createElementNS("http://www.w3.org/2000/svg","g");l.setAttribute("transform","translate(".concat(t,", ").concat(r,")scale(2)"));const s=document.createElementNS("http://www.w3.org/2000/svg","image");s.setAttribute("width","40"),s.setAttribute("height","40"),s.setAttribute("x","-50"),s.setAttribute("y","-20");const i=document.createElementNS("http://www.w3.org/2000/svg","text");i.setAttribute("font-family","Arial, sans-serif"),i.setAttribute("font-size","16"),i.appendChild(document.createTextNode("Rail Map Painter"));const n=document.createElementNS("http://www.w3.org/2000/svg","text");return n.setAttribute("font-family","Arial, sans-serif"),n.setAttribute("font-size","10"),n.setAttribute("y","10"),n.appendChild(document.createTextNode("https://railmapgen.github.io/rmp/")),l.appendChild(s),l.appendChild(i),l.appendChild(n),l};var Re=(t=>(t.left="l",t.right="r",t))(Re||{}),ce=(t=>(t.through="through",t.nonThrough="nonthrough",t))(ce||{}),We=(t=>(t.local="local",t.express="express",t.direct="direct",t))(We||{}),oe=(t=>(t.MTR="mtr",t.GZMTR="gzmtr",t.SHMetro="shmetro",t))(oe||{}),ft=(t=>(t.sh="sh",t.sh2020="sh2020",t))(ft||{});const se=new Set,at=new Set,lt=new Set,ct=new Set,dt=new Map,ie=new Map,Qe=new Set,et=new Map,D=new Map;let N=[],Oe=0;const He=new Map,tt=new Map,ht=new Set,Nn={name:["LEFT END","LEFT END"],num:"00",services:[We.local],parents:[],children:["lineend"],transfer:{groups:[{}],tick_direc:Re.right,paid_area:!0},loop_pivot:!1,one_line:!0,int_padding:355},In={name:["RIGHT END","RIGHT END"],num:"00",services:[We.local],parents:[],children:[],transfer:{groups:[{}],tick_direc:Re.right,paid_area:!0},loop_pivot:!1,one_line:!0,int_padding:355},_n={},os={svgWidth:{destination:1500,runin:1500,railmap:1500,indoor:1500},svg_height:400,style:oe.SHMetro,y_pc:50,padding:10,branchSpacingPct:33,direction:Re.right,platform_num:"1",theme:[zs.Shanghai,"sh1","#E3002B",xt.white],line_name:["地鐵線","Metro Line"],current_stn_idx:"jlaMj2",stn_list:_n,namePosMTR:{isStagger:!0,isFlip:!0},customiseMTRDest:{isLegacy:!1,terminal:!1},line_num:"1",psd_num:"1",info_panel_type:ft.sh,direction_gz_x:40,direction_gz_y:70,coline:{},loop:!1,loop_info:{bank:!0,left_and_right_factor:0,bottom_factor:1}},Hn={name:["",""],num:"",services:[We.local],parents:[],children:[],transfer:{groups:[{}],tick_direc:Re.right,paid_area:!0},loop_pivot:!1,one_line:!0,int_padding:355},C=t=>"".concat(t[0],"/").concat(t[1],"=").concat(t[2]).concat(t[3]),jt=t=>Jt.includes(t),Wn=t=>{if(jt(t.style))return structuredClone(t[t.style].color)},Ln=(t,r)=>{const[l,s]=t.extremities(r),i=t.getEdgeAttributes(r),n=i.style;if(l!=s&&jt(n)){const o=Wn(i);ct.has(C(o))||(lt.add(o),ct.add(C(o)),dt.set(o,l),ie.set(C(o),new Set)),ie.get(C(o)).add(l),ie.get(C(o)).add(s),D.has(l)?N.push({target:s,next:D.get(l),color:o}):N.push({target:s,next:-1,color:o}),D.set(l,Oe),Oe++,D.has(s)?N.push({target:l,next:D.get(s),color:o}):N.push({target:l,next:-1,color:o}),D.set(s,Oe),Oe++}},is=(t,r,l)=>{if(ie.get(C(l)).has(t)){ie.get(C(l)).delete(t);for(let s=D.get(t);s!=-1;s=N[s].next){const i=N[s].target,n=N[s].color;C(n)==C(l)&&is(i,t,l)}}},rs=(t,r,l)=>{if(se.has(t))return;se.add(t);let s=0;const i=new Set;for(let n=D.get(t);n!=-1;n=N[n].next){const o=N[n].target,a=N[n].color;C(a)==C(l)&&(i.has(o)||(i.add(o),s++,o!=r&&rs(o,t,l)))}He.set(t,s)},Wt=(t,r)=>{const l=t.stn_list.lineend.parents;l.push(r),t.stn_list.lineend.parents=structuredClone(l).reverse(),t.stn_list.lineend.branch={...t.stn_list.lineend.branch,left:t.stn_list.lineend.parents.length==2?[ce.through,l[1]]:void 0}},Bn=(t,r)=>{let l=0;for(let s=D.get(t);s!=-1;s=N[s].next){N[s].target;const i=N[s].color;C(i)==C(r)&&l++}return l},as=(t,r,l)=>{if(ht.has(t))return[];ht.add(t);const s=[];for(let i=D.get(t);i!=-1;i=N[i].next){const n=N[i].target,o=N[i].color;n!=r&&C(o)==C(l)&&(n.startsWith("stn")?s.push(n):s.push(...as(n,t,l)))}return s},pt=(t,r,l,s,i,n,o)=>{var p;if(se.has(t)&&(!t.startsWith("misc_node_")&&o.stn_list[t]==null||t.startsWith("misc_node_")&&!at.has(t)||o.loop))return[];if(se.has(t)&&o.stn_list[t]!=null&&Bn(t,n)-1>=2){const d=[...o.stn_list[t].parents,r];if(o.stn_list[d[1]]==null){const f=d[0];d[0]=d[1],d[1]=f}o.stn_list[t].parents=structuredClone(d).reverse(),o.stn_list[t].branch={...o.stn_list[t].branch,left:[ce.through,d[1]]};const g=[];for(const f of o.stn_list[t].children)f!=r&&g.push(f);o.stn_list[t].children=structuredClone(g),(p=o.stn_list[t].branch)==null||delete p.right;const x=[];for(const f of o.stn_list.lineend.parents)f!=t&&x.push(f);return o.stn_list.lineend.parents=structuredClone(x).reverse(),o.stn_list.lineend.branch={...o.stn_list.lineend.branch,left:o.stn_list.lineend.parents.length==2?[ce.through,x[1]]:void 0},g.length==0&&(o.stn_list[t].children=["lineend"],Wt(o,t)),[t]}se.add(t);const a=[],c=[],m=[],h=new Set,u=new Set;for(let d=D.get(t);d!=-1;d=N[d].next){const g=N[d].target,x=N[d].color;if(g!=l){if(C(x)==C(n)){if(u.has(g))continue;if(u.add(g),t.startsWith("misc_node_")){const f=pt(g,r,t,s+1,i,n,o);f.length!=0&&a.push(...f)}else{const f=pt(g,t,t,s+1,i,n,o);f.length!=0&&a.push(...f)}}if(!h.has(C(x))&&C(x)!=C(n)){h.add(C(x));const f={theme:x,name:["ch_".concat(C(x)),"en_".concat(C(x))]};m.push(f)}}}if(a.length==2){for(let d=0;d<2;d++)a[d]=="lineend"&&a.splice(d,1);if(o.stn_list[a[1]].parents.length>=2){const d=a[0];a[0]=a[1],a[1]=d}}if(se.has(t)&&o.stn_list[t]!=null){const d=[];for(const g of o.stn_list.lineend.parents)g!=t&&d.push(g);o.stn_list.lineend.parents=structuredClone(d).reverse(),o.stn_list.lineend.branch={...o.stn_list.lineend.branch,left:o.stn_list.lineend.parents.length==2?[ce.through,d[1]]:void 0},a.length==0&&(ht.clear(),c.push(...as(t,r,n)))}if(t.startsWith("misc_node_"))return at.add(t),a;{const d=i.getNodeAttributes(t).type,g=i.getNodeAttributes(t)[d];if(o.stn_list[t]=structuredClone(Hn),o.stn_list[t].name=[g.names[0],g.names[1]],o.stn_list[t].num=String(s),i.getNodeAttributes(t).type==_.GzmtrBasic){const x=g;o.stn_list[t].num=x.stationCode,o.stn_list[t].secondaryName=x.secondaryNames}if(i.getNodeAttributes(t).type==_.GzmtrInt){const x=g,f=x.transfer[0];for(const b of f)if(C(b)==C(n)){o.stn_list[t].num=String(b[5]);break}o.stn_list[t].secondaryName=x.secondaryNames}return a.length!=0?(o.stn_list[t].children=structuredClone(a).reverse(),a.length==2&&(o.stn_list[t].branch={...o.stn_list[t].branch,right:[ce.through,a[1]]})):(o.stn_list[t].children=["lineend"],Wt(o,t)),c.push(r),o.stn_list[t].parents=structuredClone(c).reverse(),c.length==2&&(o.stn_list[t].branch={...o.stn_list[t].branch,left:[ce.through,c[1]]}),m.length!=0&&(o.stn_list[t].transfer.groups[0].lines=structuredClone(m)),[t]}},Gn=(t,r,l,s)=>{const i=structuredClone(os);s=="LOOP"&&(i.loop=!0);let n;switch(t.getNodeAttributes(l).type){case _.GzmtrBasic:case _.GzmtrInt:n=oe.GZMTR;break;case _.MTR:n=oe.MTR;break;default:n=oe.SHMetro;break}i.theme=structuredClone(r),i.style=n,i.stn_list.linestart=structuredClone(Nn),i.stn_list.lineend=structuredClone(In),se.clear(),at.clear();const o=pt(l,"linestart","linestart",1,t,r,i);if(i.current_stn_idx=o[0],i.stn_list.linestart.children=[o[0]],!(Object.keys(i.stn_list).length<=3||i.stn_list.lineend.parents.length>=3))return structuredClone(i)},Pn=t=>{se.clear(),lt.clear(),ct.clear(),dt.clear(),ie.clear(),Qe.clear(),et.clear(),D.clear(),N=[],Oe=0,He.clear(),tt.clear(),t.filterEdges(s=>s.startsWith("line")).forEach(s=>{jt(t.getEdgeAttributes(s).style)&&Ln(t,s)});let r=0;t.forEachNode(s=>{tt.set(s,++r)}),tt.set("lineend",++r);const l=[];for(const s of lt){let i=0;for(;ie.get(C(s)).size!=0;){let n="line_root";ie.get(C(s)).forEach(a=>{n=="line_root"&&(n=a)}),is(n,"line_root",s);const o={theme:s,index:++i};Qe.add(o),et.set(o,n)}}for(const s of Qe){const{theme:i}=s;se.clear(),He.clear(),rs(et.get(s),"line_root",i);let n=!0,o="LINE";const a=[];for(const[m,h]of He)h==1&&a.push(m),h==3&&(o="BRANCH"),h>3&&(n=!1);if(!n)continue;a.length==0&&(o="LOOP",a.push(dt.get(i)));const c=[];for(const m of a){const h=Gn(t,i,m,o);h!=null&&c.push([h,h.stn_list[h.current_stn_idx].name[0],h.stn_list[h.current_stn_idx].name[1]])}c.length!=0&&l.push({id:ot(10),theme:i,param:structuredClone(c),type:o})}return l},Dn=t=>t[0]!=""&&t[1]!=""?t[0]+"_"+t[1]:t[0]!=""?t[0]:t[1]!=""?t[1]:"".concat(new Date().valueOf()),Un=(t,r)=>{let l=t;return r.forEach((s,i)=>{const n=new RegExp("ch_".concat(i),"g"),o=new RegExp("en_".concat(i),"g");l=l.replace(n,s[0]),l=l.replace(o,s[1])}),l},Zn=(t,r,l,s)=>{t.line_name=r,t.line_num=String(l),rt("RMG_".concat(Dn(r),".json"),"application/json",Un(JSON.stringify(t),s))},Vn={LINE:"#33ccff",BRANCH:"#007B61",LOOP:"#ff6666"},Fn=t=>{const{isOpen:r,onClose:l}=t,{t:s}=W(),i=j.useRef(window.graph),[n,o]=j.useState(!1),[a,c]=j.useState([[os,"",""]]),[m,h]=j.useState(["","",""]),[u,p]=j.useState(new Map),[d,g]=j.useState(new Map),[x,f]=j.useState([]);j.useEffect(()=>{if(r){const S=Pn(i.current),y=new Map;S.forEach(({id:k,theme:I})=>{y.set(C(I),k)}),f(S),p(y)}},[r]);const b=(S,y)=>document.getElementById("2RMG_"+y+"_"+S).value.trim();return e.jsxs(U,{isOpen:r,onClose:l,size:"2xl",scrollBehavior:"inside",children:[e.jsx(Z,{}),e.jsxs(V,{children:[e.jsx(F,{children:e.jsx(w,{as:"b",fontSize:"xl",children:s("header.download.2rmg.title")})}),e.jsx(K,{}),e.jsxs(Y,{children:[e.jsx(w,{fontSize:"sm",mt:"3",lineHeight:"100%",children:s("header.download.2rmg.info1")}),e.jsx(w,{fontSize:"sm",mt:"3",lineHeight:"100%",children:s("header.download.2rmg.info2")}),e.jsx("br",{}),x.length===0?e.jsx(w,{fontSize:"md",children:s("header.download.2rmg.noline")}):e.jsx("table",{children:e.jsx("tbody",{children:x.map(({id:S,theme:y,param:k,type:I})=>e.jsxs("tr",{children:[e.jsx("td",{children:e.jsx(At,{name:y[0]=="other"&&y[1]=="other"?y[2]:y[1],bg:y[2],fg:y[3]})}),e.jsx("td",{children:e.jsx(Ve,{placeholder:s("header.download.2rmg.placeholder.chinese"),id:"2RMG_nameCh_".concat(S),size:"sm"})}),e.jsx("td",{children:e.jsx(Ve,{placeholder:s("header.download.2rmg.placeholder.english"),id:"2RMG_nameEn_".concat(S),size:"sm"})}),e.jsx("td",{children:e.jsx(Ve,{placeholder:s("header.download.2rmg.placeholder.lineCode"),id:"2RMG_lineNum_".concat(S),size:"sm"})}),e.jsx("td",{children:e.jsx(At,{name:s("header.download.2rmg.type.".concat(I.toLowerCase())),bg:Vn[I],fg:xt.white})}),e.jsx("td",{children:e.jsx(R,{colorScheme:"blue",variant:"ghost",mr:"1",onClick:()=>{const H=b(S,"nameCh"),Le=b(S,"nameEn"),Be=b(S,"lineNum"),ue=new Map;u.forEach((ge,Ge)=>{ue.set(Ge,[b(ge,"nameCh"),b(ge,"nameEn")])}),c(k),h([H,Le,Be]),g(ue),o(!0)},size:"sm",children:e.jsx(Xt,{})})})]},JSON.stringify(y)))})})]}),e.jsx(le,{children:e.jsx(R,{colorScheme:"blue",variant:"outline",mr:"1",onClick:l,children:s("close")})})]}),e.jsx(Kn,{isOpen:n,onClose:()=>o(!1),param:a,nameList:m,interchangeName:d})]})},Kn=t=>{const{isOpen:r,onClose:l,param:s,nameList:i,interchangeName:n}=t,{t:o}=W(),[a,c]=j.useState("");return j.useEffect(()=>{i[0]!=""&&i[1]!=""?c(i[0]+"/"+i[1]):i[0]!=""?c(i[0]):i[1]!=""?c(i[1]):c("")},[...i]),e.jsxs(U,{isOpen:r,onClose:l,size:"md",scrollBehavior:"inside",children:[e.jsx(Z,{}),e.jsxs(V,{children:[e.jsx(F,{children:e.jsxs(w,{as:"b",fontSize:"xl",children:[o("header.download.2rmg.download")," ",a]})}),e.jsx(K,{}),e.jsx(Y,{children:e.jsxs(us,{children:[e.jsx(w,{fontSize:"sm",mb:"2",lineHeight:"100%",children:o("header.download.2rmg.downloadInfo")}),s.map(([m,h,u])=>e.jsxs(R,{onClick:()=>{Zn(m,[i[0],i[1]],i[2],n)},overflow:"hidden",size:"md",textOverflow:"ellipsis",whiteSpace:"nowrap",display:"ruby",children:[h.replaceAll("\\","⏎"),"/",u.replaceAll("\\","⏎")]},"".concat(h).concat(u)))]})}),e.jsx(le,{children:e.jsx(R,{colorScheme:"blue",variant:"outline",mr:"1",onClick:l,children:o("close")})})]})]})},Yn=t=>{const{isOpen:r,onClose:l}=t,{t:s}=W();return e.jsxs(U,{isOpen:r,onClose:l,size:"xl",scrollBehavior:"inside",children:[e.jsx(Z,{}),e.jsxs(V,{children:[e.jsx(F,{children:s("header.download.termsAndConditions")}),e.jsx(K,{}),e.jsx(Y,{children:e.jsxs(gs,{children:[e.jsxs(fe,{children:["The layout of the elements on the signage or rail map, is designed by"," ",e.jsxs(O,{color:"teal.500",href:"https://www.shmetro.com/",isExternal:!0,children:["Shanghai Shentong Metro Group ",e.jsx(E,{as:M})]}),", ",e.jsxs(O,{color:"teal.500",href:"https://www.gzmtr.com/",isExternal:!0,children:["Guangzhou Metro Group ",e.jsx(E,{as:M})]})," or ",e.jsxs(O,{color:"teal.500",href:"https://www.mtr.com.hk/",isExternal:!0,children:["MTR Corporation ",e.jsx(E,{as:M})]}),", depending on your selection. You shall grant appropriate permit or license from the relevant company above before using the generated images for commercial purposes, if it is required to do so.",e.jsx("br",{}),"标志版或路线图的元素或布局，基于你所选择的风格，为",e.jsxs(O,{color:"teal.500",href:"https://www.shmetro.com/",isExternal:!0,children:["上海申通地铁集团 ",e.jsx(E,{as:M})]}),"，",e.jsxs(O,{color:"teal.500",href:"https://www.gzmtr.com/",isExternal:!0,children:["广州地铁集团公司 ",e.jsx(E,{as:M})]}),"或",e.jsxs(O,{color:"teal.500",href:"https://www.mtr.com.hk/",isExternal:!0,children:["港铁公司 ",e.jsx(E,{as:M})]}),"所设计。在产生的图像用作商业用途前，你应向相关公司取得适当之许可证或授权。"]}),e.jsxs(fe,{children:["The elements including shapes and lines on the image are drawn by"," ",e.jsxs(O,{color:"teal.500",href:"https://www.github.com/thekingofcity",isExternal:!0,children:["thekingofcity ",e.jsx(E,{as:M})]})," and ",e.jsxs(O,{color:"teal.500",href:"https://www.github.com/wongchito",isExternal:!0,children:["Chito Wong ",e.jsx(E,{as:M})]}),", based on the design standards or rules of the companies listed above. You may use them for any purposes, but it is recommended to state the name and the link of software alongside.",e.jsx("br",{}),"图像的元素，包括图形及线条，均由",e.jsxs(O,{color:"teal.500",href:"https://www.github.com/thekingofcity",isExternal:!0,children:["thekingofcity ",e.jsx(E,{as:M})]}),"及",e.jsxs(O,{color:"teal.500",href:"https://www.github.com/wongchito",isExternal:!0,children:["Chito Wong ",e.jsx(E,{as:M})]}),"基于上述公司设计标准或准则绘制。你可将其用于任何目的，但我们建议你于使用同时附以我们的名字以及本网站地址。"]}),e.jsxs(fe,{children:["Due to copyright, licensing and other legal restrictions, Rail Map Painter uses"," ",e.jsxs(O,{color:"teal.500",href:"https://github.com/ButTaiwan/genyo-font",isExternal:!0,children:["GenYoMin provided by ButTaiwan ",e.jsx(E,{as:M})]}),", and Vegur instead of MTRSung and Myriad Pro respectively to display and generate MTR-style signage. You shall grant appropriate permit or license from the manufacturers before using those generated images for commercial purposes.",e.jsx("br",{}),"由于著作权及其他法律限制，铁路路线图绘制器使用由",e.jsxs(O,{color:"teal.500",href:"https://github.com/ButTaiwan/genyo-font",isExternal:!0,children:["ButTaiwan提供的源樣明體 ",e.jsx(E,{as:M})]}),"，以及Vegur，以代替港铁样式标志牌所使用的地铁宋及Myriad Pro。在产生之图像用作商业用途前，你应向字型生产厂商取得适当之许可证或授权。"]}),e.jsxs(fe,{children:["The exported images in PNG or SVG format may be modified, published, or used for other purposes except commercial use, under the conditions above.",e.jsx("br",{}),"输出的PNG或SVG图像可基于上述条款，在非商业使用时，用于修改、发行或其他用途。"]}),e.jsxs(fe,{children:["All flag emojis shown on Windows platforms are designed by"," ",e.jsxs(O,{color:"teal.500",href:"https://openmoji.org/",isExternal:!0,children:["OpenMoji ",e.jsx(E,{as:M})]})," ","– the open-source emoji and icon project. License:",e.jsxs(O,{color:"teal.500",href:"https://creativecommons.org/licenses/by-sa/4.0/",isExternal:!0,children:["CC BY-SA 4.0 ",e.jsx(E,{as:M})]}),e.jsx("br",{}),"于Windows作业系统上显示的国旗Emoji为",e.jsxs(O,{color:"teal.500",href:"https://openmoji.org/",isExternal:!0,children:["OpenMoji ",e.jsx(E,{as:M})]}),"所设计。许可证：",e.jsxs(O,{color:"teal.500",href:"https://creativecommons.org/licenses/by-sa/4.0/",isExternal:!0,children:["CC BY-SA 4.0 ",e.jsx(E,{as:M})]})]}),e.jsxs(fe,{children:["We reserve the rights, without prior notice, to modify, add, or remove these terms. The Chinese translation is for reference only. In case of any discrepancy between the English version and the Chinese version, the English version shall prevail.",e.jsx("br",{}),"我们保留修改、新增或移除上述条款之权利，而无需另行通知。中文译本仅供参考，文义如与英文有歧异，概以英文本为准。"]})]})})]})]})},qn=Yn;function Jn(){const t=Dt("white","var(--chakra-colors-gray-800)"),r=P(),{telemetry:{app:l,project:s}}=B(z=>z.app),i=B(z=>z.param),{t:n}=W(),o=j.useRef(window.graph),[a,c]=j.useState("png"),m={png:n("header.download.png"),svg:n("header.download.svg")},[h,u]=j.useState(2),[p,d]=j.useState({width:1,height:1,benchmark:.001}),[g,x]=j.useState(200),f=[10,25,33,50,67,75,100,125,150,175,200,250,300,400,500,750,1e3],b=Object.fromEntries(f.map(z=>[z,"".concat(z,"%")])),[S,y]=j.useState([]),[k,I]=j.useState(!1),H=[{type:"select",label:n("header.download.format"),value:a,options:m,onChange:z=>c(z==="png"?"png":"svg")}],Le=[{type:"select",label:n("header.download.svgVersion"),value:h,options:{1.1:n("header.download.svg1.1"),2:n("header.download.svg2")},onChange:z=>{u(z),z===1.1&&St(!0)}}],Be=[{type:"select",label:n("header.download.scale"),value:g,options:b,disabledOptions:S,onChange:z=>x(z)},{type:"switch",label:n("header.download.transparent"),isChecked:k,onChange:I}],[ue,ge]=j.useState(!1),[Ge,bt]=j.useState(!1),[wt,St]=j.useState(!1),[yt,ls]=j.useState(!1),[vt,cs]=j.useState(!1),[ds,Ct]=j.useState(!1);j.useEffect(()=>{(async()=>{const ze=await On.maxArea({usePromise:!0,useWorker:!0});d(ze)})()},[]),j.useEffect(()=>{if(ue){const{xMin:z,yMin:ze,xMax:Pe,yMax:Ne}=qt(o.current),[De,me]=[Pe-z,Ne-ze],ke=f.filter(xe=>De*xe/100>p.width&&me*xe/100>p.height);y(ke)}},[ue]);const hs=()=>{l&&T.event(he.DOWNLOAD_PARAM,s?{"#nodes":o.current.order,"#edges":o.current.size}:{}),rt("RMP_".concat(new Date().valueOf(),".json"),"application/json",Ms(i))},ps=async()=>{ge(!1),l&&T.event(he.DOWNLOAD_IMAGES,s?{numberOfNodes:o.current.order,numberOfEdges:o.current.size}:{});const{elem:z,width:ze,height:Pe}=await Mn(o.current,yt,wt,h),Ne=z.outerHTML.replace(/&nbsp;/g," ");if(a==="svg"){rt("RMP_".concat(new Date().valueOf(),".svg"),"image/svg+xml",Ne);return}document.body.appendChild(z);const De="data:image/svg+xml;base64,"+btoa(unescape(encodeURIComponent(Ne)));document.body.removeChild(z),z.remove();const me=document.createElement("canvas"),[ke,xe]=[ze*g/100,Pe*g/100];me.width=ke,me.height=xe;const Ue=me.getContext("2d");k||(Ue.fillStyle=t,Ue.fillRect(0,0,ke,xe));const Ze=new Image;Ze.onload=()=>{setTimeout(()=>{Ue.drawImage(Ze,0,0,ke,xe),me.toBlob(zt=>{if(!zt){r(_e({status:"error",message:n("header.download.imageTooBig")}));return}ns("RMP_".concat(new Date().valueOf(),".png"),zt)},"image/png")},un()?2e3:0)},Ze.src=De};return e.jsxs(ut,{id:"download",children:[e.jsx(gt,{as:Q,size:"sm",variant:"ghost",icon:e.jsx(Xt,{})}),e.jsxs(mt,{children:[e.jsx(te,{icon:e.jsx(ks,{}),onClick:hs,children:n("header.download.config")}),e.jsxs(te,{icon:e.jsx(As,{}),onClick:()=>Ct(!0),children:[n("header.download.2rmg.title"),e.jsx(Ee,{ml:"1",colorScheme:"green",children:"New"})]}),e.jsx(te,{icon:e.jsx(Os,{}),onClick:()=>ge(!0),children:n("header.download.image")})]}),e.jsxs(U,{size:"xl",isOpen:ue,onClose:()=>ge(!1),children:[e.jsx(Z,{}),e.jsxs(V,{children:[e.jsx(F,{children:n("header.download.image")}),e.jsx(K,{}),e.jsxs(Y,{children:[e.jsx(ve,{fields:H}),a==="svg"&&e.jsx(ve,{fields:Le}),a==="png"&&e.jsx(ve,{fields:Be}),a==="png"&&S.length>0&&e.jsxs(e.Fragment,{children:[e.jsx(w,{as:"i",fontSize:"sm",children:n("header.download.disabledScaleOptions")}),e.jsx("br",{}),e.jsx(w,{as:"i",fontSize:"sm",children:n("header.download.disabledScaleOptionsWorkarounds")}),e.jsxs(O,{color:"teal.500",onClick:()=>window.open("https://github.com/RazrFalcon/resvg","_blank"),children:["RazrFalcon/resvg ",e.jsx(E,{as:M})]}),e.jsx("br",{})]}),e.jsx("br",{}),e.jsx(Fe,{isChecked:wt,isDisabled:a==="svg"&&h===1.1,onChange:z=>St(z.target.checked),children:e.jsx(w,{children:n("header.download.useSystemFonts")})}),e.jsx(Fe,{isChecked:yt,onChange:z=>ls(z.target.checked),children:e.jsxs(w,{children:[n("header.download.shareInfo1"),e.jsxs(O,{color:"teal.500",onClick:()=>window.open("https://railmapgen.github.io/rmp","_blank"),children:[n("header.about.rmp")," ",e.jsx(E,{as:M})]}),n("header.download.shareInfo2")]})}),e.jsx(Fe,{isChecked:vt,onChange:z=>cs(z.target.checked),children:e.jsxs(w,{children:[n("header.download.termsAndConditionsInfo"),e.jsxs(O,{color:"teal.500",onClick:()=>bt(!0),children:[n("header.download.termsAndConditions")," ",e.jsx(E,{as:M})]}),n("header.download.period")]})})]}),e.jsx(le,{children:e.jsx(ms,{children:e.jsx(R,{colorScheme:"teal",variant:"outline",size:"sm",isDisabled:!vt||S.includes(g),onClick:ps,children:n("header.download.confirm")})})}),e.jsx(qn,{isOpen:Ge,onClose:()=>bt(!1)})]})]}),e.jsx(Fn,{isOpen:ds,onClose:()=>Ct(!1)})]})}const Xn=(t,{info_panel_type:r,line_num:l,stn_list:s,style:i,theme:n})=>{const o=Object.fromEntries(Object.keys(s).filter(a=>!["linestart","lineend"].includes(a)).map(a=>[a,"stn_".concat(ot(10))]));Object.entries(s).filter(([a,c])=>!["linestart","lineend"].includes(a)).forEach(([a,c])=>{const m=t.filterNodes((h,u)=>Object.values(_).includes(u.type)&&u[u.type].names[0]===c.name[0]);m.length!==0&&(o[a]=m[0])}),Object.entries(s).filter(([a,c])=>!["linestart","lineend"].includes(a)).filter(([a,c])=>t.filterNodes((m,h)=>Object.values(_).includes(h.type)&&h[h.type].names[0]===c.name[0]).length===0).forEach(([a,c],m)=>{var g;let h=_.ShmetroBasic;const u=c.transfer.groups,p=u.map(x=>{var f;return(f=x.lines)!=null?f:[]}).flat();i===oe.SHMetro?p.length>0?h=_.ShmetroInt:r===ft.sh2020?h=_.ShmetroBasic2020:h=_.ShmetroBasic:i===oe.GZMTR?p.length>0?h=_.GzmtrInt:h=_.GzmtrBasic:i===oe.MTR&&(h=_.MTR);const d={...structuredClone(gn[h].defaultAttrs),names:c.name};h===_.ShmetroBasic2020?d.color=n:h===_.GzmtrBasic?(d.color=n,d.lineCode=l,d.stationCode=c.num):h===_.GzmtrInt?d.transfer=u.map((x,f)=>{var S,y;const b=(y=(S=x.lines)==null?void 0:S.map(k=>{var I;return[...(I=k.theme)!=null?I:n,"1","01"]}))!=null?y:[];return f===0?[[...n,l,c.num],...b]:b}):h===_.MTR&&((g=u[0].lines)!=null&&g.length?d.transfer=[[[...n,"",""],...u[0].lines.map(x=>{var f;return[...(f=x.theme)!=null?f:n,"",""]})]]:d.transfer=[[]]),t.addNode(o[a],{visible:!0,zIndex:0,x:100+m*50,y:1e3,type:h,[h]:d})}),Object.entries(s).filter(([a,c])=>!["linestart","lineend"].includes(a)).forEach(([a,c])=>{c.children.filter(m=>!["linestart","lineend"].includes(m)).forEach(m=>{t.addDirectedEdgeWithKey("line_".concat(ot(10)),o[a],o[m],{visible:!0,zIndex:0,type:Ye.Diagonal,[Ye.Diagonal]:structuredClone(Ts[Ye.Diagonal].defaultAttrs),style:Ot.SingleColor,[Ot.SingleColor]:{color:n},reconcileId:""})})})},$n="rmg-bridge--",Qn={h:500,maxH:"70%","& iframe":{h:"100%",w:"100%"}};function eo(t){const{isOpen:r,onClose:l,onImport:s}=t,[i]=It.useState(crypto.randomUUID()),n="/rmg/#/import?"+new URLSearchParams({parentComponent:T.getAppName(),parentId:i});return It.useEffect(()=>{const o=new BroadcastChannel($n+i);return o.onmessage=a=>{const{event:c,data:m}=a.data;console.log("[rmp] Received event from RMG app clip:",c),c==="CLOSE"?l():c==="IMPORT"&&s(m)},()=>o.close()},[]),e.jsx($t,{isOpen:r,onClose:l,sx:Qn,children:e.jsx("iframe",{src:n,loading:"lazy"})})}const to="RMP_GALLERY_CHANNEL",so="OPEN_TEMPLATE",Lt=new BroadcastChannel(to),no={h:"80%",w:"80%","& iframe":{h:"100%",w:"100%"},"& div":{h:"100%",w:"100%"}};function oo(t){const{isOpen:r,onClose:l}=t,s=Ut(),{t:i}=W(),n=P(),{telemetry:{app:o,project:a}}=B(p=>p.app),c=j.useRef(window.graph);T.getInstance();const m=j.useCallback(()=>{n(pe()),n(re()),n(ae(c.current.export()))},[n,pe,re,ae,c]),h=async p=>{const{version:d,...g}=JSON.parse(await Qt(JSON.stringify(p)));n(it()),c.current.clear(),c.current.import(g.graph),m();const{svgViewBoxZoom:x,svgViewBoxMin:f}=g;typeof x=="number"&&n(Ce(x)),typeof f.x=="number"&&typeof f.y=="number"&&n(Me(f))},u=async(p,d)=>{var f;const g=d?"https://".concat(d):"",x=await((f=(await Promise.allSettled([fetch("".concat(g,"/rmp-gallery/resources/real_world/").concat(p,".json")),fetch("".concat(g,"/rmp-gallery/resources/fantasy/").concat(p,".json"))])).filter(b=>b.status==="fulfilled").find(b=>b.value.status===200))==null?void 0:f.value.json());if(x){if(o){const b={id:p};a&&d&&(b.host=d),T.event(he.IMPORT_WORK_FROM_GALLERY,b)}h(x),s({title:i("header.open.importFromRMPGallery",{id:p}),status:"success",duration:9e3,isClosable:!0})}else s({title:i("header.open.failToImportFromRMPGallery",{id:p}),status:"error",duration:9e3,isClosable:!0})};return j.useEffect(()=>{const d=new URL(window.location.href).searchParams;if(d.size>0){const g=d.keys().next().value,x=g.indexOf("."),f=g.substring(0,x===-1?void 0:x);let b;x!==-1&&(b=g.substring(x+1)),u(f,b)}},[]),j.useEffect(()=>(Lt.onmessage=p=>{const{event:d,data:g}=p.data;d===so&&(u(g),l())},()=>Lt.close()),[]),e.jsxs($t,{isOpen:r,onClose:l,size:"full",sx:no,children:[e.jsx("iframe",{src:"/rmp-gallery/",loading:"lazy"}),e.jsx(Zt,{onClick:l,position:"fixed",top:"5px",right:"15px"})]})}function io(){const{t}=W(),r=P(),{telemetry:{project:l}}=B(b=>b.app),s=j.useRef(window.graph),i=j.useRef(null),[n,o]=j.useState(!1),[a,c]=j.useState(!1),m=j.useCallback(()=>{r(pe()),r(re()),r(ae(s.current.export()))},[r,pe,re,ae,s]),h=()=>{r(it()),s.current.clear(),r(Ce(100)),r(Me({x:0,y:0})),m()},u=b=>{try{l&&T.event(he.IMPORT_RMG_PARAM,{}),Xn(s.current,b),m()}catch(S){r(_e({status:"error",message:t("header.open.unknownError")})),console.error("OpenActions.handleUploadRMG():: Unknown error occurred while parsing the RMG project",S)}finally{o(!1)}},p=async b=>{const{version:S,...y}=JSON.parse(await Qt(b));r(it()),s.current.clear(),s.current.import(y.graph),m();const{svgViewBoxZoom:k,svgViewBoxMin:I}=y;typeof k=="number"&&r(Ce(k)),typeof I.x=="number"&&typeof I.y=="number"&&r(Me(I))},d=async b=>{var y;const S=(y=b.target.files)==null?void 0:y[0];if(console.log("OpenActions.handleUpload():: received file",S),(S==null?void 0:S.type)!=="application/json")r(_e({status:"error",message:t("header.open.invalidType")})),console.error("OpenActions.handleUpload():: Invalid file type! Only file in JSON format is accepted.");else try{const k=await ro(S);await p(k)}catch(k){r(_e({status:"error",message:t("header.open.unknownError")})),console.error("OpenActions.handleUpload():: Unknown error occurred while parsing the uploaded file",k)}b.target.value=""},g=async()=>{await p(await Is()),r(Me({x:-10,y:-13}));const b=Math.max(0,Math.min(400,-.132*f+117.772));r(Ce(b)),T.event(he.LOAD_TUTORIAL,{})};j.useEffect(()=>{const b=async S=>{const{type:y,key:k,from:I}=S.data;if(y===_s.SAVE_CHANGED&&k===Et.PARAM&&I==="rmt"){Hs.debug("Received save changed event on key: ".concat(k));const H=localStorage.getItem(Et.PARAM);if(!H)return;await p(H)}};return Mt.addEventListener("message",b),()=>Mt.removeEventListener("message",b)},[]);const x=ss(),{height:f}=es(x);return e.jsxs(ut,{children:[e.jsx(gt,{as:Q,size:"sm",variant:"ghost",icon:e.jsx(Tt,{})}),e.jsxs(mt,{children:[e.jsx(te,{icon:e.jsx(Es,{}),onClick:h,children:t("header.open.new")}),e.jsx("input",{id:"upload_project",ref:i,type:"file",accept:".json",hidden:!0,onChange:d,"data-testid":"file-upload"}),e.jsx(te,{icon:e.jsx(Tt,{}),onClick:()=>{var b;return(b=i==null?void 0:i.current)==null?void 0:b.click()},children:t("header.open.config")}),e.jsx(te,{icon:e.jsx(Rs,{}),onClick:()=>o(!0),children:t("header.open.projectRMG")}),e.jsxs(te,{icon:e.jsx(M,{}),onClick:()=>c(!0),children:[t("header.open.gallery"),e.jsx(Ee,{ml:"1",colorScheme:"green",children:"New"})]}),e.jsx(te,{icon:e.jsx(Ns,{}),onClick:g,children:t("header.open.tutorial")})]}),e.jsx(eo,{isOpen:n,onClose:()=>o(!1),onImport:u}),e.jsx(oo,{isOpen:a,onClose:()=>c(!1)})]})}const ro=t=>new Promise(r=>{const l=new FileReader;l.onloadend=()=>r(l.result),l.readAsText(t)}),ao=t=>{const{isOpen:r,onClose:l}=t,s=P(),{theme:i,paletteAppClip:{output:n}}=B(d=>d.runtime),{t:o}=W(),a=j.useRef(window.graph),[c,m]=j.useState(i),[h,u]=j.useState(!1);j.useEffect(()=>{h&&n&&(m(n),u(!1))},[n==null?void 0:n.toString()]);const p=()=>{a.current.filterEdges((d,g,x,f,b,S,y)=>Jt.includes(g.style)&&JSON.stringify(g[g.style].color)===JSON.stringify(c)).forEach(d=>a.current.dropEdge(d)),s(re()),s(ae(a.current.export())),l()};return e.jsxs(U,{isOpen:r,onClose:l,size:"xl",scrollBehavior:"inside",trapFocus:!1,children:[e.jsx(Z,{}),e.jsxs(V,{children:[e.jsx(F,{children:o("header.settings.procedures.removeLines.title")}),e.jsx(K,{}),e.jsxs(Y,{children:[o("header.settings.procedures.removeLines.content"),e.jsx(Ws,{theme:c,onClick:()=>{u(!0),s(Ls(c))}})]}),e.jsxs(le,{children:[e.jsx(R,{colorScheme:"blue",variant:"outline",mr:"1",onClick:l,children:o("cancel")}),e.jsx(R,{colorScheme:"red",onClick:p,children:o("remove")})]})]})]})},lo=t=>{const{isOpen:r,onClose:l}=t,s=P(),{t:i}=W(),n=j.useRef(window.graph),[o,a]=j.useState(1),c=[{type:"input",label:i("header.settings.procedures.scale.factor"),value:o.toString(),variant:"number",onChange:h=>a(Number(h)),minW:"full"}],m=()=>{n.current.forEachNode((h,u)=>{n.current.updateNodeAttribute(h,"x",p=>(p!=null?p:0)*o),n.current.updateNodeAttribute(h,"y",p=>(p!=null?p:0)*o)}),s(pe()),s(re()),s(ae(n.current.export())),l()};return e.jsxs(U,{isOpen:r,onClose:l,size:"xl",scrollBehavior:"inside",children:[e.jsx(Z,{}),e.jsxs(V,{children:[e.jsx(F,{children:i("header.settings.procedures.scale.title")}),e.jsx(K,{}),e.jsxs(Y,{children:[i("header.settings.procedures.scale.content"),e.jsx(ve,{fields:c})]}),e.jsxs(le,{children:[e.jsx(R,{colorScheme:"blue",variant:"outline",mr:"1",onClick:l,children:i("cancel")}),e.jsx(R,{colorScheme:"red",onClick:m,children:i("apply")})]})]})]})},co=t=>{const{isOpen:r,onClose:l}=t,s=P(),{t:i}=W(),n=j.useRef(window.graph),[o,a]=j.useState(0),[c,m]=j.useState(0),h=[{type:"input",label:i("header.settings.procedures.translate.x"),value:o.toString(),variant:"number",onChange:p=>a(Number(p)),minW:"full"},{type:"input",label:i("header.settings.procedures.translate.y"),value:c.toString(),variant:"number",onChange:p=>m(Number(p)),minW:"full"}],u=()=>{n.current.forEachNode((p,d)=>{n.current.updateNodeAttribute(p,"x",g=>(g!=null?g:0)+o),n.current.updateNodeAttribute(p,"y",g=>(g!=null?g:0)+c)}),s(pe()),s(re()),s(ae(n.current.export())),l()};return e.jsxs(U,{isOpen:r,onClose:l,size:"xl",scrollBehavior:"inside",children:[e.jsx(Z,{}),e.jsxs(V,{children:[e.jsx(F,{children:i("header.settings.procedures.translate.title")}),e.jsx(K,{}),e.jsxs(Y,{children:[i("header.settings.procedures.translate.content"),e.jsx(ve,{fields:h})]}),e.jsxs(le,{children:[e.jsx(R,{colorScheme:"blue",variant:"outline",mr:"1",onClick:l,children:i("cancel")}),e.jsx(R,{colorScheme:"red",onClick:u,children:i("apply")})]})]})]})},ho=t=>{const{isOpen:r,onClose:l}=t,s=P(),{activeSubscriptions:i}=B(a=>a.account),{t:n}=W(),o=()=>{s(Bs(-1))};return e.jsxs(U,{isOpen:r,onClose:l,size:"5xl",scrollBehavior:"inside",children:[e.jsx(Z,{}),e.jsxs(V,{children:[e.jsx(F,{children:n("header.settings.procedures.unlockSimplePath.title")}),e.jsx(K,{}),e.jsxs(Y,{children:[e.jsx(w,{mb:"2",children:n("header.settings.procedures.unlockSimplePath.content1")}),e.jsx(w,{mb:"2",children:n("header.settings.procedures.unlockSimplePath.content2")}),e.jsx(w,{mb:"2",children:n("header.settings.procedures.unlockSimplePath.content3")})]}),e.jsx(le,{children:e.jsx(nt,{label:n("header.settings.pro"),isOpen:!i.RMP_CLOUD,children:e.jsx(R,{onClick:o,isDisabled:!i.RMP_CLOUD,children:n("header.settings.procedures.unlockSimplePath.check")})})})]})]})},po=t=>{const{isOpen:r,onClose:l}=t,s=P(),i=Ut(),{t:n}=W(),o=j.useRef(window.graph),[a,c]=j.useState(!1),m=async()=>{c(!0);const h=JSON.stringify(o.current.export());try{const u=await mo(h);o.current.clear(),o.current.import(u),s(pe()),s(re()),s(ae(o.current.export())),i({title:n("header.settings.procedures.updateColor.success"),status:"success",duration:9e3,isClosable:!0})}catch(u){console.error("[rmp] Error in updating all colors: ".concat(u)),i({title:n("header.settings.procedures.updateColor.error",{e:u}),status:"error",duration:9e3,isClosable:!0})}c(!1),l()};return e.jsxs(U,{isOpen:r,onClose:l,size:"xl",scrollBehavior:"inside",children:[e.jsx(Z,{}),e.jsxs(V,{children:[e.jsx(F,{children:n("header.settings.procedures.updateColor.title")}),e.jsx(K,{}),e.jsx(Y,{children:e.jsx(w,{children:n("header.settings.procedures.updateColor.content")})}),e.jsxs(le,{children:[e.jsx(R,{colorScheme:"blue",variant:"outline",mr:"1",onClick:l,children:n("cancel")}),e.jsx(R,{colorScheme:"red",onClick:m,isLoading:a,children:n("apply")})]})]})]})},Bt=t=>t.length>=4&&t.every(r=>typeof r=="string")&&!!t[2].match(/^#[0-9a-fA-F]{6}$/)&&Object.values(xt).includes(t[3]),uo=t=>{const r=[],l=(s,i)=>{if(Array.isArray(s)&&Bt(s)){r.push({path:i||"",value:s});return}for(const n in s){const o=s[n],a=i?"".concat(i,".").concat(n):n;Array.isArray(o)?Bt(o)?r.push({path:a,value:o}):o.forEach((c,m)=>l(c,"".concat(a,".").concat(m))):o&&typeof o=="object"&&l(o,a)}};return l(t),r},go=(t,r,l)=>{const s=r.split(".");let i=t;for(let n=0;n<s.length-1;n++)i=i[s[n]];i[s[s.length-1]]=l},mo=async t=>{const r=JSON.parse(t),l=new Date().getTime(),s=uo(r);console.log("[rmp] Found all themes pending for update",s);const i=1e4;let n,o=!1;const a=new Promise((c,m)=>{n=setTimeout(()=>{o=!0,m("Executing time exceeds ".concat(i,"ms"))},i),(async()=>{for(const{path:h,value:u}of s){if(o)throw new Error("Update aborted");const[p,d,g,x,...f]=u,b=await Gs([p,d,g,x]);go(r,h,[...b,...f])}})().then(c).catch(m)});try{return await a,console.log("[rmp] Themes update completed, elapsed time ".concat((new Date().getTime()-l)/1e3," sec")),r}finally{clearTimeout(n)}},be={width:"100%",justifyContent:"space-between"},ee={fontFamily:"-apple-system"},xo=t=>{const{isOpen:r,onClose:l}=t,{keepLastPath:s}=B(H=>H.runtime),i=P(),{t:n}=W(),o=Dt("primary.500","primary.300"),[a,c]=j.useState(!1),[m,h]=j.useState(!1),[u,p]=j.useState(!1),[d,g]=j.useState(!1),[x,f]=j.useState(!1),[b,S]=j.useState(!1),y=T.isAllowAnalytics(),{telemetry:{app:k}}=B(H=>H.app),I=H=>i(Fs(H));return e.jsxs(U,{isOpen:r,onClose:l,size:"xl",scrollBehavior:"inside",trapFocus:!1,children:[e.jsx(Z,{}),e.jsxs(V,{children:[e.jsx(F,{children:n("header.settings.title")}),e.jsx(K,{}),e.jsx(Y,{children:e.jsxs(Se,{divider:e.jsx(xs,{borderColor:"gray.200"}),children:[e.jsxs(L,{width:"100%",mb:"3",children:[e.jsx(w,{as:"b",fontSize:"xl",children:n("header.settings.preference.title")}),e.jsx(L,{mt:"3",children:e.jsxs(L,{display:"flex",mb:"1",children:[e.jsx(w,{flex:"1",children:n("header.settings.preference.keepLastPath")}),e.jsx(Ke,{isChecked:s,onChange:({target:{checked:H}})=>i(Ps(H))})]})})]}),e.jsxs(L,{width:"100%",mb:"3",children:[e.jsx(w,{as:"b",fontSize:"xl",children:n("header.settings.procedures.title")}),e.jsxs(L,{mt:"3",children:[e.jsx(R,{sx:be,rightIcon:e.jsx(je,{}),onClick:()=>c(!0),children:n("header.settings.procedures.translate.title")}),e.jsx(co,{isOpen:a,onClose:()=>c(!1)}),e.jsx(R,{sx:be,rightIcon:e.jsx(je,{}),onClick:()=>h(!0),children:n("header.settings.procedures.scale.title")}),e.jsx(lo,{isOpen:m,onClose:()=>h(!1)}),e.jsxs(R,{sx:be,rightIcon:e.jsx(je,{}),onClick:()=>p(!0),children:[n("header.settings.procedures.changeType.title"),e.jsx(nt,{label:n("header.settings.pro"),children:e.jsx(Ee,{ml:"1",color:"gray.50",background:"radial-gradient(circle, #3f5efb, #fc466b)",mr:"auto",children:"PRO"})})]}),e.jsx(xn,{isOpen:u,onClose:()=>p(!1),isSelect:!1}),e.jsx(R,{sx:be,rightIcon:e.jsx(je,{}),onClick:()=>g(!0),children:n("header.settings.procedures.removeLines.title")}),e.jsx(ao,{isOpen:d,onClose:()=>g(!1)}),e.jsx(R,{sx:be,rightIcon:e.jsx(je,{}),onClick:()=>f(!0),children:n("header.settings.procedures.updateColor.title")}),e.jsx(po,{isOpen:x,onClose:()=>f(!1)}),e.jsxs(R,{sx:be,rightIcon:e.jsx(je,{}),onClick:()=>S(!0),children:[n("header.settings.procedures.unlockSimplePath.title"),e.jsx(nt,{label:n("header.settings.pro"),children:e.jsx(Ee,{ml:"1",color:"gray.50",background:"radial-gradient(circle, #3f5efb, #fc466b)",mr:"auto",children:"PRO"})})]}),e.jsx(ho,{isOpen:b,onClose:()=>S(!1)})]})]}),e.jsxs(L,{width:"100%",mb:"3",children:[e.jsx(w,{as:"b",fontSize:"xl",children:n("header.settings.shortcuts.title")}),e.jsx(L,{mt:"3",children:e.jsxs(fs,{children:[e.jsx(js,{children:e.jsxs(G,{children:[e.jsx(kt,{children:n("header.settings.shortcuts.keys")}),e.jsx(kt,{children:n("header.settings.shortcuts.description")})]})}),e.jsxs(bs,{children:[e.jsxs(G,{children:[e.jsx(A,{children:e.jsx(v,{children:"f"})}),e.jsx(A,{children:n("header.settings.shortcuts.f")})]}),e.jsxs(G,{children:[e.jsx(A,{children:e.jsx(v,{children:"s"})}),e.jsx(A,{children:n("header.settings.shortcuts.s")})]}),e.jsxs(G,{children:[e.jsx(A,{children:e.jsxs(L,{display:"flex",flexDirection:"row",children:[e.jsx(Ds,{}),e.jsx(Us,{}),e.jsx(Zs,{}),e.jsx(Vs,{})]})}),e.jsx(A,{children:n("header.settings.shortcuts.arrows")})]}),e.jsxs(G,{children:[e.jsx(A,{children:e.jsxs(L,{display:"flex",flexDirection:"row",children:[e.jsx(v,{children:"i"}),e.jsx(v,{children:"j"}),e.jsx(v,{children:"k"}),e.jsx(v,{children:"l"})]})}),e.jsx(A,{children:n("header.settings.shortcuts.ijkl")})]}),e.jsxs(G,{children:[e.jsx(A,{children:ne?e.jsx(v,{sx:ee,children:"⇧"}):e.jsx(v,{children:"shift"})}),e.jsx(A,{children:n("header.settings.shortcuts.shift")})]}),e.jsxs(G,{children:[e.jsx(A,{children:ne?e.jsx(v,{sx:ee,children:"⌥"}):e.jsx(v,{children:"alt"})}),e.jsx(A,{children:n("header.settings.shortcuts.alt")})]}),e.jsxs(G,{children:[e.jsx(A,{children:ne?e.jsx(v,{sx:ee,children:"⌫"}):e.jsx(v,{children:"delete"})}),e.jsx(A,{children:n("header.settings.shortcuts.delete")})]}),e.jsxs(G,{children:[e.jsxs(A,{children:[ne?e.jsx(v,{sx:ee,children:"⌘"}):e.jsx(v,{children:"ctrl"})," + ",e.jsx(v,{children:"x"})]}),e.jsx(A,{children:n("header.settings.shortcuts.cut")})]}),e.jsxs(G,{children:[e.jsxs(A,{children:[ne?e.jsx(v,{sx:ee,children:"⌘"}):e.jsx(v,{children:"ctrl"})," + ",e.jsx(v,{children:"c"})]}),e.jsx(A,{children:n("header.settings.shortcuts.copy")})]}),e.jsxs(G,{children:[e.jsxs(A,{children:[ne?e.jsx(v,{sx:ee,children:"⌘"}):e.jsx(v,{children:"ctrl"})," + ",e.jsx(v,{children:"v"})]}),e.jsx(A,{children:n("header.settings.shortcuts.paste")})]}),e.jsxs(G,{children:[e.jsxs(A,{children:[ne?e.jsx(v,{sx:ee,children:"⌘"}):e.jsx(v,{children:"ctrl"})," + ",e.jsx(v,{children:"z"})]}),e.jsx(A,{children:n("header.settings.shortcuts.undo")})]}),e.jsxs(G,{children:[e.jsx(A,{children:ne?e.jsxs(e.Fragment,{children:[e.jsx(v,{sx:ee,children:"⇧"})," + ",e.jsx(v,{sx:ee,children:"⌘"})," + ",e.jsx(v,{children:"z"})]}):e.jsxs(e.Fragment,{children:[e.jsx(v,{children:"ctrl"})," + ",e.jsx(v,{children:"y"})]})}),e.jsx(A,{children:n("header.settings.shortcuts.redo")})]})]})]})})]}),e.jsxs(L,{width:"100%",mb:"3",children:[e.jsx(w,{as:"b",fontSize:"xl",children:n("header.settings.telemetry.title")}),e.jsxs(L,{mt:"3",children:[e.jsxs(L,{display:"flex",mb:"1",children:[e.jsx(w,{flex:"1",children:n("header.settings.telemetry.essential")}),e.jsx(Ke,{isChecked:y,isDisabled:!0})]}),e.jsx(w,{fontSize:"sm",lineHeight:"100%",color:"gray.600",children:n("header.settings.telemetry.essentialInfo")}),e.jsxs(O,{color:o,fontSize:"sm",lineHeight:"100%",href:"https://support.google.com/analytics/answer/11593727",isExternal:!0,children:[n("header.settings.telemetry.essentialLink")," ",e.jsx(E,{as:M})]}),e.jsxs(L,{display:"flex",mb:"1",children:[e.jsx(w,{flex:"1",children:n("header.settings.telemetry.additional")}),e.jsx(Ke,{isChecked:k,onChange:({target:{checked:H}})=>I(H)})]}),e.jsx(w,{fontSize:"sm",lineHeight:"100%",color:"gray.600",children:n("header.settings.telemetry.additionalInfo")})]})]})]})})]})]})},fo=xo,jo=()=>{const[t,r]=j.useState(!1),{svgViewBoxZoom:l}=B(n=>n.param),s=P(),i=[{type:"slider",label:"",value:400-l,min:10,max:390,step:1,onChange:n=>s(Ce(400-n)),leftIcon:e.jsx(Ks,{}),rightIcon:e.jsx(Rt,{}),minW:160}];return e.jsxs(Vt,{isOpen:t,onOpen:()=>r(!0),onClose:()=>r(!1),children:[e.jsx(Ft,{children:e.jsx(Q,{"aria-label":"zoom",variant:"ghost",size:"sm",icon:e.jsx(Rt,{}),onClick:()=>r(!t)})}),e.jsx(Kt,{children:e.jsx(Yt,{children:e.jsx(ve,{fields:i,noLabel:!0})})})]})},bo=()=>{const[t,r]=j.useState(!1),{t:l}=W(),s=P(),i=j.useRef(window.graph),n=ss(),{width:o,height:a}=es(n),[c,m]=j.useState([]);j.useEffect(()=>{t&&m(i.current.nodes().filter(u=>u.startsWith("stn")).map(u=>{const p=i.current.getNodeAttributes(u),d=p.type,g=p[d].names.join("/");return{id:u,value:g}}))},[t]);const h=u=>{s(Xs(new Set([u])));const p=Math.max(0,Math.min(400,-.132*a+117.772)),{x:d,y:g}=$s((o-300)/2,a/2,p,{x:-i.current.getNodeAttribute(u,"x"),y:-i.current.getNodeAttribute(u,"y")});s(Ce(p)),s(Me({x:-d,y:-g}))};return e.jsxs(Vt,{isOpen:t,onOpen:()=>r(!0),onClose:()=>r(!1),children:[e.jsx(Ft,{children:e.jsx(Q,{"aria-label":"zoom",variant:"ghost",size:"sm",icon:e.jsx(Ys,{}),onClick:()=>r(!t)})}),e.jsx(Kt,{children:e.jsx(Yt,{children:e.jsx(qs,{label:l("header.search"),children:e.jsx(Js,{data:c,displayHandler:u=>e.jsx(Ee,{children:u.value}),filter:(u,p)=>p.value.toLowerCase().includes(u.toLowerCase())||Object.values(p.value).some(d=>d.toLowerCase().includes(u.toLowerCase())),value:"",onChange:u=>h(u.id)})})})})]})};function wo(){const{t}=W(),r=P(),{telemetry:{app:l}}=B(d=>d.app),{past:s,future:i}=B(d=>d.param),{isDonationModalOpen:n}=B(d=>d.runtime),[o,a]=j.useState(!1),[c,m]=j.useState(!1),h=Ht(T.getEnv),u=Ht(T.getAppVersion);j.useEffect(()=>{l&&h!==qe.DEV&&T.event(he.APP_LOAD,{isStandaloneWindow:T.isStandaloneWindow()})},[h]);const p=async d=>{T.getI18nInstance().changeLanguage(d)};return e.jsxs(Qs,{children:[e.jsx(de,{as:"h4",size:"md",whiteSpace:"nowrap",overflow:"hidden",textOverflow:"ellipsis",children:t("header.about.rmp")}),e.jsx(en,{environment:h,version:u,popoverHeader:h===qe.PRD?void 0:e.jsxs(_t,{i18nKey:"header.popoverHeader",environment:h,children:["You're on ",{environment:h}," environment!"]}),popoverBody:h===qe.PRD?void 0:e.jsx(_t,{i18nKey:"header.popoverBody",children:"This is a testing environment where we test the latest beta RMP."})}),e.jsxs(ws,{ml:"auto",children:[e.jsx($,{children:e.jsx(bo,{})}),e.jsx($,{children:e.jsx(Q,{size:"sm",variant:"ghost","aria-label":"Undo",icon:e.jsx(tn,{}),isDisabled:s.length===0,onClick:()=>r(sn())})}),e.jsx($,{children:e.jsx(Q,{size:"sm",variant:"ghost","aria-label":"Redo",icon:e.jsx(nn,{}),isDisabled:i.length===0,onClick:()=>r(on())})}),e.jsx($,{children:e.jsx(jo,{})}),e.jsx($,{children:e.jsx(io,{})}),e.jsx($,{children:e.jsx(Jn,{})}),T.isStandaloneWindow()&&e.jsx($,{children:e.jsxs(ut,{children:[e.jsx(gt,{as:Q,icon:e.jsx(rn,{}),variant:"ghost",size:"sm"}),e.jsx(mt,{children:["en","zh-Hans","zh-Hant","ja","ko"].map(d=>e.jsx(te,{onClick:()=>p(d),children:fn[d][d]},d))})]})}),e.jsx($,{children:e.jsx(Q,{size:"sm",variant:"ghost","aria-label":"Donation",color:"red",icon:e.jsx(ts,{}),onClick:()=>r(Nt(!0))})}),e.jsx($,{children:e.jsx(Q,{size:"sm",variant:"ghost","aria-label":"Settings",icon:e.jsx(an,{}),onClick:()=>a(!0)})}),e.jsx($,{children:e.jsx(Q,{size:"sm",variant:"ghost","aria-label":"Help",icon:e.jsx(ln,{}),onClick:()=>m(!0)})})]}),e.jsx(An,{isOpen:n,onClose:()=>r(Nt(!1))}),e.jsx(fo,{isOpen:o,onClose:()=>a(!1)}),e.jsx(Sn,{isOpen:c,onClose:()=>m(!1)})]})}function So(){const t=P(),r=B(s=>s.runtime.globalAlerts),l=s=>{T.isStandaloneWindow()?window.open("/".concat(s),"_blank"):T.openApp({appId:s})};return e.jsx(e.Fragment,{children:Object.entries(r).map(([s,{message:i,url:n,linkedApp:o}])=>e.jsxs(Ss,{status:s,variant:"solid",size:"xs",pl:3,pr:1,py:0,zIndex:"1",children:[e.jsx(ys,{}),o?e.jsx(O,{onClick:()=>l(o),children:i}):n?e.jsx(O,{href:n,target:"_blank",children:i}):i,e.jsx(Zt,{ml:"auto",onClick:()=>t(cn(s))})]},s))})}function Mo(){return e.jsxs(e.Fragment,{children:[e.jsx(wo,{}),e.jsx(So,{})]})}export{Mo as default};
