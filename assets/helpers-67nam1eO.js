import{S as f,e as h}from"./index-uIqLEXkJ.js";const N=/url\("([\S*]+)"\)/,V=()=>navigator.userAgent.includes("Safari")&&!navigator.userAgent.includes("Chrome"),b=s=>new Promise(e=>{const t=new FileReader;t.onloadend=()=>e(t.result),t.readAsDataURL(s)}),S=(s,e)=>s.find(t=>{const n=t.style;return n.getPropertyValue("font-family").replace(/^"(.+)"$/,"$1")===e.family&&n.getPropertyValue("unicode-range")===e.unicodeRange}),U=async(s,e,t,n,r)=>{var u,g;const o=Array.from(new Set(e.map(a=>[...s.querySelectorAll(a)]).flat().map(a=>a.innerHTML).join("").replace(/\s/g,""))).join(""),l=await document.fonts.load(t.join(", "),o),i=(g=(u=document.querySelector("link#".concat(n)))==null?void 0:u.sheet)==null?void 0:g.cssRules;if(!i)return Promise.reject(new Error("cssRules can not be found in link#".concat(n)));const c=Array.from(i).flatMap(a=>a instanceof CSSImportRule?Array.from(a.styleSheet.cssRules):a).filter(a=>a instanceof CSSFontFaceRule),m=l.reduce((a,d)=>{const y=S(c,d);return y?a.find(_=>{const M=_.style,p=y.style;return M.getPropertyValue("font-family")===p.getPropertyValue("font-family")&&M.getPropertyValue("unicode-range")===p.getPropertyValue("unicode-range")})?a:a.concat(y):a},[]);return await Promise.all(m.map(async a=>{try{const d=await fetch(x(r,a)),y=await b(await d.blob());return a.cssText.replace(N,"url('".concat(y,"')"))}catch(d){return console.error(d),""}}))},x=(s,e)=>{var n;const t=e.style.getPropertyValue("src");return s+((n=t.match(N))==null?void 0:n[1])},P={[f.MTR]:{className:[".rmp-name__mtr__zh",".rmp-name__mtr__en"],cssFont:["80px GenYoMin TW","Vegur"],cssName:"fonts_mtr",baseUrl:"/styles/"},[f.MRTBasic]:{className:[".rmp-name__mrt"],cssFont:["100% IdentityFont"],cssName:"fonts_mrt",baseUrl:"/rmp/styles/"},[f.MRTInt]:{className:[".rmp-name__mrt"],cssFont:["100% IdentityFont"],cssName:"fonts_mrt",baseUrl:"/rmp/styles/"},[f.JREastBasic]:{className:[".rmp-name__jreast"],cssFont:["100% Noto Sans JP"],cssName:"fonts_jreast",baseUrl:"/rmp/styles/"},[h.BerlinSBahnLineBadge]:{className:[".rmp-name__berlin"],cssFont:["100% Roboto"],cssName:"fonts_berlin",baseUrl:"/rmp/styles/"},[h.BerlinUBahnLineBadge]:{className:[".rmp-name__berlin"],cssFont:["100% Roboto"],cssName:"fonts_berlin",baseUrl:"/rmp/styles/"}},B=(s,e)=>s.filterEdges((t,n,r,o,l,i,c)=>e.has(r)&&e.has(o)),T=s=>{const e=Object.fromEntries([...Object.values(f),Object.values(h)].map(t=>[t,!1]));return s.forEachNode(t=>{const n=s.getNodeAttribute(t,"type");e[n]=!0}),e},A=(s,e,t,n,r,o)=>s<=r&&r<=t&&e<=o&&o<=n,C=(s,e,t,n,r)=>{const o=e<=n?e:n,l=t<=r?t:r,i=e<=n?n:e,c=t<=r?r:t;return s.filterNodes((m,u)=>A(o,l,i,c,u.x,u.y))},L=s=>{const e=s.currentTarget.getBoundingClientRect(),t=s.clientX-e.left,n=s.clientY-e.top;return{x:t,y:n}},w=(s,e,t,n)=>({x:s*t/100+n.x,y:e*t/100+n.y}),j=(s,e)=>Math.round(s/e)*e,I=s=>{let[e,t,n,r]=[Number.MAX_VALUE,Number.MAX_VALUE,Number.MIN_VALUE,Number.MIN_VALUE];return s.forEachNode((o,l)=>{const i=document.getElementById(o);if(i){const c=R(i);e=Math.min(c.x,e),t=Math.min(c.y,t),n=Math.max(c.x+c.width,n),r=Math.max(c.y+c.height,r)}}),e-=50,t-=50,n+=100,r+=100,{xMin:e,yMin:t,xMax:n,yMax:r}},R=s=>{const e=s.getBBox(),t=s.ownerSVGElement,n=s.parentNode.getScreenCTM().inverse().multiply(s.getScreenCTM()),r=[t.createSVGPoint(),t.createSVGPoint(),t.createSVGPoint(),t.createSVGPoint()];r[0].x=e.x,r[0].y=e.y,r[1].x=e.x+e.width,r[1].y=e.y,r[2].x=e.x+e.width,r[2].y=e.y+e.height,r[3].x=e.x,r[3].y=e.y+e.height;let[o,l,i,c]=[Number.MAX_VALUE,Number.MAX_VALUE,Number.MIN_VALUE,Number.MIN_VALUE];return r.forEach(m=>{m=m.matrixTransform(n),o=Math.min(o,m.x),i=Math.max(i,m.x),l=Math.min(l,m.y),c=Math.max(c,m.y)}),e.x=o,e.width=i-o,e.y=l,e.height=c-l,e},G=navigator.platform.startsWith("Mac"),X=s=>{for(let e=s.length-1;e>0;e--){const t=Math.floor(Math.random()*(e+1));[s[e],s[t]]=[s[t],s[e]]}return s};export{P as F,G as a,L as b,I as c,C as d,B as e,T as f,U as g,V as i,w as p,j as r,X as s};
